<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NpgsqlRest Login Endpoints - Automatic REST API for PostgreSQL Database as .NET8 Middleware</title><meta name="description" content="Automatic REST API for PostgreSQL Database as .NET8 Middleware"><meta name="keywords" content="api, api-rest, restful-api, http, postgres, dotnet, net8, c#, aot, database, rest, server, postgresql, npgsqlrest, pgsql, pg, automatic"><link href="https://vb-consulting.github.io//npgsqlrest/login-endpoints/" rel="canonical"><link rel="stylesheet" href="/_elderjs/assets/svelte-1c8bb0fd.css" media="all"><style></style><link href="/style.css?1714628006817" rel="stylesheet"><script>!function(){var e="theme",t=localStorage.getItem(e);t||(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",localStorage.setItem(e,t)),document.getElementsByTagName("html")[0].dataset.bsTheme=t}();</script></head><body class="d-flex flex-column h-100"><header id="header"><nav class="navbar navbar-expand-md navbar-dark fixed-top py-0 py-md-0 svelte-30jr7w"><div class="container-fluid flex-nowrap svelte-30jr7w"><div class="d-flex svelte-30jr7w"><button id="nav-btn" type="button" class="d-flex btn btn-sm logo animate-rotate svelte-30jr7w"><i class="material-icons-outlined">menu</i></button> <a class="nav-link my-auto ms-2 fw-semibold home svelte-30jr7w" href="/"><i class="bi-chevron-double-left"></i> VB Home</a></div><div class="d-flex right svelte-30jr7w"><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Become a Patreon" href="https://www.patreon.com/vbconsulting" target="_blank"><div class="patreon"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Buy Me a Coffee" href="https://www.buymeacoffee.com/vbilopavu" target="_blank"><div class="bmc"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto me-2 svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="login-endpoints.md on GitHub" href="https://github.com/vb-consulting/NpgsqlRest/blob/master/login-endpoints.md"><i class="bi-github"></i></a> <a class="github-button svelte-30jr7w" href="https://github.com/vb-consulting/NpgsqlRest/blob/master/login-endpoints.md" data-bs-toggle="tooltip" data-bs-html="true" title="Star login-endpoints.md on GitHub" data-color-scheme="no-preference: light_high_contrast; light: light_high_contrast; dark: light_high_contrast;" data-icon="octicon-star" data-show-count="true" aria-label="Star login-endpoints.md on GitHub"></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><button id="theme-btn" type="button" aria-pressed="true" aria-label="theme" class="svelte-30jr7w"><span class="check hidden svelte-30jr7w"><span class="icon svelte-30jr7w"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><path fill="currentColor" d="M12 21q-3.775 0-6.388-2.613T3 12q0-3.45 2.25-5.988T11 3.05q.625-.075.975.45t-.025 1.1q-.425.65-.638 1.375T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q.775 0 1.538-.225t1.362-.625q.525-.35 1.075-.037t.475.987q-.35 3.45-2.937 5.725T12 21Zm0-2q2.2 0 3.95-1.213t2.55-3.162q-.5.125-1 .2t-1 .075q-3.075 0-5.238-2.163T9.1 7.5q0-.5.075-1t.2-1q-1.95.8-3.163 2.55T5 12q0 2.9 2.05 4.95T12 19Zm-.25-6.75Z"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M0 0h24v24H0z"></path><path fill="currentColor" d="M12 19a1 1 0 0 1 .993.883L13 20v1a1 1 0 0 1-1.993.117L11 21v-1a1 1 0 0 1 1-1zm6.313-2.09l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7a1 1 0 0 1 1.218-1.567l.102.07zm-11.306.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM4 11a1 1 0 0 1 .117 1.993L4 13H3a1 1 0 0 1-.117-1.993L3 11h1zm17 0a1 1 0 0 1 .117 1.993L21 13h-1a1 1 0 0 1-.117-1.993L20 11h1zM6.213 4.81l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7A1 1 0 0 1 6.11 4.74l.102.07zm12.894.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM12 2a1 1 0 0 1 .993.883L13 3v1a1 1 0 0 1-1.993.117L11 4V3a1 1 0 0 1 1-1zm0 5a5 5 0 1 1-4.995 5.217L7 12l.005-.217A5 5 0 0 1 12 7z"></path></g></svg></span></span></button></div></div></nav></header><main class="svelte-9zwk14"><div class="sidebar sidebar-hide svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav accordion svelte-9zwk14"><li class="accordion-item svelte-9zwk14" title="VB-Consulting"><button class="accordion-header accordion-button collapsed svelte-9zwk14 text-uppercase" href="/" type="button" data-bs-toggle="collapse" data-bs-target="#accordion-vb-consulting" aria-expanded="false" aria-controls="accordion-vb-consulting">VB-Consulting</button><div id="accordion-vb-consulting" class="accordion-collapse collapse"><div class="accordion-body svelte-9zwk14"><ul class="navbar-nav"><li class="nav-item svelte-9zwk14" data-id="" title="Home"><a class="nav-link svelte-9zwk14 text-uppercase" href="/">Home</a></li><li class="nav-divider svelte-9zwk14"><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="Norm.Net"><a class="nav-link svelte-9zwk14 text-uppercase" href="/norm.net/">Norm.Net</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="RazorSvelte"><a class="nav-link svelte-9zwk14 text-uppercase" href="/razorsvelte/">RazorSvelte</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PgRoutiner"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgroutiner/">PgRoutiner</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="XUnit.Npgsql"><a class="nav-link svelte-9zwk14 text-uppercase" href="/xunit.npgsql/">XUnit.Npgsql</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PostrgeSQL Schema Tools"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pg_schema_tools/">PostrgeSQL Schema Tools</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">blogs</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="<span class='btn-link'>ALL BLOGS</span>"><a class="nav-link btn btn-sm w-fit px-3 mx-auto svelte-9zwk14 lr-arrow text-uppercase" href="/blogs/"><i class="bi bi-arrow-right-circle svelte-9zwk14"></i> <span class="btn-link">ALL BLOGS</span></a></li><li class="nav-item svelte-9zwk14" data-id="" title="PostgreSQL Arrays üêò"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-array/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>PostgreSQL Arrays üêò</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest Update 1.6.2"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-update1.6.2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest Update 1.6.2</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest v2 Update üêòüî•"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-v2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest v2 Update üêòüî•</a></li><li class="nav-item svelte-9zwk14" data-id="" title="How DDD is screwing up your SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/sql-vs-ddd/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>How DDD is screwing up your SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Common Sense Software Design"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/common-sense-design/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Common Sense Software Design</a></li><li class="nav-item svelte-9zwk14" data-id="" title="PostgreSQL Paging Benchmarks"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-paging/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>PostgreSQL Paging Benchmarks</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest NuGet Library"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest NuGet Library</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Execute Custom Function For Each Record"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-record-type/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Execute Custom Function For Each Record</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Custom Temporal Tables in PostgreSQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-temporal-tables/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Custom Temporal Tables in PostgreSQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Recursion with PostgreSQL Part 1 - A Different Type of Recursion"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/recursion-postgresql/part1-different-type-of-recursion/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Recursion with PostgreSQL Part 1 - A Different Type of Recursion</a></li></ul></div></div></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">NpgsqlRest</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/">NpgsqlRest</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="options"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/options/">options</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="annotations"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/annotations/">annotations</a></li><li class="nav-item toc2 svelte-9zwk14 active" data-id="" title="login endpoints"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/login-endpoints/">login endpoints</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="performances"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/performances/">performances</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="changelog"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/changelog/">changelog</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">client app</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="client"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/client/">client</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="client npm package"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/client-npm/">client npm package</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="client default config"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/config/">client default config</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">plugins</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest CrudSource"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/crudsource/">NpgsqlRest CrudSource</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest HttpFiles"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/httpfiles/">NpgsqlRest HttpFiles</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest TsClient"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/tsclient/">NpgsqlRest TsClient</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">articles</span><hr class="svelte-9zwk14"></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest v2 Update üêòüî•"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-v2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest v2 Update üêòüî•</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest Update 1.6.2"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-update1.6.2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest Update 1.6.2</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest NuGet Library"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest NuGet Library</a></li></ul></div></div><div class="content svelte-9zwk14"><div class="container-sm main-content gh-content"><h1 id="login-endpoints">Login Endpoints<a class="anchor bookmark-target" href="#login-endpoints"><i class="bi bi-link-45deg"></i></a></h1><a href="https://github.com/vb-consulting/NpgsqlRest/blob/master/login-endpoints.md" class="github-edit"><i class="bi bi-github"></i>Edit this page on GitHub</a><p>Endpoints can be labeled as Login endpoints to act as authentication endpoints and perform user sign-in operations.</p><h2 id="how-to-label-login-endpoint">How To Label Login Endpoint<a class="anchor bookmark-target" href="#how-to-label-login-endpoint"><i class="bi bi-link-45deg"></i></a></h2><ol><li>By using <code>EndpointCreated</code> callback:</li></ol><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">UseNpgsqlRest</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRestOptions</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">EndpointCreated</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">routine</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=></span></span>
<span class="line"><span style="color: #E6E6E6">    {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">routine</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">==</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"login"</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">        {</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Login</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #C586C0">return</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">});</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">UseNpgsqlRest</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRestOptions</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">EndpointCreated</span><span style="color: #000000"> = (</span><span style="color: #001080">routine</span><span style="color: #000000">, </span><span style="color: #001080">endpoint</span><span style="color: #000000">) =></span></span>
<span class="line"><span style="color: #000000">    {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">routine</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000"> == </span><span style="color: #A31515">"login"</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">        {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">Login</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">endpoint</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">});</span></span></code></pre></div><ol start="2"><li>By using the <a href="https://vb-consulting.github.io/npgsqlrest/annotations/#login"><code>login</code> endpoint annotation</a>:</li></ol><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">auth</span><span style="color: #E6E6E6">.</span><span style="color: #569CD6">login</span><span style="color: #E6E6E6">(_username </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, _password </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">) </span></span>
<span class="line"><span style="color: #569CD6">returns</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">table</span><span style="color: #E6E6E6"> (</span><span style="color: #569CD6">status</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, name_identifier </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">name</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">role</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">[])</span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">sql</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #6A9955">-- select query that returns status, name_identifier, name and role array</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">comment on function auth.login(text, text) is </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">HTTP POST</span></span>
<span class="line"><span style="color: #CE9178">Login</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">auth</span><span style="color: #000000">.</span><span style="color: #0000FF">login</span><span style="color: #000000">(_username </span><span style="color: #0000FF">text</span><span style="color: #000000">, _password </span><span style="color: #0000FF">text</span><span style="color: #000000">) </span></span>
<span class="line"><span style="color: #0000FF">returns</span><span style="color: #000000"> </span><span style="color: #0000FF">table</span><span style="color: #000000"> (</span><span style="color: #0000FF">status</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000">, name_identifier </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span><span style="color: #0000FF">name</span><span style="color: #000000"> </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span><span style="color: #0000FF">role</span><span style="color: #000000"> </span><span style="color: #0000FF">text</span><span style="color: #000000">[])</span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> </span><span style="color: #0000FF">sql</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #008000">-- select query that returns status, name_identifier, name and role array</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">comment on function auth.login(text, text) is </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">HTTP POST</span></span>
<span class="line"><span style="color: #A31515">Login</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span></code></pre></div><h2 id="login-endpoint-conventions">Login Endpoint Conventions<a class="anchor bookmark-target" href="#login-endpoint-conventions"><i class="bi bi-link-45deg"></i></a></h2><ul><li><p>The login-enabled endpoints must return a <strong>named record (table)</strong>.</p></li><li><p>If the return type is not named record and it is one of these instead (<code>void</code> type, a simple value like <code>int</code> or <code>text</code>, or unnamed record) the endpoint will return an <strong>unauthorized status (code 401)</strong>.</p></li><li><p>If the endpoint has a return type <strong>named record</strong> - but it returns an empty record the endpoint will return an <strong>unauthorized status (code 401)</strong>.</p></li><li><p>If the endpoint has a return type <strong>named record</strong> - and does return some records - only the first records will be read and parsed, the rest is discarded.</p></li><li><p>Returned columns are parsed by the column name. Column name can be the original column name from PostgreSQL or, parsed by the <a href="https://vb-consulting.github.io/npgsqlrest/options/#nameconverter">default name converter</a>. This camel case name converter, by default (unless changed in options).</p></li><li><p>Three special column names are interpreted differently: the <strong>status</strong> column, the <strong>scheme</strong> column and the <strong>message</strong> column. See below for more details.</p></li><li><p>If the column is neither of those three, the column name is interpreted as the <a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.claims.claim?view=net-8.0">security claim type</a> and and column value is the security claim value (for the given type). These are values such as user name, user id, etc...</p></li></ul><h3 id="claim-types">Claim Types<a class="anchor bookmark-target" href="#claim-types"><i class="bi bi-link-45deg"></i></a></h3><ul><li><p>By default, if the column name interpreted as the security claim type, matches one of the Active Directory Federation Services Claim Types names, it will use that AD Federation Services Claim Type URI. The table can be seen here: <a href="https://learn.microsoft.com/en-us/dotnet/api/system.security.claims.claimtypes?view=net-8.0#fields">ClaimTypes Class</a>.</p></li><li><p>That means that if the column name is either of these <code>NameIdentifier</code> - or the <code>nameidentifier</code> (case is ignored), or the <code>name_identifier</code> (for the camel case converted names, which is the default), the actual security claim type is <code>http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier</code> according to this table.</p></li><li><p>If the name is not found in this table, security is the column name as-is but parsed by the default name converter.</p></li><li><p>In this example column name <code>name_identifier</code> will be the security claim type the <code>nameIdentifier</code>.</p></li><li><p>This behavior that uses AD Federation Services Claim Type can be turned off with the <a href="https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseactivedirectoryfederationservicesclaimtypes">AuthenticationOptions.UseActiveDirectoryFederationServicesClaimTypes option</a>.</p></li></ul><h3 id="status-columns">Status Columns<a class="anchor bookmark-target" href="#status-columns"><i class="bi bi-link-45deg"></i></a></h3><ul><li><p>The status column name is set by the option <a href="https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsstatuscolumnname">AuthenticationOptions.StatusColumnName</a>. The default is <code>status</code>.</p></li><li><p>This column can only be a boolean or numeric type. If it is neither boolean nor numeric, the endpoint will return status <code>500 InternalServerError</code> and you'll have to check logs.</p></li><li><p>When this field is boolean, and it is true, the login process will continue with security claims set by other fields (which usually ends up in <code>200 OK</code> if authentication is configured). If it is false, the endpoint will return <code>404 NotFound</code> and the login attempt will not continue.</p></li><li><p>When this field is numeric, and it is 200, the login process will continue with security claims set by other fields (which usually ends up in <code>200 OK</code> if authentication is configured). If it is not 200, the endpoint will return the status code the same as the value of this field, and the login attempt will not continue.</p></li></ul><h3 id="scheme-columns">Scheme Columns<a class="anchor bookmark-target" href="#scheme-columns"><i class="bi bi-link-45deg"></i></a></h3><ul><li><p>The scheme column name is set by the option <a href="https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsschemecolumnname">AuthenticationOptions.SchemeColumnName</a>. The default is <code>scheme</code>.</p></li><li><p>The textual value of this field will set the authentication scheme name for the sign-in operation.</p></li><li><p>This is useful when using multiple authentication schemes. Returning any value from the logout routine will cause a logout from only that scheme. So for example, if you have the Cookie scheme and the Bearer Token scheme configured, you can handle them separately for login and logout.</p></li></ul><h3 id="message-columns">Message Columns<a class="anchor bookmark-target" href="#message-columns"><i class="bi bi-link-45deg"></i></a></h3><ul><li><p>The status column name is set by the option <a href="https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsmessagecolumnname">AuthenticationOptions.MessageColumnName</a>. The default is <code>message</code>.</p></li><li><p>This is the textual message that is returned in the response body.</p></li><li><p>Note: this message is only returned in a case when the configured authentication scheme doesn't write anything into the response body on a sign-in operation.</p></li><li><p>For example, the Cookie authentication scheme doesn't write anything into the body and this message is safely written to the response body. On the other hand, the Bearer Token schemes will always write the response body and this message will not be written to the response body.</p></li></ul><div class="pt-5 border-top"><div id="comments-section" class="h5">Comments</div><script defer src="https://cdn.commento.io/js/commento.js" data-no-fonts="true" data-css-override="https://vb-consulting.github.io/style.css"></script><div id="commento"></div></div><footer class="mt-3 py-5"><div class="w-fit mx-auto mb-3 border-top border-bottom"><div class="alert text-center fs-smaller text-muted"><div class="alert text-center fs-smaller text-muted mb-1">If you like my content, use my software, or otherwise benefit from my work, consider supporting me by buying me a coffee. The software runs on coffee after all.</div><a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="Click Here to Buy Me a Coffee Or Scan the Code" href="https://www.buymeacoffee.com/vbilopavu" style="display: inline-grid;">Buy me a Coffee <img class="m-auto svelte-byttq0" alt="Scan Here To Buy Me a Cofee" src="/bmc_qr.png"></a></div></div><div class="d-flex justify-content-center"><a class="btn rl-arrow me-1" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="login-endpoints.md on GitHub" href="https://github.com/vb-consulting/NpgsqlRest/blob/master/login-endpoints.md" style="display: inline-grid;">login-endpoints.md on GitHub <i class="bi bi-github"></i></a> <a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="I Post Software Development Content Daily" href="https://www.linkedin.com/in/vb-software/" style="display: inline-grid;">Follow me on LinkedIn <i class="bi bi-linkedin"></i></a></div><div class="text-center"><div class="mt-5 mb-5 background-floki svelte-byttq0" data-bs-toggle="tooltip" data-bs-html="true" title="Floki is a developer dog."></div></div></footer></div></div><div class="rightside svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav svelte-9zwk14"><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">on this page</span><hr class="svelte-9zwk14"></li><li class="nav-item toc1 right svelte-9zwk14 bookmark-nav" data-id="login-endpoints" title="Login Endpoints"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#login-endpoints">Login Endpoints</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="how-to-label-login-endpoint" title="How To Label Login Endpoint"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#how-to-label-login-endpoint">How To Label Login Endpoint</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="login-endpoint-conventions" title="Login Endpoint Conventions"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#login-endpoint-conventions">Login Endpoint Conventions</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="claim-types" title="Claim Types"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#claim-types">Claim Types</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="status-columns" title="Status Columns"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#status-columns">Status Columns</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="scheme-columns" title="Scheme Columns"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#scheme-columns">Scheme Columns</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="message-columns" title="Message Columns"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#message-columns">Message Columns</a></li></ul></div></div></main><script>!function(){var i=document.querySelector("nav.navbar"),f=document.getElementsByTagName("main")[0],L=f.getElementsByClassName("sidebar")[0],w=f.getElementsByClassName("content")[0],o=document.querySelectorAll("div.code"),k=i.querySelector(".home");function E(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n])}function T(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n]);E(e,t),e.classList.add(t)}function t(e,t){var n=e.currentTarget;if(!n.classList.contains("bi-check")){for(var i="",o=0;o<n.classList.length;o++)if(n.classList[o].startsWith("bi-")){i=n.classList[o];break}n.classList.remove(i),n.classList.add("spinner-border-sm"),n.classList.add("spinner-border");e=bootstrap.Tooltip.getInstance(n);e&&(e.setContent({".tooltip-inner":"Copying..."}),e.show()),t(n,function(){var e;n.classList.remove(i),n.classList.remove("spinner-border-sm"),n.classList.remove("spinner-border"),n.classList.add("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&(e.setContent({".tooltip-inner":"Copied!"}),e.show()),setTimeout(function(){var e;n.classList.add(i),n.classList.remove("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&e.setContent({".tooltip-inner":n.dataset.bsTitle})},2e3)})}}"/"==document.location.pathname&&T(k,"d-none");var e=document.querySelector(".post-share > .copy-url"),n=(e&&e.addEventListener("click",function(e){t(e,function(e,t){navigator.clipboard.writeText(document.location.origin+document.location.pathname),t()})}),document.getElementsByTagName("html")[0]),a=i.querySelector("#theme-btn"),s="theme";function l(e){var t=a.getElementsByTagName("svg");"dark"===e?(t[0].style.display="",t[1].style.display="none",a.getElementsByClassName("check")[0].classList.add("checked")):(t[0].style.display="none",t[1].style.display="",a.getElementsByClassName("check")[0].classList.remove("checked"));for(var n=0;n<o.length;n++){var i=o[n];"dark"===e?(i.children[1].style.display="inherit",i.children[2].style.display="none"):"light"===e&&(i.children[1].style.display="none",i.children[2].style.display="inherit")}window._theme&&window._theme(e)}function r(e){t(e,function(e,t){navigator.clipboard.writeText(e.parentElement.nextSibling.innerText),t()})}function c(e){t(e,function(e,t){var n=localStorage.getItem(s);e="dark"===n?e.parentElement.parentElement.children[1]:e.parentElement.parentElement.children[2],setTimeout(function(){html2canvas(e).then(e=>{e.toBlob(e=>navigator.clipboard.write([new ClipboardItem({"image/png":e})])),t()})},0)})}a.addEventListener("click",()=>{var e="dark"===localStorage.getItem(s)?"light":"dark";localStorage.setItem(s,e),l(n.dataset.bsTheme=e)}),l(localStorage.getItem(s)),a.children[0].classList.remove("hidden");for(var d=0;d<o.length;d++){o[d].getElementsByClassName("copy-code")[0].addEventListener("click",r);var m=o[d].getElementsByClassName("photo-code");m.length&&m[0].addEventListener("click",c)}for(var S=function(){var a,o,s;if(f.children[2]&&"none"!=f.children[2].style.display)return a=f.querySelector(".main-content").querySelectorAll("[id]"),o=void 0,this.initNavs=function(e){s=e.querySelectorAll("li.bookmark-nav");for(var t=0;t<a.length;t++){for(var n=a[t].id,i=null,o=0;o<s.length;o++)if(s[o].dataset.id==n){i=s[o];break}a[t].nav=i}setTimeout(function(){for(var e=0;e<a.length;e++){var t=a[e];if(l(t).visible&&t.nav)return void t.nav.classList.add("active")}},1e3),r()},f.children[1].addEventListener("scroll",r),this;function l(e){var e=e.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight),n=0<e.top&&!(e.bottom<0||0<=e.top-t)||e.top<0&&e.bottom>t,i=!1;return{visible:n,above:i=n?i:e.bottom<t}}function r(){if(s&&s.length){for(var e=0;e<s.length;e++)s[e].classList.remove("active");for(var t=void 0,e=0;e<a.length;e++){const i=a[e];var n=l(i);if(!n.visible&&n.above&&(t=i.nav),n.visible&&i.nav&&!i.nav.classList.contains("active"))return i.nav.classList.add("active"),o&&clearTimeout(o),void(o=setTimeout(function(){i.nav.scrollIntoView({behavior:"smooth"}),o=void 0},250))}t&&!t.classList.contains("active")&&(t.classList.add("active"),o&&clearTimeout(o),o=setTimeout(function(){t.scrollIntoView({behavior:"smooth"}),o=void 0},250))}}}(),h=function(){var l,r=i.querySelector("#nav-btn"),c=480,d="200px",m="0.25fr",h=730,v=535,u=f.children[0].children[0].children[0],g=f.children[2]&&f.children[2].children[0].children[0],t="sidebar-pinned",p=null==localStorage.getItem(t)||"true"==localStorage.getItem(t),y=!1,b=!1;function n(){window._onresize&&window._onresize();var e=window.outerWidth||window.innerWidth,t=e<c,n=t?y?"100%":"0":p?""+d:"0",i=`grid-template-columns: ${n} 1fr`,o=t&&y?"width: 100%":"0"!=n?"":"display: none",a=t&&y?"display: none":"",s=t?y?"sidebar-show":"sidebar-hide":p?"sidebar-show":"sidebar-hide",n="0"==n;f.children[2]&&(m&&h&&v&&(n&&e<v||!n&&e<h?b||(u.innerHTML=l+g.innerHTML,S.initNavs(u),b=!0):b&&(u.innerHTML=l,S.initNavs(g),b=!1)),!m||t||b?(i+=";",f.children[2].style.display="none"):(i+=` ${m};`,f.children[2].style.display="")),T(r,!t&&p||t&&y?"rotate":"rotate-back","rotate","rotate-back"),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),f.style=L?i:"display: grid;",L&&T(L,s,"sidebar-show","sidebar-hide"),L&&(L.firstChild.style=o),w.style=a,t&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),t&&y&&T(k,"d-none")}function e(){var e=window.outerWidth<c;e?y=!y:p=!p,localStorage.setItem(t,p.toString()),n(),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),e&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),e&&y&&T(k,"d-none")}return m&&h&&v&&g&&(l=u.innerHTML,S.initNavs(g)),r.addEventListener("click",e),(window.onresize=n)(),this.closeSidebar=function(){window.outerWidth<c&&y&&e()},this}(),v=document.getElementsByClassName("auto-close"),u=0;u<v.length;u++)v[u].addEventListener("click",function(e){h.closeSidebar()});location.hash&&(e=document.getElementById(location.hash.replace("#","")))&&e.scrollIntoView()}();</script><script src="/bootstrap.bundle.min.js"></script><script>!function(){for(var e=document.querySelectorAll('[data-bs-toggle="tooltip"]'),t=0;t<e.length;t++)new bootstrap.Tooltip(e[t]);var n=document.getElementsByClassName("accordion-item");if(n.length){for(t=0;t<n.length;t++){var o=n[t];o.querySelectorAll("[href='"+document.location.pathname+"']").length&&o.firstChild.click()}var l=document.querySelector("nav.navbar").querySelector(".home"),a=document.getElementsByClassName("accordion");"/"==document.location.pathname&&l.classList.add("d-none");for(t=0;t<n.length;t++){var s=a[t];s&&s.firstChild&&"VB-Consulting"==s.firstChild.title&&(null!=s.firstChild.querySelector(".collapse")&&l.classList.contains("d-none")&&"/"!=document.location.pathname&&l.classList.remove("d-none"),s.addEventListener("show.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none"),l.classList.add("d-none")}),s.addEventListener("hide.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none")}))}}}();</script><script src="/html2canvas.min.js"></script><script async defer src="https://buttons.github.io/buttons.js"></script></body><script async data-id="101435862" src="//static.getclicky.com/js"></script></html>