<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NpgsqlRest - Automatic REST API for PostgreSQL Database</title><meta name="description" content="Automatic REST API for PostgreSQL Database"><meta name="keywords" content="api, api-rest, restful-api, http, postgres, dotnet, net8, c#, aot, database, rest, server, postgresql, npgsqlrest, pgsql, pg, automatic"><link href="https://vb-consulting.github.io//npgsqlrest/changelog/" rel="canonical"><link rel="stylesheet" href="/_elderjs/assets/svelte-110991bc.css" media="all"><style></style><link href="/style.css?1749809518414" rel="stylesheet"><script>!function(){var e="theme",t=localStorage.getItem(e);t||(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",localStorage.setItem(e,t)),document.getElementsByTagName("html")[0].dataset.bsTheme=t}();</script></head><body class="d-flex flex-column h-100"><header id="header"><nav class="navbar navbar-expand-md navbar-dark fixed-top py-0 py-md-0 svelte-30jr7w"><div class="container-fluid flex-nowrap svelte-30jr7w"><div class="d-flex svelte-30jr7w"><button id="nav-btn" type="button" class="d-flex btn btn-sm logo animate-rotate svelte-30jr7w"><i class="material-icons-outlined">menu</i></button> <a class="nav-link my-auto ms-2 fw-semibold home svelte-30jr7w" href="/"><i class="bi-chevron-double-left"></i> VB Home</a></div><div class="d-flex right svelte-30jr7w"><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Become a Patreon" href="https://www.patreon.com/vbconsulting" target="_blank"><div class="patreon"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Buy Me a Coffee" href="https://www.buymeacoffee.com/vbilopavu" target="_blank"><div class="bmc"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto me-2 svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="changelog.md on GitHub" href="https://github.com/vb-consulting/NpgsqlRest/blob/master/changelog.md"><i class="bi-github"></i></a> <a class="github-button svelte-30jr7w" href="https://github.com/vb-consulting/NpgsqlRest/blob/master/changelog.md" data-bs-toggle="tooltip" data-bs-html="true" title="Star changelog.md on GitHub" data-color-scheme="no-preference: light_high_contrast; light: light_high_contrast; dark: light_high_contrast;" data-icon="octicon-star" data-show-count="true" aria-label="Star changelog.md on GitHub"></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><button id="theme-btn" type="button" aria-pressed="true" aria-label="theme" class="svelte-30jr7w"><span class="check hidden svelte-30jr7w"><span class="icon svelte-30jr7w"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><path fill="currentColor" d="M12 21q-3.775 0-6.388-2.613T3 12q0-3.45 2.25-5.988T11 3.05q.625-.075.975.45t-.025 1.1q-.425.65-.638 1.375T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q.775 0 1.538-.225t1.362-.625q.525-.35 1.075-.037t.475.987q-.35 3.45-2.937 5.725T12 21Zm0-2q2.2 0 3.95-1.213t2.55-3.162q-.5.125-1 .2t-1 .075q-3.075 0-5.238-2.163T9.1 7.5q0-.5.075-1t.2-1q-1.95.8-3.163 2.55T5 12q0 2.9 2.05 4.95T12 19Zm-.25-6.75Z"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M0 0h24v24H0z"></path><path fill="currentColor" d="M12 19a1 1 0 0 1 .993.883L13 20v1a1 1 0 0 1-1.993.117L11 21v-1a1 1 0 0 1 1-1zm6.313-2.09l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7a1 1 0 0 1 1.218-1.567l.102.07zm-11.306.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM4 11a1 1 0 0 1 .117 1.993L4 13H3a1 1 0 0 1-.117-1.993L3 11h1zm17 0a1 1 0 0 1 .117 1.993L21 13h-1a1 1 0 0 1-.117-1.993L20 11h1zM6.213 4.81l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7A1 1 0 0 1 6.11 4.74l.102.07zm12.894.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM12 2a1 1 0 0 1 .993.883L13 3v1a1 1 0 0 1-1.993.117L11 4V3a1 1 0 0 1 1-1zm0 5a5 5 0 1 1-4.995 5.217L7 12l.005-.217A5 5 0 0 1 12 7z"></path></g></svg></span></span></button></div></div></nav></header><main class="svelte-9zwk14"><div class="sidebar sidebar-hide svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav accordion svelte-9zwk14"><li class="accordion-item svelte-9zwk14" title="VB-Consulting"><button class="accordion-header accordion-button collapsed svelte-9zwk14 text-uppercase" href="/" type="button" data-bs-toggle="collapse" data-bs-target="#accordion-vb-consulting" aria-expanded="false" aria-controls="accordion-vb-consulting">VB-Consulting</button><div id="accordion-vb-consulting" class="accordion-collapse collapse"><div class="accordion-body svelte-9zwk14"><ul class="navbar-nav"><li class="nav-item svelte-9zwk14" data-id="" title="Home"><a class="nav-link svelte-9zwk14 text-uppercase" href="/">Home</a></li><li class="nav-divider svelte-9zwk14"><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="Norm.Net"><a class="nav-link svelte-9zwk14 text-uppercase" href="/norm.net/">Norm.Net</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="RazorSvelte"><a class="nav-link svelte-9zwk14 text-uppercase" href="/razorsvelte/">RazorSvelte</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PgRoutiner"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgroutiner/">PgRoutiner</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="XUnit.Npgsql"><a class="nav-link svelte-9zwk14 text-uppercase" href="/xunit.npgsql/">XUnit.Npgsql</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="pgmigrations"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgmigrations/">pgmigrations</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PostrgeSQL Schema Tools"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pg_schema_tools/">PostrgeSQL Schema Tools</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">blogs</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="<span class='btn-link'>ALL BLOGS</span>"><a class="nav-link btn btn-sm w-fit px-3 mx-auto svelte-9zwk14 lr-arrow text-uppercase" href="/blogs/"><i class="bi bi-arrow-right-circle svelte-9zwk14"></i> <span class="btn-link">ALL BLOGS</span></a></li><li class="nav-item svelte-9zwk14" data-id="" title="WebAPI Load Tests"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/load-test/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>WebAPI Load Tests</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest v2 Update üêòüî•"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-v2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest v2 Update üêòüî•</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest Update 1.6.2"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-update1.6.2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest Update 1.6.2</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/todo/part1-todo-requirements/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Unit Testing and TDD With PostgreSQL is Easy"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/unit-testing-postgresql/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Unit Testing and TDD With PostgreSQL is Easy</a></li><li class="nav-item svelte-9zwk14" data-id="" title="From Transaction Scripts and Domain Model to SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/domain-model-transaction-script/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>From Transaction Scripts and Domain Model to SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Transaction Script DDD vs SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/transaction-script/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Transaction Script DDD vs SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Common Sense Software Design"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/common-sense-design/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Common Sense Software Design</a></li><li class="nav-item svelte-9zwk14" data-id="" title="PostgreSQL Arrays üêò"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-array/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>PostgreSQL Arrays üêò</a></li><li class="nav-item svelte-9zwk14" data-id="" title="How DDD is screwing up your SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/sql-vs-ddd/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>How DDD is screwing up your SQL</a></li></ul></div></div></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">NpgsqlRest</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/">NpgsqlRest</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="options"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/options/">options</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="annotations"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/annotations/">annotations</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="login endpoints"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/login-endpoints/">login endpoints</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="performances"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/performances/">performances</a></li><li class="nav-item toc2 svelte-9zwk14 active" data-id="" title="changelog"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/changelog/">changelog</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">client app</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="client"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/client/">client</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="client npm package"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/client-npm/">client npm package</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="client default config"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/config/">client default config</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">plugins</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest CrudSource"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/crudsource/">NpgsqlRest CrudSource</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest HttpFiles"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/httpfiles/">NpgsqlRest HttpFiles</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest TsClient"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/tsclient/">NpgsqlRest TsClient</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">articles</span><hr class="svelte-9zwk14"></li><li class="nav-item svelte-9zwk14" data-id="" title="Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/todo/part1-todo-requirements/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest NuGet Library"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest NuGet Library</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest v2 Update üêòüî•"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-v2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest v2 Update üêòüî•</a></li><li class="nav-item svelte-9zwk14" data-id="" title="NpgsqlRest Update 1.6.2"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-update1.6.2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest Update 1.6.2</a></li></ul></div></div><div class="content svelte-9zwk14"><div class="container-sm main-content gh-content"><h1 id="changelog">Changelog<a class="anchor bookmark-target" href="#changelog"><i class="bi bi-link-45deg"></i></a></h1><a href="https://github.com/vb-consulting/NpgsqlRest/blob/master/changelog.md" class="github-edit"><i class="bi bi-github"></i>Edit this page on GitHub</a><p>Note: The changelog for the older version can be found here: <a href="https://github.com/vb-consulting/NpgsqlRest/blob/master/changelog-old.md">Changelog Archive</a></p><hr><h2 id="version-2280-2025-06-12">Version <a href="https://github.com/vb-consulting/NpgsqlRest/tree/2.28.0">2.28.0</a> (2025-06-12)<a class="anchor bookmark-target" href="#version-2280-2025-06-12"><i class="bi bi-link-45deg"></i></a></h2><p><a href="https://github.com/vb-consulting/NpgsqlRest/compare/2.27.0...2.28.0">Full Changelog</a></p><h3 id="core-library">Core Library<a class="anchor bookmark-target" href="#core-library"><i class="bi bi-link-45deg"></i></a></h3><h4 id="improved-error-handling">Improved error handling.<a class="anchor bookmark-target" href="#improved-error-handling"><i class="bi bi-link-45deg"></i></a></h4><ul><li>All errors are handled properly now. Non-PostgreSQL errors will return 501 and all relevant data will be sent to the default logger.</li></ul><h4 id="big-improvements-in-upload-handlers">Big Improvements in Upload Handlers<a class="anchor bookmark-target" href="#big-improvements-in-upload-handlers"><i class="bi bi-link-45deg"></i></a></h4><ul><li>All Upload Handlers will always return a JSON metadata which will be array of objects. Each object have following signature:</li></ul><div class="code ts"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">interface</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">UploadMetadata</span><span style="color: #E6E6E6"> {</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">type</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6">; </span><span style="color: #6A9955">// handler key: large_object, file_system or csv</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">fileName</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">contentType</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">size</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">number</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">success</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">boolean</span><span style="color: #E6E6E6">; </span><span style="color: #6A9955">// will be true for only for status=Ok</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">status</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6">; </span><span style="color: #6A9955">// Empty, ProbablyBinary, InvalidImage, InvalidFormat, NoNewLines, InvalidMimeType, Ignored, Ok</span></span>
<span class="line"><span style="color: #E6E6E6">  [</span><span style="color: #9CDCFE">key</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6">]</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">|</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">number</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">|</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">boolean</span><span style="color: #E6E6E6">; </span><span style="color: #6A9955">// depends on a handler type</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">UploadMetadata</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">type</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">; </span><span style="color: #008000">// handler key: large_object, file_system or csv</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">fileName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">contentType</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">size</span><span style="color: #000000">: </span><span style="color: #267F99">number</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">success</span><span style="color: #000000">: </span><span style="color: #267F99">boolean</span><span style="color: #000000">; </span><span style="color: #008000">// will be true for only for status=Ok</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #001080">status</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">; </span><span style="color: #008000">// Empty, ProbablyBinary, InvalidImage, InvalidFormat, NoNewLines, InvalidMimeType, Ignored, Ok</span></span>
<span class="line"><span style="color: #000000">  [</span><span style="color: #001080">key</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">]: </span><span style="color: #267F99">string</span><span style="color: #000000"> | </span><span style="color: #267F99">number</span><span style="color: #000000"> | </span><span style="color: #267F99">boolean</span><span style="color: #000000">; </span><span style="color: #008000">// depends on a handler type</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>There are 8 shared parameters:</p><ul><li><code>stop_after_first_success</code>: Set to true to stop the upload after the first succesuful upload when multiple handlers are used. Subsequent files will be ignored (status: <code>Ignored</code>). Default is false.</li><li><code>included_mime_types</code>: CSV string containing mime type patters to include, set to null to ignore. Default is null.</li><li><code>excluded_mime_types</code>: CSV string containing mime type patters to exclude, set to null to ignore. Default is null.</li><li><code>buffer_size</code>: Size of a buffer in bytes when uploading a raw content to handlers like <code>large_object</code> and <code>file_system</code>. Default is null.</li><li><code>check_text</code>: Boolean value to check is a file a valid textual file or a binary. Set to true to accpet only text file. Default is false.</li><li><code>check_image</code>: Boolean value to check is a file a valid image. Set to true to accpet only images. It can also be a CSV text with allowed image types, such as <code>jpg</code>, <code>png</code>, <code>gif</code>, <code>bmp</code>, <code>tiff</code> or <code>webp</code>. Default is false.</li><li><code>test_buffer_size</code>: Buffer size in bytes when checking text files. Default is 4096.</li><li><code>non_printable_threshold</code>: Maximum count of non prinatble charactes allowed in test buffer to consider a valid text file. Default is 5.</li></ul><p>Upload handler <code>large_object</code> accepts the following parameters:</p><ul><li><code>stop_after_first_success</code></li><li><code>included_mime_types</code></li><li><code>excluded_mime_types</code></li><li><code>buffer_size</code></li><li><code>oid</code></li><li><code>check_text</code></li><li><code>check_image</code></li><li><code>test_buffer_size</code></li><li><code>non_printable_threshold</code></li><li><code>large_object_included_mime_types</code></li><li><code>large_object_excluded_mime_types</code></li><li><code>large_object_buffer_size</code></li><li><code>large_object_oid</code></li><li><code>large_object_check_text</code></li><li><code>large_object_check_image</code></li><li><code>large_object_test_buffer_size</code></li><li><code>large_object_non_printable_threshold</code></li></ul><p>Upload handler <code>file_system</code> accepts the following parameters:</p><ul><li><code>stop_after_first_success</code></li><li><code>included_mime_types</code></li><li><code>excluded_mime_types</code></li><li><code>buffer_size</code></li><li><code>path</code></li><li><code>file</code></li><li><code>unique_name</code></li><li><code>create_path</code></li><li><code>check_text</code></li><li><code>check_image</code></li><li><code>test_buffer_size</code></li><li><code>non_printable_threshold</code></li><li><code>file_system_included_mime_types</code></li><li><code>file_system_excluded_mime_types</code></li><li><code>file_system_buffer_size</code></li><li><code>file_system_path</code></li><li><code>file_system_file</code></li><li><code>file_system_unique_name</code></li><li><code>file_system_create_path</code></li><li><code>file_system_check_text</code></li><li><code>file_system_check_image</code></li><li><code>file_system_test_buffer_size</code></li><li><code>file_system_non_printable_threshold</code></li></ul><p>Upload handler <code>csv</code> accepts the following parameters:</p><ul><li><code>stop_after_first_success</code></li><li><code>included_mime_types</code></li><li><code>excluded_mime_types</code></li><li><code>check_format</code></li><li><code>test_buffer_size</code></li><li><code>non_printable_threshold</code></li><li><code>delimiters</code></li><li><code>has_fields_enclosed_in_quotes</code></li><li><code>set_white_space_to_null</code></li><li><code>row_command</code></li><li><code>csv_included_mime_types</code></li><li><code>csv_excluded_mime_types</code></li><li><code>csv_check_format</code></li><li><code>csv_test_buffer_size</code></li><li><code>csv_non_printable_threshold</code></li><li><code>csv_delimiters</code></li><li><code>csv_has_fields_enclosed_in_quotes</code></li><li><code>csv_set_white_space_to_null</code></li><li><code>csv_row_command</code></li></ul><h3 id="npgsqlrest-client">NpgsqlRest Client<a class="anchor bookmark-target" href="#npgsqlrest-client"><i class="bi bi-link-45deg"></i></a></h3><h4 id="added-usecryptographicalgorithms-option-to-dataprotection">Added UseCryptographicAlgorithms option to DataProtection<a class="anchor bookmark-target" href="#added-usecryptographicalgorithms-option-to-dataprotection"><i class="bi bi-link-45deg"></i></a></h4><div class="code jsonc"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// Data protection settings. Encryption keys for Auth Cookies and Antiforgery tokens.</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">"DataProtection"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// When disabled, data protection keys will be stored in an unencrypted form</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"UseCryptographicAlgorithms"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"Enabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// AES_128_CBC, AES_192_CBC, AES_256_CBC, AES_128_GCM, AES_192_GCM, AES_256_GCM</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"EncryptionAlgorithm"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"AES_256_CBC"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// HMACSHA256, HMACSHA512</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"ValidationAlgorithm"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"HMACSHA256"</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// Data protection settings. Encryption keys for Auth Cookies and Antiforgery tokens.</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0451A5">"DataProtection"</span><span style="color: #000000">: {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// When disabled, data protection keys will be stored in an unencrypted form</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"UseCryptographicAlgorithms"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"Enabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// AES_128_CBC, AES_192_CBC, AES_256_CBC, AES_128_GCM, AES_192_GCM, AES_256_GCM</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"EncryptionAlgorithm"</span><span style="color: #000000">: </span><span style="color: #A31515">"AES_256_CBC"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// HMACSHA256, HMACSHA512</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"ValidationAlgorithm"</span><span style="color: #000000">: </span><span style="color: #A31515">"HMACSHA256"</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h4 id="improved-cors-handling">Improved CORS Handling<a class="anchor bookmark-target" href="#improved-cors-handling"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Two more options: <code>"AllowCredentials": true</code> and <code>"PreflightMaxAgeSeconds": 600</code></li></ul><h4 id="excel-upload-handler">Excel Upload Handler<a class="anchor bookmark-target" href="#excel-upload-handler"><i class="bi bi-link-45deg"></i></a></h4><p>Excel Upload Handler Implemented only in the Client Application. It is using a lightwieght ExcelDataReader library to handle Excel files.</p><p>It can accept any of these parameters:</p><ul><li><code>stop_after_first_success</code></li><li><code>included_mime_types</code></li><li><code>excluded_mime_types</code></li><li><code>sheet_name</code></li><li><code>all_sheets</code></li><li><code>time_format</code></li><li><code>date_format</code></li><li><code>datetime_format</code></li><li><code>row_is_json</code></li><li><code>row_command</code></li><li><code>excel_included_mime_types</code></li><li><code>excel_excluded_mime_types</code></li><li><code>excel_sheet_name</code></li><li><code>excel_all_sheets</code></li><li><code>excel_time_format</code></li><li><code>excel_date_format</code></li><li><code>excel_datetime_format</code></li><li><code>excel_row_is_json</code></li><li><code>excel_row_command</code></li></ul><h4 id="new-upload-options">New Upload Options<a class="anchor bookmark-target" href="#new-upload-options"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Defualt configuration now looks like this:</li></ul><div class="code jsonc"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// Data protection settings. Encryption keys for Auth Cookies and Antiforgery tokens.</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">"NpgsqlRest"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"UploadOptions"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"Enabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"LogUploadEvent"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"LogUploadParameters"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Handler that will be used when upload handler or handlers are not specified.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUploadHandler"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Gets or sets a value indicating whether the default upload metadata parameter should be used.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseDefaultUploadMetadataParameter"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Name of the default upload metadata parameter. This parameter is used to pass metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUploadMetadataParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_upload_metadata"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Gets or sets a value indicating whether the default upload metadata context key should be used.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseDefaultUploadMetadataContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Name of the default upload metadata context key. This key is used to pass the metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUploadMetadataContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"request.upload_metadata"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Upload handlers specific settings.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UploadHandlers"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// General settings for all upload handlers</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"StopAfterFirstSuccess"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"IncludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"BufferSize"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">8192</span><span style="color: #E6E6E6">, </span><span style="color: #6A9955">// Buffer size for the upload handlers file_system and large_object, in bytes. Default is 8192 bytes (8 KB).</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"TextTestBufferSize"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">4096</span><span style="color: #E6E6E6">, </span><span style="color: #6A9955">// Buffer sample size for testing textual content, in bytes. Default is 4096 bytes (4 KB).</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"TextNonPrintableThreshold"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #6A9955">// Threshold for non-printable characters in the text buffer. Default is 5 non-printable characters.</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"AllowedImageTypes"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"jpeg, png, gif, bmp, tiff, webp"</span><span style="color: #E6E6E6">, </span><span style="color: #6A9955">// Comma-separated list of allowed image types when checking images".</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uses PostgreSQL Large Objects API</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectCheckText"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectCheckImage"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uses file system</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"file_system"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemPath"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"/tmp/uploads"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemUseUniqueFileName"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemCreatePathIfNotExists"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemCheckText"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemCheckImage"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uploads CSV files to a row command</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadCheckFileStatus"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadDelimiterChars"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">","</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadHasFieldsEnclosedInQuotes"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadSetWhiteSpaceToNull"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// $1 - row index (1-based), $2 - parsed value text array, $3 - result of previous row command, $4 - json metadata for upload</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadRowCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"call process_csv_row($1,$2,$3,$4)"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uploads Excel files to a row command</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelUploadEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"excel"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelSheetName"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">, </span><span style="color: #6A9955">// null to use the first available</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelAllSheets"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelTimeFormat"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"HH:mm:ss"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelDateFormat"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"yyyy-MM-dd"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelDateTimeFormat"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"yyyy-MM-dd HH:mm:ss"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelRowDataAsJson"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// $1 - row index (1-based), $2 - parsed value text array, $3 - result of previous row command, $4 - json metadata for upload</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ExcelUploadRowCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"call process_excel_row($1,$2,$3,$4)"</span></span>
<span class="line"><span style="color: #E6E6E6">      }</span></span>
<span class="line"><span style="color: #E6E6E6">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// Data protection settings. Encryption keys for Auth Cookies and Antiforgery tokens.</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0451A5">"NpgsqlRest"</span><span style="color: #000000">: {</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"UploadOptions"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"Enabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"LogUploadEvent"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"LogUploadParameters"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Handler that will be used when upload handler or handlers are not specified.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUploadHandler"</span><span style="color: #000000">: </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Gets or sets a value indicating whether the default upload metadata parameter should be used.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseDefaultUploadMetadataParameter"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Name of the default upload metadata parameter. This parameter is used to pass metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUploadMetadataParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_upload_metadata"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Gets or sets a value indicating whether the default upload metadata context key should be used.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseDefaultUploadMetadataContextKey"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Name of the default upload metadata context key. This key is used to pass the metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUploadMetadataContextKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"request.upload_metadata"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Upload handlers specific settings.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UploadHandlers"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// General settings for all upload handlers</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"StopAfterFirstSuccess"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"IncludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"BufferSize"</span><span style="color: #000000">: </span><span style="color: #098658">8192</span><span style="color: #000000">, </span><span style="color: #008000">// Buffer size for the upload handlers file_system and large_object, in bytes. Default is 8192 bytes (8 KB).</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"TextTestBufferSize"</span><span style="color: #000000">: </span><span style="color: #098658">4096</span><span style="color: #000000">, </span><span style="color: #008000">// Buffer sample size for testing textual content, in bytes. Default is 4096 bytes (4 KB).</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"TextNonPrintableThreshold"</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #008000">// Threshold for non-printable characters in the text buffer. Default is 5 non-printable characters.</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"AllowedImageTypes"</span><span style="color: #000000">: </span><span style="color: #A31515">"jpeg, png, gif, bmp, tiff, webp"</span><span style="color: #000000">, </span><span style="color: #008000">// Comma-separated list of allowed image types when checking images".</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uses PostgreSQL Large Objects API</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectCheckText"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectCheckImage"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uses file system</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"file_system"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemPath"</span><span style="color: #000000">: </span><span style="color: #A31515">"/tmp/uploads"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemUseUniqueFileName"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemCreatePathIfNotExists"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemCheckText"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemCheckImage"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uploads CSV files to a row command</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadCheckFileStatus"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadDelimiterChars"</span><span style="color: #000000">: </span><span style="color: #A31515">","</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadHasFieldsEnclosedInQuotes"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadSetWhiteSpaceToNull"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// $1 - row index (1-based), $2 - parsed value text array, $3 - result of previous row command, $4 - json metadata for upload</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadRowCommand"</span><span style="color: #000000">: </span><span style="color: #A31515">"call process_csv_row($1,$2,$3,$4)"</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uploads Excel files to a row command</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelUploadEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"excel"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelSheetName"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #008000">// null to use the first available</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelAllSheets"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelTimeFormat"</span><span style="color: #000000">: </span><span style="color: #A31515">"HH:mm:ss"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelDateFormat"</span><span style="color: #000000">: </span><span style="color: #A31515">"yyyy-MM-dd"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelDateTimeFormat"</span><span style="color: #000000">: </span><span style="color: #A31515">"yyyy-MM-dd HH:mm:ss"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelRowDataAsJson"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// $1 - row index (1-based), $2 - parsed value text array, $3 - result of previous row command, $4 - json metadata for upload</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ExcelUploadRowCommand"</span><span style="color: #000000">: </span><span style="color: #A31515">"call process_excel_row($1,$2,$3,$4)"</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">  },</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h2 id="version-2270-2025-05-19">Version <a href="https://github.com/vb-consulting/NpgsqlRest/tree/2.27.0">2.27.0</a> (2025-05-19)<a class="anchor bookmark-target" href="#version-2270-2025-05-19"><i class="bi bi-link-45deg"></i></a></h2><p><a href="https://github.com/vb-consulting/NpgsqlRest/compare/2.26.0...2.27.0">Full Changelog</a></p><p>This is a big release that features several important changes.</p><h3 id="authenticationoptions-changes">AuthenticationOptions Changes<a class="anchor bookmark-target" href="#authenticationoptions-changes"><i class="bi bi-link-45deg"></i></a></h3><p>Authentication options have been expanded to include new parameters. Specifically, to be able to bind user claims to parameters (user id, user name, user roles or custom) or to send them as PostgreSQL context.</p><p>Another important change is that beside <code>PasswordVerificationFailedCommand</code> option, there is also <code>PasswordVerificationSucceededCommand</code>. And both of these options contain a command expression that receives three optional text parameters:</p><ul><li>Authentication scheme used for the login</li><li>User id used for the login.</li><li>User name used for the login.</li></ul><p>Parameters are positional: first is scheme, second is user id, and third is user name. User id and user name have switched places from the last version, since user id is usually more important.</p><p>Class <code>NpgsqlRestAuthenticationOptions</code> now looks like this:</p><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Authentication options for the NpgsqlRest middleware.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRestAuthenticationOptions</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Authentication type used with the Login endpoints to set the authentication type for the new `ClaimsIdentity` created by the login.</span></span>
<span class="line"><span style="color: #6A9955">    ///</span></span>
<span class="line"><span style="color: #6A9955">    /// This value must be set to non-null when using login endpoints, otherwise, the following error will raise: `SignInAsync when principal.Identity.IsAuthenticated is false is not allowed when AuthenticationOptions.RequireAuthenticatedSignIn is true.`</span></span>
<span class="line"><span style="color: #6A9955">    /// </span></span>
<span class="line"><span style="color: #6A9955">    /// If the value is not set and the login endpoint is present, it will automatically get the database name from the connection string.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">DefaultAuthenticationType</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// The default column name in the data reader which will be used to read the value to determine the success or failure of the login operation.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span></span>
<span class="line"><span style="color: #6A9955">    /// - If this column is not present, the success is when the endpoint returns any records.</span></span>
<span class="line"><span style="color: #6A9955">    /// - If this column is present, it must be either a boolean to indicate success or a numeric value to indicate the HTTP Status Code to return.</span></span>
<span class="line"><span style="color: #6A9955">    /// - If this column is present and retrieves a numeric value, that value is assigned to the HTTP Status Code and the login will authenticate only when this value is 200.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">StatusColumnName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"status"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// The default column name in the data reader which will be used to read the value of the authentication scheme of the login process.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span></span>
<span class="line"><span style="color: #6A9955">    /// If this column is not present in the login response the default authentication scheme is used. Return new value to use a different authentication scheme with the login endpoint.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">SchemeColumnName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"scheme"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// The default column name in the data reader which will return a text message with the login status.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">MessageColumnName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"message"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Any columns retrieved from the reader during login, which don't have a name in `StatusColumnName` or `SchemeColumnName` will be used to create a new identity  `Claim`:</span></span>
<span class="line"><span style="color: #6A9955">    /// </span></span>
<span class="line"><span style="color: #6A9955">    /// Column name will be interpreted as the claim type and the associated reader value for that column will be the claim value.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span></span>
<span class="line"><span style="color: #6A9955">    /// When this value is set to true (default) column name will try to match the constant name in the [ClaimTypes class](https://learn.microsoft.com/en-us/dotnet/api/system.security.claims.claimtypes?view=net-8.0) to retrieve the value.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span></span>
<span class="line"><span style="color: #6A9955">    /// For example, column name `NameIdentifier` or `name_identifier` (when transformed by the default name transformer) will match the key `NameIdentifier` which translates to this: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UseActiveDirectoryFederationServicesClaimTypes</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Default claim type for user id.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUserIdClaimType</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ClaimTypes</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">NameIdentifier</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">private</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">_defaultNameClaimType</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ClaimTypes</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">internal</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UsingDefaultNameClaimType</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Default claim type for user name.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultNameClaimType</span></span>
<span class="line"><span style="color: #E6E6E6">    {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">_defaultNameClaimType</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #569CD6">set</span></span>
<span class="line"><span style="color: #E6E6E6">        {</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">_defaultNameClaimType</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">value</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">UsingDefaultNameClaimType</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equals</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">value</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">ClaimTypes</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">StringComparison</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Default claim type for user roles.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultRoleClaimType</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ClaimTypes</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Role</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// If true, return any response from auth endpoints (login and logout) if response hasn't been written by auth handler.</span></span>
<span class="line"><span style="color: #6A9955">    /// For cookie auth, this will return full record to response as returned by the routine.</span></span>
<span class="line"><span style="color: #6A9955">    /// For bearer token auth, this will be ignored because bearer token auth writes it's own response (with tokens).</span></span>
<span class="line"><span style="color: #6A9955">    /// This option will also be ignored if message column is present (see MessageColumnName option).</span></span>
<span class="line"><span style="color: #6A9955">    /// Default is false.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">SerializeAuthEndpointsResponse</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Don't write real parameter values when logging parameters from auth endpoints and obfuscate instead.</span></span>
<span class="line"><span style="color: #6A9955">    /// This prevents user credentials including password to end up in application logs.</span></span>
<span class="line"><span style="color: #6A9955">    /// Default is true.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ObfuscateAuthParameterLogValues</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// The default column name in the data reader which will be used to read the value of the hash of the password.</span></span>
<span class="line"><span style="color: #6A9955">    /// If this column is present, the value will be used to verify the password from the password parameter.</span></span>
<span class="line"><span style="color: #6A9955">    /// Password parameter is the first parameter which name contains the value of PasswordParameterNameContains.</span></span>
<span class="line"><span style="color: #6A9955">    /// If verification fails, the login will fail and the HTTP Status Code will be set to 404 Not Found.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">HashColumnName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"hash"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// The default name of the password parameter. The first parameter which name contains this value will be used as the password parameter.</span></span>
<span class="line"><span style="color: #6A9955">    /// This is used to verify the password from the password parameter when login endpoint returns a hash of the password (see HashColumnName).</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">PasswordParameterNameContains</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"pass"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Default password hasher object. Inject custom password hasher object to add default password hasher.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">IPasswordHasher</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">PasswordHasher</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">PasswordHasher</span><span style="color: #E6E6E6">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Command that is executed when the password verification fails. There are three text parameters:</span></span>
<span class="line"><span style="color: #6A9955">    ///     - authentication scheme used for the login (if exists)</span></span>
<span class="line"><span style="color: #6A9955">    ///     - user id used for the login (if exists)</span></span>
<span class="line"><span style="color: #6A9955">    ///     - user name used for the login (if exists)</span></span>
<span class="line"><span style="color: #6A9955">    /// Please use PostgreSQL parameter placeholders for the parameters ($1, $2, $3).</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">PasswordVerificationFailedCommand</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Command that is executed when the password verification succeeds. There are three text parameters:</span></span>
<span class="line"><span style="color: #6A9955">    ///     - authentication scheme used for the login (if exists)</span></span>
<span class="line"><span style="color: #6A9955">    ///     - user id used for the login (if exists)</span></span>
<span class="line"><span style="color: #6A9955">    ///     - user name used for the login (if exists)</span></span>
<span class="line"><span style="color: #6A9955">    /// Please use PostgreSQL parameter placeholders for the parameters ($1, $2, $3).</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">PasswordVerificationSucceededCommand</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Set user context to true for all requests. </span></span>
<span class="line"><span style="color: #6A9955">    /// When this is set to true, user information (user id, user name and user roles) will be set to the context variables.</span></span>
<span class="line"><span style="color: #6A9955">    /// You can set this individually for each request.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UseUserContext</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// User id context key that is used to set context variable for the user id.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserIdContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"request.user_id"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// User name context key that is used to set context variable for the user name.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserNameContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"request.user_name"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// User roles context key that is used to set context variable for the user roles.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserRolesContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"request.user_roles"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// IP address context key that is used to set context variable for the IP address.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">IpAddressContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"request.ip_address"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// When this value is set and user context is used, all user claims will be serialized to JSON value and set to the context variable with this name.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserClaimsContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Set user parameters to true for all requests. </span></span>
<span class="line"><span style="color: #6A9955">    /// When this is set to true, user information (user id, user name and user roles) will be set to the matching parameter names if available.</span></span>
<span class="line"><span style="color: #6A9955">    /// You can set this individually for each request.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UseUserParameters</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// User id parameter name that is used to set parameter value for the user id.</span></span>
<span class="line"><span style="color: #6A9955">    /// Parameter name can be original or converted and it has to be the text type.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserIdParameterName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_user_id"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// User name parameter name that is used to set parameter value for the user name.</span></span>
<span class="line"><span style="color: #6A9955">    /// Parameter name can be original or converted and it has to be the text type.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserNameParameterName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_user_name"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// User roles parameter name that is used to set parameter value for the user roles.</span></span>
<span class="line"><span style="color: #6A9955">    /// Parameter name can be original or converted and it has to be the text array type.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserRolesParameterName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_user_roles"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// IP address parameter name that is used to set parameter value for the IP address.</span></span>
<span class="line"><span style="color: #6A9955">    /// Parameter name can be original or converted and it has to be the text type.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">IpAddressParameterName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_ip_address"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// All user claims will be serialized to JSON value and set to the parameter with this name.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">UserClaimsParameterName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_user_claims"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Authentication options for the NpgsqlRest middleware.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRestAuthenticationOptions</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Authentication type used with the Login endpoints to set the authentication type for the new `ClaimsIdentity` created by the login.</span></span>
<span class="line"><span style="color: #008000">    ///</span></span>
<span class="line"><span style="color: #008000">    /// This value must be set to non-null when using login endpoints, otherwise, the following error will raise: `SignInAsync when principal.Identity.IsAuthenticated is false is not allowed when AuthenticationOptions.RequireAuthenticatedSignIn is true.`</span></span>
<span class="line"><span style="color: #008000">    /// </span></span>
<span class="line"><span style="color: #008000">    /// If the value is not set and the login endpoint is present, it will automatically get the database name from the connection string.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">DefaultAuthenticationType</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// The default column name in the data reader which will be used to read the value to determine the success or failure of the login operation.</span></span>
<span class="line"><span style="color: #008000">    /// </span></span>
<span class="line"><span style="color: #008000">    /// - If this column is not present, the success is when the endpoint returns any records.</span></span>
<span class="line"><span style="color: #008000">    /// - If this column is present, it must be either a boolean to indicate success or a numeric value to indicate the HTTP Status Code to return.</span></span>
<span class="line"><span style="color: #008000">    /// - If this column is present and retrieves a numeric value, that value is assigned to the HTTP Status Code and the login will authenticate only when this value is 200.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">StatusColumnName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"status"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// The default column name in the data reader which will be used to read the value of the authentication scheme of the login process.</span></span>
<span class="line"><span style="color: #008000">    /// </span></span>
<span class="line"><span style="color: #008000">    /// If this column is not present in the login response the default authentication scheme is used. Return new value to use a different authentication scheme with the login endpoint.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">SchemeColumnName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"scheme"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// The default column name in the data reader which will return a text message with the login status.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">MessageColumnName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"message"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Any columns retrieved from the reader during login, which don't have a name in `StatusColumnName` or `SchemeColumnName` will be used to create a new identity  `Claim`:</span></span>
<span class="line"><span style="color: #008000">    /// </span></span>
<span class="line"><span style="color: #008000">    /// Column name will be interpreted as the claim type and the associated reader value for that column will be the claim value.</span></span>
<span class="line"><span style="color: #008000">    /// </span></span>
<span class="line"><span style="color: #008000">    /// When this value is set to true (default) column name will try to match the constant name in the [ClaimTypes class](https://learn.microsoft.com/en-us/dotnet/api/system.security.claims.claimtypes?view=net-8.0) to retrieve the value.</span></span>
<span class="line"><span style="color: #008000">    /// </span></span>
<span class="line"><span style="color: #008000">    /// For example, column name `NameIdentifier` or `name_identifier` (when transformed by the default name transformer) will match the key `NameIdentifier` which translates to this: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UseActiveDirectoryFederationServicesClaimTypes</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Default claim type for user id.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUserIdClaimType</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #001080">ClaimTypes</span><span style="color: #000000">.</span><span style="color: #001080">NameIdentifier</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">_defaultNameClaimType</span><span style="color: #000000"> = </span><span style="color: #001080">ClaimTypes</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">internal</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UsingDefaultNameClaimType</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Default claim type for user name.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultNameClaimType</span></span>
<span class="line"><span style="color: #000000">    {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0000FF">get</span><span style="color: #000000"> => </span><span style="color: #001080">_defaultNameClaimType</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0000FF">set</span></span>
<span class="line"><span style="color: #000000">        {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">_defaultNameClaimType</span><span style="color: #000000"> = </span><span style="color: #001080">value</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">UsingDefaultNameClaimType</span><span style="color: #000000"> = </span><span style="color: #0000FF">string</span><span style="color: #000000">.</span><span style="color: #795E26">Equals</span><span style="color: #000000">(</span><span style="color: #001080">value</span><span style="color: #000000">, </span><span style="color: #001080">ClaimTypes</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">, </span><span style="color: #001080">StringComparison</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Default claim type for user roles.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultRoleClaimType</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #001080">ClaimTypes</span><span style="color: #000000">.</span><span style="color: #001080">Role</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// If true, return any response from auth endpoints (login and logout) if response hasn't been written by auth handler.</span></span>
<span class="line"><span style="color: #008000">    /// For cookie auth, this will return full record to response as returned by the routine.</span></span>
<span class="line"><span style="color: #008000">    /// For bearer token auth, this will be ignored because bearer token auth writes it's own response (with tokens).</span></span>
<span class="line"><span style="color: #008000">    /// This option will also be ignored if message column is present (see MessageColumnName option).</span></span>
<span class="line"><span style="color: #008000">    /// Default is false.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">SerializeAuthEndpointsResponse</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">false</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Don't write real parameter values when logging parameters from auth endpoints and obfuscate instead.</span></span>
<span class="line"><span style="color: #008000">    /// This prevents user credentials including password to end up in application logs.</span></span>
<span class="line"><span style="color: #008000">    /// Default is true.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">ObfuscateAuthParameterLogValues</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// The default column name in the data reader which will be used to read the value of the hash of the password.</span></span>
<span class="line"><span style="color: #008000">    /// If this column is present, the value will be used to verify the password from the password parameter.</span></span>
<span class="line"><span style="color: #008000">    /// Password parameter is the first parameter which name contains the value of PasswordParameterNameContains.</span></span>
<span class="line"><span style="color: #008000">    /// If verification fails, the login will fail and the HTTP Status Code will be set to 404 Not Found.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">HashColumnName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"hash"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// The default name of the password parameter. The first parameter which name contains this value will be used as the password parameter.</span></span>
<span class="line"><span style="color: #008000">    /// This is used to verify the password from the password parameter when login endpoint returns a hash of the password (see HashColumnName).</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">PasswordParameterNameContains</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"pass"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Default password hasher object. Inject custom password hasher object to add default password hasher.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">IPasswordHasher</span><span style="color: #000000">? </span><span style="color: #001080">PasswordHasher</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">PasswordHasher</span><span style="color: #000000">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Command that is executed when the password verification fails. There are three text parameters:</span></span>
<span class="line"><span style="color: #008000">    ///     - authentication scheme used for the login (if exists)</span></span>
<span class="line"><span style="color: #008000">    ///     - user id used for the login (if exists)</span></span>
<span class="line"><span style="color: #008000">    ///     - user name used for the login (if exists)</span></span>
<span class="line"><span style="color: #008000">    /// Please use PostgreSQL parameter placeholders for the parameters ($1, $2, $3).</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">PasswordVerificationFailedCommand</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Command that is executed when the password verification succeeds. There are three text parameters:</span></span>
<span class="line"><span style="color: #008000">    ///     - authentication scheme used for the login (if exists)</span></span>
<span class="line"><span style="color: #008000">    ///     - user id used for the login (if exists)</span></span>
<span class="line"><span style="color: #008000">    ///     - user name used for the login (if exists)</span></span>
<span class="line"><span style="color: #008000">    /// Please use PostgreSQL parameter placeholders for the parameters ($1, $2, $3).</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">PasswordVerificationSucceededCommand</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Set user context to true for all requests. </span></span>
<span class="line"><span style="color: #008000">    /// When this is set to true, user information (user id, user name and user roles) will be set to the context variables.</span></span>
<span class="line"><span style="color: #008000">    /// You can set this individually for each request.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UseUserContext</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">false</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// User id context key that is used to set context variable for the user id.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserIdContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"request.user_id"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// User name context key that is used to set context variable for the user name.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserNameContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"request.user_name"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// User roles context key that is used to set context variable for the user roles.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserRolesContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"request.user_roles"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// IP address context key that is used to set context variable for the IP address.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">IpAddressContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"request.ip_address"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// When this value is set and user context is used, all user claims will be serialized to JSON value and set to the context variable with this name.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserClaimsContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Set user parameters to true for all requests. </span></span>
<span class="line"><span style="color: #008000">    /// When this is set to true, user information (user id, user name and user roles) will be set to the matching parameter names if available.</span></span>
<span class="line"><span style="color: #008000">    /// You can set this individually for each request.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UseUserParameters</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">false</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// User id parameter name that is used to set parameter value for the user id.</span></span>
<span class="line"><span style="color: #008000">    /// Parameter name can be original or converted and it has to be the text type.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserIdParameterName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"_user_id"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// User name parameter name that is used to set parameter value for the user name.</span></span>
<span class="line"><span style="color: #008000">    /// Parameter name can be original or converted and it has to be the text type.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserNameParameterName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"_user_name"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// User roles parameter name that is used to set parameter value for the user roles.</span></span>
<span class="line"><span style="color: #008000">    /// Parameter name can be original or converted and it has to be the text array type.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserRolesParameterName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"_user_roles"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// IP address parameter name that is used to set parameter value for the IP address.</span></span>
<span class="line"><span style="color: #008000">    /// Parameter name can be original or converted and it has to be the text type.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">IpAddressParameterName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"_ip_address"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// All user claims will be serialized to JSON value and set to the parameter with this name.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">UserClaimsParameterName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"_user_claims"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>Previously, this logic was handled only in client application and inefficiently so. That means that there is a new configuration section in the client application for handling authentication:</p><div class="code jsonc"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">"NpgsqlRest"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Authentication options for NpgsqlRest endpoints</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"AuthenticationOptions"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultauthenticationtype</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultAuthenticationType"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsstatuscolumnname</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"StatusColumnName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"status"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsschemecolumnname</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"SchemeColumnName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"scheme"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsmessagecolumnname</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"MessageColumnName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"message"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseactivedirectoryfederationservicesclaimtypes</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseActiveDirectoryFederationServicesClaimTypes"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultuseridclaimtype</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUserIdClaimType"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultnameclaimtype</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultNameClaimType"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultroleclaimtype</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultRoleClaimType"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/role"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsserializeauthendpointsresponse</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"SerializeAuthEndpointsResponse"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsobfuscateauthparameterlogvalues</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"ObfuscateAuthParameterLogValues"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionshashcolumnname</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"HashColumnName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"hash"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionspasswordparameternamecontains</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"PasswordParameterNameContains"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"pass"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionspasswordverificationfailedcommand</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"PasswordVerificationFailedCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionspasswordverificationsucceededcommand</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"PasswordVerificationSucceededCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseusercontext</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseUserContext"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseridcontextkey</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserIdContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"request.user_id"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsusernamecontextkey</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserNameContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"request.user_name"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserrolescontextkey</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserRolesContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"request.user_roles"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsipaddresscontextkey</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"IpAddressContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"request.ip_address"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserclaimscontextkey</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserClaimsContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseruserparameters</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseUserParameters"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseridparametername</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserIdParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_user_id"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsusernameparametername</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserNameParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_user_name"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserrolesparametername</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserRolesParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_user_roles"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsipaddressparametername</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"IpAddressParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_ip_address"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserclaimsparametername</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UserClaimsParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_user_claims"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Url path that will be used for the login endpoint. If NULL, the login endpoint will not be created.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See more on login endpoints at https://vb-consulting.github.io/npgsqlrest/login-endpoints</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"LoginPath"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Url path that will be used for the logout endpoint. If NULL, the logout endpoint will not be created.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// See more on logout endpoints at https://vb-consulting.github.io/npgsqlrest/annotations/#logout</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"LogoutPath"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Routines that have this values set to true, will parse the response before it is returned to the client by using name placeholders from this section.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Use curly braces to define the name placeholders in the response. For example, {user_id} will be replaced. </span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// The replacement value in this example is the value that would be assigned to he UserIdParameterName parameter if UseUserParameters was used. That means user id.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"ParseResponseUsingUserParameters"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0451A5">"NpgsqlRest"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Authentication options for NpgsqlRest endpoints</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"AuthenticationOptions"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultauthenticationtype</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultAuthenticationType"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsstatuscolumnname</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"StatusColumnName"</span><span style="color: #000000">: </span><span style="color: #A31515">"status"</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsschemecolumnname</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"SchemeColumnName"</span><span style="color: #000000">: </span><span style="color: #A31515">"scheme"</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsmessagecolumnname</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"MessageColumnName"</span><span style="color: #000000">: </span><span style="color: #A31515">"message"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseactivedirectoryfederationservicesclaimtypes</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseActiveDirectoryFederationServicesClaimTypes"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultuseridclaimtype</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUserIdClaimType"</span><span style="color: #000000">: </span><span style="color: #A31515">"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultnameclaimtype</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultNameClaimType"</span><span style="color: #000000">: </span><span style="color: #A31515">"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsdefaultroleclaimtype</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultRoleClaimType"</span><span style="color: #000000">: </span><span style="color: #A31515">"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/role"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsserializeauthendpointsresponse</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"SerializeAuthEndpointsResponse"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsobfuscateauthparameterlogvalues</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"ObfuscateAuthParameterLogValues"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionshashcolumnname</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"HashColumnName"</span><span style="color: #000000">: </span><span style="color: #A31515">"hash"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionspasswordparameternamecontains</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"PasswordParameterNameContains"</span><span style="color: #000000">: </span><span style="color: #A31515">"pass"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionspasswordverificationfailedcommand</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"PasswordVerificationFailedCommand"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionspasswordverificationsucceededcommand</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"PasswordVerificationSucceededCommand"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseusercontext</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseUserContext"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseridcontextkey</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserIdContextKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"request.user_id"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsusernamecontextkey</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserNameContextKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"request.user_name"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserrolescontextkey</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserRolesContextKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"request.user_roles"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsipaddresscontextkey</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"IpAddressContextKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"request.ip_address"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserclaimscontextkey</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserClaimsContextKey"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseruserparameters</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseUserParameters"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuseridparametername</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserIdParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_user_id"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsusernameparametername</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserNameParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_user_name"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserrolesparametername</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserRolesParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_user_roles"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsipaddressparametername</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"IpAddressParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_ip_address"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See https://vb-consulting.github.io/npgsqlrest/options/#authenticationoptionsuserclaimsparametername</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UserClaimsParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_user_claims"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Url path that will be used for the login endpoint. If NULL, the login endpoint will not be created.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See more on login endpoints at https://vb-consulting.github.io/npgsqlrest/login-endpoints</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"LoginPath"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Url path that will be used for the logout endpoint. If NULL, the logout endpoint will not be created.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// See more on logout endpoints at https://vb-consulting.github.io/npgsqlrest/annotations/#logout</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"LogoutPath"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Routines that have this values set to true, will parse the response before it is returned to the client by using name placeholders from this section.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Use curly braces to define the name placeholders in the response. For example, {user_id} will be replaced. </span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// The replacement value in this example is the value that would be assigned to he UserIdParameterName parameter if UseUserParameters was used. That means user id.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"ParseResponseUsingUserParameters"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h3 id="uploadoptions-changes">UploadOptions Changes<a class="anchor bookmark-target" href="#uploadoptions-changes"><i class="bi bi-link-45deg"></i></a></h3><p>Upload options in core library have also been improved. New options include:</p><ul><li><code>LogUploadEvent</code> - should we log upload events.</li><li><code>DefaultUploadMetadataParameterName</code> and <code>UseDefaultUploadMetadataParameter</code> - set the default upload metadata parameter once for all.</li><li><code>DefaultUploadMetadataContextKey</code> and <code>UseDefaultUploadMetadataContextKey</code> - set metadata with PostgreSQL context first instead of parameter.</li></ul><p>Here is the new <code>NpgsqlRestUploadOptions</code> class:</p><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Upload options for the NpgsqlRest middleware.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRestUploadOptions</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Enabled</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">LogUploadEvent</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Default upload handler name. This value is used when the upload handlers are not specified.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUploadHandler</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Default upload handler options. </span></span>
<span class="line"><span style="color: #6A9955">    /// Set this option to null to disable upload handlers or use this to modify upload handler options.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">UploadHandlerOptions</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUploadHandlerOptions</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">UploadHandlerOptions</span><span style="color: #E6E6E6">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Upload handlers dictionary map. </span></span>
<span class="line"><span style="color: #6A9955">    /// When the endpoint has set Upload to true, this dictionary will be used to find the upload handlers for the current request. </span></span>
<span class="line"><span style="color: #6A9955">    /// Handler will be located by the key values from the endpoint UploadHandlers string array property if set or by the default upload handler (DefaultUploadHandler option).</span></span>
<span class="line"><span style="color: #6A9955">    /// Set this option to null to use default upload handler from the UploadHandlerOptions property.</span></span>
<span class="line"><span style="color: #6A9955">    /// Set this option to empty dictionary to disable upload handlers.</span></span>
<span class="line"><span style="color: #6A9955">    /// Set this option to a dictionary with one or more upload handlers to enable your own custom upload handlers.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Dictionary</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">Func</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">ILogger</span><span style="color: #E6E6E6">?, </span><span style="color: #4EC9B0">IUploadHandler</span><span style="color: #E6E6E6">>>? </span><span style="color: #9CDCFE">UploadHandlers</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Gets or sets a value indicating whether the default upload metadata parameter should be used.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UseDefaultUploadMetadataParameter</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Name of the default upload metadata parameter. </span></span>
<span class="line"><span style="color: #6A9955">    /// This parameter will be automatically assigned with the upload metadata JSON string when the upload is completed if UseDefaultUploadMetadataParameter is set to true.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUploadMetadataParameterName</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_upload_metadata"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Gets or sets a value indicating whether the default upload metadata context key should be used.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UseDefaultUploadMetadataContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">    /// Name of the default upload metadata context key.</span></span>
<span class="line"><span style="color: #6A9955">    /// This context key will be automatically assigned to context with the upload metadata JSON string when the upload is completed if UseDefaultUploadMetadataContextKey is set to true.</span></span>
<span class="line"><span style="color: #6A9955">    /// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUploadMetadataContextKey</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"request.upload_metadata"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Upload options for the NpgsqlRest middleware.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRestUploadOptions</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">Enabled</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">LogUploadEvent</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Default upload handler name. This value is used when the upload handlers are not specified.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUploadHandler</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Default upload handler options. </span></span>
<span class="line"><span style="color: #008000">    /// Set this option to null to disable upload handlers or use this to modify upload handler options.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">UploadHandlerOptions</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUploadHandlerOptions</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">UploadHandlerOptions</span><span style="color: #000000">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Upload handlers dictionary map. </span></span>
<span class="line"><span style="color: #008000">    /// When the endpoint has set Upload to true, this dictionary will be used to find the upload handlers for the current request. </span></span>
<span class="line"><span style="color: #008000">    /// Handler will be located by the key values from the endpoint UploadHandlers string array property if set or by the default upload handler (DefaultUploadHandler option).</span></span>
<span class="line"><span style="color: #008000">    /// Set this option to null to use default upload handler from the UploadHandlerOptions property.</span></span>
<span class="line"><span style="color: #008000">    /// Set this option to empty dictionary to disable upload handlers.</span></span>
<span class="line"><span style="color: #008000">    /// Set this option to a dictionary with one or more upload handlers to enable your own custom upload handlers.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">Dictionary</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #267F99">Func</span><span style="color: #000000">&lt;</span><span style="color: #267F99">ILogger</span><span style="color: #000000">?, </span><span style="color: #267F99">IUploadHandler</span><span style="color: #000000">>>? </span><span style="color: #001080">UploadHandlers</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Gets or sets a value indicating whether the default upload metadata parameter should be used.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UseDefaultUploadMetadataParameter</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">false</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Name of the default upload metadata parameter. </span></span>
<span class="line"><span style="color: #008000">    /// This parameter will be automatically assigned with the upload metadata JSON string when the upload is completed if UseDefaultUploadMetadataParameter is set to true.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUploadMetadataParameterName</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"_upload_metadata"</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Gets or sets a value indicating whether the default upload metadata context key should be used.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UseDefaultUploadMetadataContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">false</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">    /// Name of the default upload metadata context key.</span></span>
<span class="line"><span style="color: #008000">    /// This context key will be automatically assigned to context with the upload metadata JSON string when the upload is completed if UseDefaultUploadMetadataContextKey is set to true.</span></span>
<span class="line"><span style="color: #008000">    /// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUploadMetadataContextKey</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"request.upload_metadata"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>This also required change in client application configuration:</p><div class="code jsonc"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">"NpgsqlRest"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"UploadOptions"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"Enabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"LogUploadEvent"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Handler that will be used when upload handler or handlers are not specified.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUploadHandler"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Gets or sets a value indicating whether the default upload metadata parameter should be used.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseDefaultUploadMetadataParameter"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Name of the default upload metadata parameter. This parameter is used to pass metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUploadMetadataParameterName"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"_upload_metadata"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Gets or sets a value indicating whether the default upload metadata context key should be used.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UseDefaultUploadMetadataContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Name of the default upload metadata context key. This key is used to pass the metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"DefaultUploadMetadataContextKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"request.upload_metadata"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">// Upload handlers specific settings.</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">      </span><span style="color: #9CDCFE">"UploadHandlers"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uses PostgreSQL Large Objects API</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectIncludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectExcludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"LargeObjectHandlerBufferSize"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">8192</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uses file system</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemIncludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemExcludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemKey"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"file_system"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemHandlerPath"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"/tmp/uploads"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemHandlerUseUniqueFileName"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemHandlerCreatePathIfNotExists"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"FileSystemHandlerBufferSize"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">8192</span><span style="color: #E6E6E6">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Enables upload handlers for the NpgsqlRest endpoints that uploads CSV files to a row command</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadEnabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadIncludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadExcludedMimeTypePatterns"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadCheckFileStatus"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadTestBufferSize"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">4096</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadNonPrintableThreshold"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadDelimiterChars"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">","</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadHasFieldsEnclosedInQuotes"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadSetWhiteSpaceToNull"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// $1 - row index (1-based), $2 - parsed value text array, $3 - result of previous row command, $4 - json metadata for upload</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"CsvUploadRowCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"call process_csv_row($1,$2,$3,$4)"</span></span>
<span class="line"><span style="color: #E6E6E6">      }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0451A5">"NpgsqlRest"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"UploadOptions"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"Enabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"LogUploadEvent"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Handler that will be used when upload handler or handlers are not specified.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUploadHandler"</span><span style="color: #000000">: </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Gets or sets a value indicating whether the default upload metadata parameter should be used.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseDefaultUploadMetadataParameter"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Name of the default upload metadata parameter. This parameter is used to pass metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUploadMetadataParameterName"</span><span style="color: #000000">: </span><span style="color: #A31515">"_upload_metadata"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Gets or sets a value indicating whether the default upload metadata context key should be used.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UseDefaultUploadMetadataContextKey"</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Name of the default upload metadata context key. This key is used to pass the metadata to the upload handler. The metadata is passed as a JSON object.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"DefaultUploadMetadataContextKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"request.upload_metadata"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">// Upload handlers specific settings.</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">      </span><span style="color: #0451A5">"UploadHandlers"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uses PostgreSQL Large Objects API</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectIncludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectExcludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"LargeObjectHandlerBufferSize"</span><span style="color: #000000">: </span><span style="color: #098658">8192</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uses file system</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemIncludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemExcludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemKey"</span><span style="color: #000000">: </span><span style="color: #A31515">"file_system"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemHandlerPath"</span><span style="color: #000000">: </span><span style="color: #A31515">"/tmp/uploads"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemHandlerUseUniqueFileName"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemHandlerCreatePathIfNotExists"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"FileSystemHandlerBufferSize"</span><span style="color: #000000">: </span><span style="color: #098658">8192</span><span style="color: #000000">,</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// Enables upload handlers for the NpgsqlRest endpoints that uploads CSV files to a row command</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadEnabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadIncludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// csv string containing mime type patters, set to null to ignore</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadExcludedMimeTypePatterns"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadCheckFileStatus"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadTestBufferSize"</span><span style="color: #000000">: </span><span style="color: #098658">4096</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadNonPrintableThreshold"</span><span style="color: #000000">: </span><span style="color: #098658">5</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadDelimiterChars"</span><span style="color: #000000">: </span><span style="color: #A31515">","</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadHasFieldsEnclosedInQuotes"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadSetWhiteSpaceToNull"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">// $1 - row index (1-based), $2 - parsed value text array, $3 - result of previous row command, $4 - json metadata for upload</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"CsvUploadRowCommand"</span><span style="color: #000000">: </span><span style="color: #A31515">"call process_csv_row($1,$2,$3,$4)"</span></span>
<span class="line"><span style="color: #000000">      }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h3 id="npgsqlrest-client-app-static-file-parser">NpgsqlRest Client App Static File Parser<a class="anchor bookmark-target" href="#npgsqlrest-client-app-static-file-parser"><i class="bi bi-link-45deg"></i></a></h3><p>This is basically conceptual fix to the Client application static file parser. Files being parsed that are cached are defining the purpose so cache needs to be disabled. This is done with new static file configuration setting in the Client application:</p><div class="code jsonc"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//...</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"StaticFiles"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//...</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">"ParseContentOptions"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #6A9955">//...</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">"Headers"</span><span style="color: #E6E6E6">: [ </span><span style="color: #CE9178">"Cache-Control: no-store, no-cache, must-revalidate"</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"Pragma: no-cache"</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"Expires: 0"</span><span style="color: #E6E6E6"> ],</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//...</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//...</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"StaticFiles"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #008000">//...</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0451A5">"ParseContentOptions"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #008000">//...</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #0451A5">"Headers"</span><span style="color: #000000">: [ </span><span style="color: #A31515">"Cache-Control: no-store, no-cache, must-revalidate"</span><span style="color: #000000">, </span><span style="color: #A31515">"Pragma: no-cache"</span><span style="color: #000000">, </span><span style="color: #A31515">"Expires: 0"</span><span style="color: #000000"> ],</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//...</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h3 id="comment-annotation-system-changes">Comment Annotation System Changes<a class="anchor bookmark-target" href="#comment-annotation-system-changes"><i class="bi bi-link-45deg"></i></a></h3><p>Comment annotation has seen some big changes. Added new parameters and annotations to reflect changes in Authentication and Upload options.</p><p>Breaking change: Comment annotations now support only snake_case naming. This is consistent with PostgreSQL naming convention and it reduces the number of annotations needed to support.</p><h3 id="fixes-and-other-improvements">Fixes and Other Improvements<a class="anchor bookmark-target" href="#fixes-and-other-improvements"><i class="bi bi-link-45deg"></i></a></h3><ul><li>Fixed a bug when endpoint was returning empty JSON array. Adequate parser wasn't invoked in case of JSON empty array and it returned <code>{}</code>. This is fixed to return <code>[]</code>.</li><li>All commands and parameters are now using <code>MemberwiseClone</code> performance trick to reduce unnecessary allocations.</li></ul><h2 id="version-2260-2025-05-11">Version <a href="https://github.com/vb-consulting/NpgsqlRest/tree/2.26.0">2.26.0</a> (2025-05-11)<a class="anchor bookmark-target" href="#version-2260-2025-05-11"><i class="bi bi-link-45deg"></i></a></h2><p><a href="https://github.com/vb-consulting/NpgsqlRest/compare/2.25.0...2.26.0">Full Changelog</a></p><h3 id="core-npgsqlrest-library">Core NpgsqlRest Library<a class="anchor bookmark-target" href="#core-npgsqlrest-library"><i class="bi bi-link-45deg"></i></a></h3><h4 id="upload-handlers-improvements">Upload Handlers Improvements<a class="anchor bookmark-target" href="#upload-handlers-improvements"><i class="bi bi-link-45deg"></i></a></h4><h5 id="csv-upload-handler">CSV Upload Handler<a class="anchor bookmark-target" href="#csv-upload-handler"><i class="bi bi-link-45deg"></i></a></h5><p>New CSV Upload Handler with key <code>csv</code> is implemented and added to available handlers (Large Object and File System). It has following parameters:</p><ul><li><code>included_mime_types</code>: List of allowed MIME type patterns. Pattern may include <code>*</code> or <code>?</code>. If empty or null, all MIME types are allowed. Default is null, this parameter is not used.</li><li><code>excluded_mime_types</code>: List of disallowed MIME type patterns. Pattern may include <code>*</code> or <code>?</code>. Default is null, this parameter is not used.</li><li><code>check_file</code>: Boolean flag indicating whether to perform content verification. Content verification looks for binary file markers in test buffer and does it contain new line delimiters. Default is true.</li><li><code>test_buffer_size</code>: Size of the buffer to read for content verification. Default is 8192 bytes.</li><li><code>non_printable_threshold</code>: Maximum number of non-printable characters allowed in the test buffer. Everything above is considered likely binary content. Default is 5.</li><li><code>delimiters</code>: Text where each character is considered as valid value delimiter. Default is comma character (<code>,</code>). Note: use standard escape sequence special characters like <code>\t</code> for tab character.</li><li><code>has_fields_enclosed_in_quotes</code>: Boolean flag indicating whether CSV fields might be enclosed in quotes. Default is true.</li><li><code>set_white_space_to_null</code>: Boolean flag indicating whether whitespace-only values should be converted to NULL when calling the row command. Default is true.</li><li><code>row_command</code>: The SQL command to execute for each CSV row. Required when parsing CSV content. Default is <code>call process_csv_row($1,$2,$3,$4)</code></li></ul><p>Row command is executed under transaction for every CSV row. It accepts 4 optional and positional parameters:</p><ol><li>Parameter <code>$1</code> is always row number, type <code>integer</code>, starting from 1. If the CSV contains a header row, it will always be row number 1.</li><li>Parameter <code>$2</code> is always text array (type <code>text[]</code>) that contains entire row being processed.</li><li>Parameter <code>$3</code> is always the single result from the execution of the previous row command. Type is whatever type the row command returns. If the row command doesn't return anything, this parameter will always be NULL. If the row command does return value, this parameter will always be NULL in the first row.</li><li>Parameter <code>$4</code> is the JSON object containing metadata for this upload containing following fields:</li></ol><ul><li><code>type</code>: contains upload type key, default is <code>csv</code></li><li><code>fileName</code>: upload file name</li><li><code>contentType</code>: upload mime type</li><li><code>size</code>: upload size in bytes</li><li><code>status</code>: result of content verification. It can be <code>Ok</code>, <code>Empty</code>, <code>ProbablyBinary</code> or <code>NoNewLines</code>, but in the row command context it is always <code>Ok</code> (even when verification is not used).</li></ul><p>Same metadata JSON is sent to the main endpoint command parameter marked as upload metadata, with some differences:</p><ol><li>Metadata is array of objects.</li><li>Field <code>status</code> can be any allowed value (<code>Ok</code>, <code>Empty</code>, <code>ProbablyBinary</code> or <code>NoNewLines</code>).</li><li>Contains one extra field: <code>lastResult</code>. This field will contain value of the last row command (if any).</li></ol><p>Example:</p><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">-- table for uploads</span></span>
<span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">table</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">csv_example_upload_table</span><span style="color: #E6E6E6"> (</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">index</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    id </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">name</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">value</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span></span>
<span class="line"><span style="color: #E6E6E6">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">-- row command</span></span>
<span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> csv_example_upload_table_row(</span></span>
<span class="line"><span style="color: #E6E6E6">    _index </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _row </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">[]</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> plpgsql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">begin</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">insert into</span><span style="color: #E6E6E6"> csv_example_upload_table (</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #569CD6">index</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        id, </span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #569CD6">name</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #569CD6">value</span></span>
<span class="line"><span style="color: #E6E6E6">    ) </span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">values</span><span style="color: #E6E6E6"> (</span></span>
<span class="line"><span style="color: #E6E6E6">        _index,</span></span>
<span class="line"><span style="color: #E6E6E6">        _row[1]::</span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        _row[2],</span></span>
<span class="line"><span style="color: #E6E6E6">        _row[3]::</span><span style="color: #569CD6">int</span></span>
<span class="line"><span style="color: #E6E6E6">    );</span></span>
<span class="line"><span style="color: #569CD6">end</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">-- HTTP POST endpoint</span></span>
<span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">csv_example_upload</span><span style="color: #E6E6E6">(</span></span>
<span class="line"><span style="color: #E6E6E6">    _meta </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">returns</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> plpgsql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">begin</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">-- do something with metadata or raise exception to rollback this upload</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">return</span><span style="color: #E6E6E6"> _meta;</span></span>
<span class="line"><span style="color: #569CD6">end</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">comment on function csv_example_upload(json) is </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">HTTP POST</span></span>
<span class="line"><span style="color: #CE9178">upload for csv</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">delimiters = ,;</span></span>
<span class="line"><span style="color: #CE9178">row_command = call csv_example_upload_table_row($1,$2)</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">-- table for uploads</span></span>
<span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">table</span><span style="color: #000000"> </span><span style="color: #795E26">csv_example_upload_table</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">index</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    id </span><span style="color: #0000FF">int</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">name</span><span style="color: #000000"> </span><span style="color: #0000FF">text</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">value</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span></span>
<span class="line"><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">-- row command</span></span>
<span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> csv_example_upload_table_row(</span></span>
<span class="line"><span style="color: #000000">    _index </span><span style="color: #0000FF">int</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _row </span><span style="color: #0000FF">text</span><span style="color: #000000">[]</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> plpgsql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">begin</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">insert into</span><span style="color: #000000"> csv_example_upload_table (</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0000FF">index</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        id, </span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0000FF">name</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #0000FF">value</span></span>
<span class="line"><span style="color: #000000">    ) </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">values</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #000000">        _index,</span></span>
<span class="line"><span style="color: #000000">        _row[1]::</span><span style="color: #0000FF">int</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        _row[2],</span></span>
<span class="line"><span style="color: #000000">        _row[3]::</span><span style="color: #0000FF">int</span></span>
<span class="line"><span style="color: #000000">    );</span></span>
<span class="line"><span style="color: #0000FF">end</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">-- HTTP POST endpoint</span></span>
<span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">csv_example_upload</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    _meta </span><span style="color: #0000FF">json</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">returns</span><span style="color: #000000"> </span><span style="color: #0000FF">json</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> plpgsql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">begin</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">-- do something with metadata or raise exception to rollback this upload</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">return</span><span style="color: #000000"> _meta;</span></span>
<span class="line"><span style="color: #0000FF">end</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">comment on function csv_example_upload(json) is </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">HTTP POST</span></span>
<span class="line"><span style="color: #A31515">upload for csv</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">delimiters = ,;</span></span>
<span class="line"><span style="color: #A31515">row_command = call csv_example_upload_table_row($1,$2)</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span></code></pre></div><p>And now we can upload CSV using this upload endpoint:</p><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">fileName</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"example-csv-upload.csv"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">sb</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">StringBuilder</span><span style="color: #E6E6E6">();</span></span>
<span class="line"><span style="color: #9CDCFE">sb</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">AppendLine</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"11,XXX,333"</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">sb</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">AppendLine</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"12;YYY;666"</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">sb</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">AppendLine</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"13;;999"</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">sb</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">AppendLine</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"14,,,"</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">csvContent</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">sb</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">ToString</span><span style="color: #E6E6E6">();</span></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">contentBytes</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Encoding</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">UTF8</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetBytes</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">csvContent</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #C586C0">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">formData</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">MultipartFormDataContent</span><span style="color: #E6E6E6">();</span></span>
<span class="line"><span style="color: #C586C0">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">byteContent</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">ByteArrayContent</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">contentBytes</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">byteContent</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Headers</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">ContentType</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">MediaTypeHeaderValue</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"text/csv"</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">formData</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Add</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">byteContent</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"file"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">fileName</span><span style="color: #E6E6E6">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">await</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">test</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Client</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">PostAsync</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"/api/csv-example-upload/"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">formData</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">StatusCode</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Should</span><span style="color: #E6E6E6">().</span><span style="color: #DCDCAA">Be</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">HttpStatusCode</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">OK</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">fileName</span><span style="color: #000000"> = </span><span style="color: #A31515">"example-csv-upload.csv"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">sb</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">StringBuilder</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #001080">sb</span><span style="color: #000000">.</span><span style="color: #795E26">AppendLine</span><span style="color: #000000">(</span><span style="color: #A31515">"11,XXX,333"</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">sb</span><span style="color: #000000">.</span><span style="color: #795E26">AppendLine</span><span style="color: #000000">(</span><span style="color: #A31515">"12;YYY;666"</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">sb</span><span style="color: #000000">.</span><span style="color: #795E26">AppendLine</span><span style="color: #000000">(</span><span style="color: #A31515">"13;;999"</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">sb</span><span style="color: #000000">.</span><span style="color: #795E26">AppendLine</span><span style="color: #000000">(</span><span style="color: #A31515">"14,,,"</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">csvContent</span><span style="color: #000000"> = </span><span style="color: #001080">sb</span><span style="color: #000000">.</span><span style="color: #795E26">ToString</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">contentBytes</span><span style="color: #000000"> = </span><span style="color: #001080">Encoding</span><span style="color: #000000">.</span><span style="color: #001080">UTF8</span><span style="color: #000000">.</span><span style="color: #795E26">GetBytes</span><span style="color: #000000">(</span><span style="color: #001080">csvContent</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">formData</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">MultipartFormDataContent</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">byteContent</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">ByteArrayContent</span><span style="color: #000000">(</span><span style="color: #001080">contentBytes</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">byteContent</span><span style="color: #000000">.</span><span style="color: #001080">Headers</span><span style="color: #000000">.</span><span style="color: #001080">ContentType</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">MediaTypeHeaderValue</span><span style="color: #000000">(</span><span style="color: #A31515">"text/csv"</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">formData</span><span style="color: #000000">.</span><span style="color: #795E26">Add</span><span style="color: #000000">(</span><span style="color: #001080">byteContent</span><span style="color: #000000">, </span><span style="color: #A31515">"file"</span><span style="color: #000000">, </span><span style="color: #001080">fileName</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #0000FF">await</span><span style="color: #000000"> </span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">Client</span><span style="color: #000000">.</span><span style="color: #795E26">PostAsync</span><span style="color: #000000">(</span><span style="color: #A31515">"/api/csv-example-upload/"</span><span style="color: #000000">, </span><span style="color: #001080">formData</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">StatusCode</span><span style="color: #000000">.</span><span style="color: #795E26">Should</span><span style="color: #000000">().</span><span style="color: #795E26">Be</span><span style="color: #000000">(</span><span style="color: #001080">HttpStatusCode</span><span style="color: #000000">.</span><span style="color: #001080">OK</span><span style="color: #000000">);</span></span></code></pre></div><p>This CSV upload uses two delimiters: <code>,</code> and <code>;</code>. Resulting table <code>csv_example_upload_table</code> after uploading content from this example will look like this:</p><table class="table table-hover table-sm table-responsive-sm table-striped table-bordered"><thead><tr><th>index</th><th>id</th><th>name</th><th>value</th></tr></thead><tbody class="table-group-divider"><tr><td>1</td><td>11</td><td>XXX</td><td>333</td></tr><tr><td>2</td><td>12</td><td>YYY</td><td>666</td></tr><tr><td>3</td><td>13</td><td>NULL</td><td>999</td></tr><tr><td>4</td><td>14</td><td>NULL</td><td>NULL</td></tr></tbody></table><p>See the Test projects for more examples.</p><h5 id="new-upload-parameters">New Upload Parameters<a class="anchor bookmark-target" href="#new-upload-parameters"><i class="bi bi-link-45deg"></i></a></h5><p>All upload handlers now support additional common parameters:</p><ul><li><code>included_mime_types</code>: List of allowed MIME type patterns. Pattern may include <code>*</code> or <code>?</code>. If empty or null, all MIME types are allowed. Default is null, this parameter is not used.</li><li><code>excluded_mime_types</code>: List of disallowed MIME type patterns. Pattern may include <code>*</code> or <code>?</code>. Default is null, this parameter is not used.</li></ul><h4 id="new-custom-parameters">New Custom Parameters<a class="anchor bookmark-target" href="#new-custom-parameters"><i class="bi bi-link-45deg"></i></a></h4><p>New custom parameters were added to support existing functionalities. These values can be set with old comment annotation system. These are:</p><ul><li>Buffer rows parameters. Accept number.</li></ul><p><code>bufferrows</code> <code>buffer_rows</code> <code>buffer-rows</code> <code>buffer</code></p><ul><li>Raw parameters. Accept boolean.</li></ul><p><code>raw</code> <code>rawmode</code> <code>raw_mode</code> <code>raw-mode</code> <code>rawresults</code> <code>raw_results</code> <code>raw-results</code></p><ul><li>Separator parameters. Accept text.</li></ul><p><code>separator</code> <code>rawseparator</code> <code>raw_separator</code> <code>raw-separator</code></p><ul><li>New line parameters. Accept text.</li></ul><p><code>newline</code> <code>new_line</code> <code>new-line</code> <code>rawnewline</code> <code>raw_new_line</code> <code>raw-new-line</code></p><ul><li>Column names parameters. Accept boolean.</li></ul><p><code>columnnames</code> <code>column_names</code> <code>column-names</code></p><ul><li>Connection name parameters. Accept text.</li></ul><p><code>connection</code> <code>connectionname</code> <code>connection_name</code> <code>connection-name</code></p><h4 id="improved-error-handling-1">Improved Error Handling<a class="anchor bookmark-target" href="#improved-error-handling-1"><i class="bi bi-link-45deg"></i></a></h4><p>Added two more entries to <code>PostgreSqlErrorCodeToHttpStatusCodeMapping</code> options:</p><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Dictionary</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #D4D4D4">></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">PostgreSqlErrorCodeToHttpStatusCodeMapping</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">()</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"57014"</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">205</span><span style="color: #E6E6E6"> }, </span><span style="color: #6A9955">//query_canceled -> 205 Reset Content</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"P0001"</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">400</span><span style="color: #E6E6E6"> }, </span><span style="color: #6A9955">// raise_exception -> 400 Bad Request</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"P0004"</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">400</span><span style="color: #E6E6E6"> }, </span><span style="color: #6A9955">// assert_failure -> 400 Bad Request</span></span>
<span class="line"><span style="color: #E6E6E6">};</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">Dictionary</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000">> </span><span style="color: #001080">PostgreSqlErrorCodeToHttpStatusCodeMapping</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">new</span><span style="color: #000000">()</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"57014"</span><span style="color: #000000">, </span><span style="color: #098658">205</span><span style="color: #000000"> }, </span><span style="color: #008000">//query_canceled -> 205 Reset Content</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"P0001"</span><span style="color: #000000">, </span><span style="color: #098658">400</span><span style="color: #000000"> }, </span><span style="color: #008000">// raise_exception -> 400 Bad Request</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"P0004"</span><span style="color: #000000">, </span><span style="color: #098658">400</span><span style="color: #000000"> }, </span><span style="color: #008000">// assert_failure -> 400 Bad Request</span></span>
<span class="line"><span style="color: #000000">};</span></span></code></pre></div><p>This configuration is now returning 400 Bad Request response on:</p><ul><li>Custom Pl/pgSQL exceptions (raise exception)</li><li>Custom Pl/pgSQL asserts (assert failure)</li></ul><p>Also, if endpoint is returning 400 Bad Request due the exception (raise exception, assert failure), the response string will contain a full message (exception message or assertion message) without trailing error code.</p><h4 id="fixes">Fixes<a class="anchor bookmark-target" href="#fixes"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Fixed bug with wrong parameter default value detection when using stored procedures.</li><li>Fixes on upload handlers:<ul><li>improved upload rollback and cleanup on error</li><li>fixed handling of multiple uploads</li><li>fixed upload logging</li><li>fixed issue with metadata parameter when all parameters using default value</li></ul></li></ul><h3 id="npgsqlrest-client-app">NpgsqlRest Client App<a class="anchor bookmark-target" href="#npgsqlrest-client-app"><i class="bi bi-link-45deg"></i></a></h3><h4 id="fixes-1">Fixes<a class="anchor bookmark-target" href="#fixes-1"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Fixed <code>CacheParsedFile</code> option in <code>StaticFiles.ParseContentOptions</code> client configuration. Previously, it was always set to true, even if set to false in the configuration.</li></ul><hr><h2 id="version-2250-2025-05-06">Version <a href="https://github.com/vb-consulting/NpgsqlRest/tree/2.25.0">2.25.0</a> (2025-05-06)<a class="anchor bookmark-target" href="#version-2250-2025-05-06"><i class="bi bi-link-45deg"></i></a></h2><p><a href="https://github.com/vb-consulting/NpgsqlRest/compare/2.24.0...2.25.0">Full Changelog</a></p><h3 id="core-npgsqlrest-library-1">Core NpgsqlRest Library<a class="anchor bookmark-target" href="#core-npgsqlrest-library-1"><i class="bi bi-link-45deg"></i></a></h3><h4 id="support-for-custom-parameters">Support for Custom Parameters<a class="anchor bookmark-target" href="#support-for-custom-parameters"><i class="bi bi-link-45deg"></i></a></h4><p>Custom parameters support for created endpoint has been added.</p><p>For now, only upload handlers are using custom parameters:</p><ul><li><code>large_object</code> upload handler have following parameters:</li></ul><ol><li><code>oid</code>: set the custom <code>oid</code> number to be used. By default, new <code>oid</code> is assigned on each upload.</li><li><code>buffer_size</code>: set the custom buffer size. Default is 8192 or 8K buffer size</li></ol><ul><li><code>file_system</code> upload handler ave following parameters:</li></ul><ol><li><code>path</code>: set the custom path for upload. Default is current path <code>./</code></li><li><code>file</code>: set the custom file name for upload. Default is whatever name is received in request.</li><li><code>unique_name</code>: boolean field that, if true, will automatically set file name to be unique (name is GUID and extension is the same). Can only have true or false values (case insensitive). Default is true.</li><li><code>create_path</code>: boolean field that, if true, will check if the path exists, and create it if it doesn't. Can only have true or false values (case insensitive). Default is false.</li><li><code>buffer_size</code>: set the custom buffer size. Default is 8192 or 8K buffer size.</li></ol><ul><li>Custom parameters can be set programmatically in <code>CustomParameters</code> dictionary for each endpoint:</li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">UseNpgsqlRest</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">connectionString</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">EndpointCreated</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class="line"><span style="color: #E6E6E6">    {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">endpoint</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Routine</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">==</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"upload"</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">        {</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CustomParameters</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">() { [</span><span style="color: #CE9178">"unique_name"</span><span style="color: #E6E6E6">] </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"false"</span><span style="color: #E6E6E6">};</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">});</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">UseNpgsqlRest</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000">(</span><span style="color: #001080">connectionString</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">EndpointCreated</span><span style="color: #000000"> = </span><span style="color: #001080">endpoint</span><span style="color: #000000"> =></span></span>
<span class="line"><span style="color: #000000">    {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">endpoint</span><span style="color: #000000">?.</span><span style="color: #001080">Routine</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000"> == </span><span style="color: #A31515">"upload"</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">        {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">CustomParameters</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000">() { [</span><span style="color: #A31515">"unique_name"</span><span style="color: #000000">] = </span><span style="color: #A31515">"false"</span><span style="color: #000000">};</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">});</span></span></code></pre></div><ul><li>Custom parameters can be set by using comment annotations.</li><li>Each comment annotations line that:<ul><li>has equal character <code>=</code></li><li>first part, before equal character is word (alphanumerics, <code>_</code>, <code>-</code>)</li></ul></li><li>For example:</li></ul><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">my_upload</span><span style="color: #E6E6E6">(</span></span>
<span class="line"><span style="color: #E6E6E6">    _meta </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">returns</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> plpgsql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">begin</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">-- return same upload metadata</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">return</span><span style="color: #E6E6E6"> _meta;</span></span>
<span class="line"><span style="color: #569CD6">end</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">comment on function my_upload(json) is </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">upload for file_system</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">path = ./uploads</span></span>
<span class="line"><span style="color: #CE9178">unique_name = false</span></span>
<span class="line"><span style="color: #CE9178">create_path = false</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">my_upload</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    _meta </span><span style="color: #0000FF">json</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">returns</span><span style="color: #000000"> </span><span style="color: #0000FF">json</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> plpgsql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">begin</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">-- return same upload metadata</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">return</span><span style="color: #000000"> _meta;</span></span>
<span class="line"><span style="color: #0000FF">end</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">comment on function my_upload(json) is </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">upload for file_system</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">path = ./uploads</span></span>
<span class="line"><span style="color: #A31515">unique_name = false</span></span>
<span class="line"><span style="color: #A31515">create_path = false</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span></code></pre></div><ul><li>Custom parameters annotations can be set from the parameter value, using default formatter (name enclosed with <code>{</code> and <code>}</code>). Parameter name can be original or parsed. For example:</li></ul><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">my_upload</span><span style="color: #E6E6E6">(</span></span>
<span class="line"><span style="color: #E6E6E6">    _path </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _file </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _unique_name </span><span style="color: #569CD6">boolean</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _create_path </span><span style="color: #569CD6">boolean</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _meta </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">returns</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> plpgsql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">begin</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">-- return same upload metadata</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">return</span><span style="color: #E6E6E6"> _meta;</span></span>
<span class="line"><span style="color: #569CD6">end</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">comment on function my_upload(text, text, boolean, boolean, json) is </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">upload for file_system</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">path = {_path}</span></span>
<span class="line"><span style="color: #CE9178">file = {_file}</span></span>
<span class="line"><span style="color: #CE9178">unique_name = {_unique_name}</span></span>
<span class="line"><span style="color: #CE9178">create_path = {_create_path}</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">my_upload</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    _path </span><span style="color: #0000FF">text</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _file </span><span style="color: #0000FF">text</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _unique_name </span><span style="color: #0000FF">boolean</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _create_path </span><span style="color: #0000FF">boolean</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _meta </span><span style="color: #0000FF">json</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">returns</span><span style="color: #000000"> </span><span style="color: #0000FF">json</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> plpgsql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">begin</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">-- return same upload metadata</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">return</span><span style="color: #000000"> _meta;</span></span>
<span class="line"><span style="color: #0000FF">end</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">comment on function my_upload(text, text, boolean, boolean, json) is </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">upload for file_system</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">path = {_path}</span></span>
<span class="line"><span style="color: #A31515">file = {_file}</span></span>
<span class="line"><span style="color: #A31515">unique_name = {_unique_name}</span></span>
<span class="line"><span style="color: #A31515">create_path = {_create_path}</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span></code></pre></div><ul><li>Note: parameter name can be original name or parsed name. Default name parser is camel case, so the names like <code>path</code>, <code>file</code>, <code>uniqueName</code> or <code>createPath</code> are equally valid.</li><li>This example can be used like this:</li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">// csvContent is the string content</span></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">fileName</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"test-data.csv"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">contentBytes</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Encoding</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">UTF8</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetBytes</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">csvContent</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #C586C0">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">formData</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">MultipartFormDataContent</span><span style="color: #E6E6E6">();</span></span>
<span class="line"><span style="color: #C586C0">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">byteContent</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">ByteArrayContent</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">contentBytes</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">byteContent</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Headers</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">ContentType</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">MediaTypeHeaderValue</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"text/csv"</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #9CDCFE">formData</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Add</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">byteContent</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"file"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">fileName</span><span style="color: #E6E6E6">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">query</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">QueryBuilder</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"path"</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"./test"</span><span style="color: #E6E6E6"> },</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"file"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">fileName</span><span style="color: #E6E6E6"> },</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"uniqueName"</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"false"</span><span style="color: #E6E6E6"> },</span></span>
<span class="line"><span style="color: #E6E6E6">    { </span><span style="color: #CE9178">"createPath"</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"true"</span><span style="color: #E6E6E6"> },</span></span>
<span class="line"><span style="color: #E6E6E6">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C586C0">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">await</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">test</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Client</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">PostAsync</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">$"/api/my-upload/{</span><span style="color: #9CDCFE">query</span><span style="color: #CE9178">}"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">formData</span><span style="color: #E6E6E6">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #6A9955">// upload is saved as ./test/test-data.csv</span></span>
<span class="line"><span style="color: #6A9955">//</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">// csvContent is the string content</span></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">fileName</span><span style="color: #000000"> = </span><span style="color: #A31515">"test-data.csv"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">contentBytes</span><span style="color: #000000"> = </span><span style="color: #001080">Encoding</span><span style="color: #000000">.</span><span style="color: #001080">UTF8</span><span style="color: #000000">.</span><span style="color: #795E26">GetBytes</span><span style="color: #000000">(</span><span style="color: #001080">csvContent</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">formData</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">MultipartFormDataContent</span><span style="color: #000000">();</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">byteContent</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">ByteArrayContent</span><span style="color: #000000">(</span><span style="color: #001080">contentBytes</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">byteContent</span><span style="color: #000000">.</span><span style="color: #001080">Headers</span><span style="color: #000000">.</span><span style="color: #001080">ContentType</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">MediaTypeHeaderValue</span><span style="color: #000000">(</span><span style="color: #A31515">"text/csv"</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #001080">formData</span><span style="color: #000000">.</span><span style="color: #795E26">Add</span><span style="color: #000000">(</span><span style="color: #001080">byteContent</span><span style="color: #000000">, </span><span style="color: #A31515">"file"</span><span style="color: #000000">, </span><span style="color: #001080">fileName</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">query</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">QueryBuilder</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"path"</span><span style="color: #000000">, </span><span style="color: #A31515">"./test"</span><span style="color: #000000"> },</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"file"</span><span style="color: #000000">, </span><span style="color: #001080">fileName</span><span style="color: #000000"> },</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"uniqueName"</span><span style="color: #000000">, </span><span style="color: #A31515">"false"</span><span style="color: #000000"> },</span></span>
<span class="line"><span style="color: #000000">    { </span><span style="color: #A31515">"createPath"</span><span style="color: #000000">, </span><span style="color: #A31515">"true"</span><span style="color: #000000"> },</span></span>
<span class="line"><span style="color: #000000">};</span></span>
<span class="line"></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #0000FF">await</span><span style="color: #000000"> </span><span style="color: #001080">test</span><span style="color: #000000">.</span><span style="color: #001080">Client</span><span style="color: #000000">.</span><span style="color: #795E26">PostAsync</span><span style="color: #000000">(</span><span style="color: #A31515">$"/api/my-upload/{</span><span style="color: #001080">query</span><span style="color: #A31515">}"</span><span style="color: #000000">, </span><span style="color: #001080">formData</span><span style="color: #000000">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #008000">// upload is saved as ./test/test-data.csv</span></span>
<span class="line"><span style="color: #008000">//</span></span></code></pre></div><h4 id="other-improvements">Other Improvements<a class="anchor bookmark-target" href="#other-improvements"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Improved parameter parsing for header values set by comment annotations</li><li>Now using high speed and well tested template parser to parse <code>{name}</code> formats</li><li>When using header values set by comment annotations, header name must be a single word (alphanumerics, <code>_</code>, <code>-</code>).</li><li>When using header values set by comment annotations that should be parsed from parameter values, parameter name can also be parsed name:</li></ul><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">header_template_response1</span><span style="color: #E6E6E6">(_type </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, _file </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">) </span></span>
<span class="line"><span style="color: #569CD6">returns</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">table</span><span style="color: #E6E6E6">(n </span><span style="color: #569CD6">numeric</span><span style="color: #E6E6E6">, d </span><span style="color: #569CD6">timestamp</span><span style="color: #E6E6E6">, b </span><span style="color: #569CD6">boolean</span><span style="color: #E6E6E6">, t </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">sql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">select</span><span style="color: #E6E6E6"> sub.</span><span style="color: #D4D4D4">*</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #569CD6">from</span><span style="color: #E6E6E6"> (</span></span>
<span class="line"><span style="color: #569CD6">values</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">    (</span><span style="color: #B5CEA8">123</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">'2024-01-01'</span><span style="color: #E6E6E6">::</span><span style="color: #569CD6">timestamp</span><span style="color: #E6E6E6">, true, </span><span style="color: #CE9178">'some text'</span><span style="color: #E6E6E6">),</span></span>
<span class="line"><span style="color: #E6E6E6">    (</span><span style="color: #B5CEA8">456</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">'2024-12-31'</span><span style="color: #E6E6E6">::</span><span style="color: #569CD6">timestamp</span><span style="color: #E6E6E6">, false, </span><span style="color: #CE9178">'another text'</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">sub (n, d, b, t)</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">comment on function header_template_response1(text, text) is </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">raw</span></span>
<span class="line"><span style="color: #CE9178">separator ,</span></span>
<span class="line"><span style="color: #CE9178">newline </span><span style="color: #D7BA7D">\n</span></span>
<span class="line"><span style="color: #CE9178">Content-Type: {_type}</span></span>
<span class="line"><span style="color: #CE9178">Content-Disposition: attachment; filename={_file}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">header_template_response1</span><span style="color: #000000">(_type </span><span style="color: #0000FF">text</span><span style="color: #000000">, _file </span><span style="color: #0000FF">text</span><span style="color: #000000">) </span></span>
<span class="line"><span style="color: #0000FF">returns</span><span style="color: #000000"> </span><span style="color: #0000FF">table</span><span style="color: #000000">(n </span><span style="color: #0000FF">numeric</span><span style="color: #000000">, d </span><span style="color: #0000FF">timestamp</span><span style="color: #000000">, b </span><span style="color: #0000FF">boolean</span><span style="color: #000000">, t </span><span style="color: #0000FF">text</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> </span><span style="color: #0000FF">sql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">select</span><span style="color: #000000"> sub.* </span></span>
<span class="line"><span style="color: #0000FF">from</span><span style="color: #000000"> (</span></span>
<span class="line"><span style="color: #0000FF">values</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">    (</span><span style="color: #098658">123</span><span style="color: #000000">, </span><span style="color: #A31515">'2024-01-01'</span><span style="color: #000000">::</span><span style="color: #0000FF">timestamp</span><span style="color: #000000">, true, </span><span style="color: #A31515">'some text'</span><span style="color: #000000">),</span></span>
<span class="line"><span style="color: #000000">    (</span><span style="color: #098658">456</span><span style="color: #000000">, </span><span style="color: #A31515">'2024-12-31'</span><span style="color: #000000">::</span><span style="color: #0000FF">timestamp</span><span style="color: #000000">, false, </span><span style="color: #A31515">'another text'</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">sub (n, d, b, t)</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">comment on function header_template_response1(text, text) is </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">raw</span></span>
<span class="line"><span style="color: #A31515">separator ,</span></span>
<span class="line"><span style="color: #A31515">newline </span><span style="color: #EE0000">\n</span></span>
<span class="line"><span style="color: #A31515">Content-Type: {_type}</span></span>
<span class="line"><span style="color: #A31515">Content-Disposition: attachment; filename={_file}</span></span></code></pre></div><p>This is also valid, when using default name parser:</p><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">comment on function header_template_response1(text, text) is </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">raw</span></span>
<span class="line"><span style="color: #CE9178">separator ,</span></span>
<span class="line"><span style="color: #CE9178">newline </span><span style="color: #D7BA7D">\n</span></span>
<span class="line"><span style="color: #CE9178">Content-Type: {type}</span></span>
<span class="line"><span style="color: #CE9178">Content-Disposition: attachment; filename={file}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">comment on function header_template_response1(text, text) is </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">raw</span></span>
<span class="line"><span style="color: #A31515">separator ,</span></span>
<span class="line"><span style="color: #A31515">newline </span><span style="color: #EE0000">\n</span></span>
<span class="line"><span style="color: #A31515">Content-Type: {type}</span></span>
<span class="line"><span style="color: #A31515">Content-Disposition: attachment; filename={file}</span></span></code></pre></div><h3 id="npgsqlrest-client-app-1">NpgsqlRest Client App<a class="anchor bookmark-target" href="#npgsqlrest-client-app-1"><i class="bi bi-link-45deg"></i></a></h3><h4 id="added-data-protection">Added Data Protection<a class="anchor bookmark-target" href="#added-data-protection"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Data protection mechanism is included from this version.</li><li>Data protection helps securely store encryption keys for encrypted cookies and antiforgery tokens.</li><li>When data protection is not enabled, and application is using authentication cookies, user will be invalidated (signed out) every time application restarts (redeployment scenario).</li><li>Three modes are supported:</li></ul><ol><li><code>Default</code>: Windows only.</li><li><code>FileSystem</code>: Requires setting path in <code>FileSystemPath</code> for storing keys. Note: when using Docker, this path must be volume path to persist after restarts.</li><li><code>Database</code>: Store keys in database require setting <code>GetAllElementsCommand</code> (expected to return rows with a single column of type text and have no parameters) and <code>StoreElementCommand</code> (receives two parameters: name and data of type text. Doesn't return anything).</li></ol><ul><li>New configuration section:</li></ul><div class="code jsonc"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">// Data protection settings. Encryption keys for Auth Cookies and Antiforgery tokens.</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">  </span><span style="color: #9CDCFE">"DataProtection"</span><span style="color: #E6E6E6">: {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"Enabled"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Set to null to use the current "ApplicationName"</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"CustomApplicationName"</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Sets the default lifetime in days of keys created by the data protection system.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"DefaultKeyLifetimeDays"</span><span style="color: #E6E6E6">: </span><span style="color: #B5CEA8">90</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Data protection location: "Default", "FileSystem" or "Database"</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Note: When running on Linux, using Default keys will not be persisted. </span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// When keys are lost on restarts, Cookie Auth and Antiforgery tokens will also not work on restart.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Linux users should use FileSystem or Database storage.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"Storage"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"Default"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// FileSystem storage path. Set to a valid path when using FileSystem.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Note: When running in Docker environment, the path must be a Docker volume path.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"FileSystemPath"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"./data-protection-keys"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// GetAllElements database command. Expected to rows with a single column of type text.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"GetAllElementsCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"select get_data_protection_keys()"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// StoreElement database command. Receives two parameters: name and data of type text. Doesn't return anything.</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">"StoreElementCommand"</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"call store_data_protection_keys($1,$2)"</span></span>
<span class="line"><span style="color: #E6E6E6">  }</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">// Data protection settings. Encryption keys for Auth Cookies and Antiforgery tokens.</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">  </span><span style="color: #0451A5">"DataProtection"</span><span style="color: #000000">: {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"Enabled"</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Set to null to use the current "ApplicationName"</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"CustomApplicationName"</span><span style="color: #000000">: </span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Sets the default lifetime in days of keys created by the data protection system.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"DefaultKeyLifetimeDays"</span><span style="color: #000000">: </span><span style="color: #098658">90</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Data protection location: "Default", "FileSystem" or "Database"</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Note: When running on Linux, using Default keys will not be persisted. </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// When keys are lost on restarts, Cookie Auth and Antiforgery tokens will also not work on restart.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Linux users should use FileSystem or Database storage.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"Storage"</span><span style="color: #000000">: </span><span style="color: #A31515">"Default"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// FileSystem storage path. Set to a valid path when using FileSystem.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// Note: When running in Docker environment, the path must be a Docker volume path.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"FileSystemPath"</span><span style="color: #000000">: </span><span style="color: #A31515">"./data-protection-keys"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// GetAllElements database command. Expected to rows with a single column of type text.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"GetAllElementsCommand"</span><span style="color: #000000">: </span><span style="color: #A31515">"select get_data_protection_keys()"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">// StoreElement database command. Receives two parameters: name and data of type text. Doesn't return anything.</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0451A5">"StoreElementCommand"</span><span style="color: #000000">: </span><span style="color: #A31515">"call store_data_protection_keys($1,$2)"</span></span>
<span class="line"><span style="color: #000000">  }</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h4 id="other-improvements-1">Other Improvements<a class="anchor bookmark-target" href="#other-improvements-1"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Fixed <code>Auth.CookieValidDays</code> bug which prevented setting validation different than 90 days.</li></ul><hr><h2 id="version-2240-2025-04-29">Version <a href="https://github.com/vb-consulting/NpgsqlRest/tree/2.24.0">2.24.0</a> (2025-04-29)<a class="anchor bookmark-target" href="#version-2240-2025-04-29"><i class="bi bi-link-45deg"></i></a></h2><p><a href="https://github.com/vb-consulting/NpgsqlRest/compare/2.23.0...2.24.0">Full Changelog</a></p><h3 id="core-npgsqlrest-library-2">Core NpgsqlRest Library<a class="anchor bookmark-target" href="#core-npgsqlrest-library-2"><i class="bi bi-link-45deg"></i></a></h3><ul><li>Added support for callback command when password verification fails on login.</li></ul><h3 id="npgsqlrest-client-app-2">NpgsqlRest Client App<a class="anchor bookmark-target" href="#npgsqlrest-client-app-2"><i class="bi bi-link-45deg"></i></a></h3><ul><li>Added support for callback command when password verification fails on login.</li><li>Fixed data parameter for external login to send actual retrieved data.</li><li>Fixed Docker image to have valid certificate.</li></ul><hr><h2 id="version-2230-2025-04-28">Version <a href="https://github.com/vb-consulting/NpgsqlRest/tree/2.23.0">2.23.0</a> (2025-04-28)<a class="anchor bookmark-target" href="#version-2230-2025-04-28"><i class="bi bi-link-45deg"></i></a></h2><p><a href="https://github.com/vb-consulting/NpgsqlRest/compare/2.22.0...2.23.0">Full Changelog</a></p><h3 id="tsclient-plugin-fixes">TsClient Plugin Fixes<a class="anchor bookmark-target" href="#tsclient-plugin-fixes"><i class="bi bi-link-45deg"></i></a></h3><ul><li>Fixed TsClient plugin to handle booleans correctly.</li><li>Added JsCode style comments for parameters and return values in TsClient plugin.</li><li>Added upload support for TS and JS client.</li><li>Added support for XsrfTokenHeaderName if used. This is used by the Upload endpoints.</li><li>Smaller fixes in the TsClient plugin to handle some edge cases.</li></ul><h3 id="core-npgsqlrest-library-3">Core NpgsqlRest Library<a class="anchor bookmark-target" href="#core-npgsqlrest-library-3"><i class="bi bi-link-45deg"></i></a></h3><h4 id="simplified-endpointcreated-option-event">Simplified EndpointCreated Option Event<a class="anchor bookmark-target" href="#simplified-endpointcreated-option-event"><i class="bi bi-link-45deg"></i></a></h4><ul><li>From now on, this event doesn't require returning an endpoint, since it receives the endpoint instance as the parameter:</li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Callback function that is executed just after the new endpoint is created. Set the RoutineEndpoint to null to disable endpoint.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Action</span><span style="color: #D4D4D4">&lt;</span><span style="color: #9CDCFE">RoutineEndpoint</span><span style="color: #D4D4D4">?>?</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">EndpointCreated</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Callback function that is executed just after the new endpoint is created. Set the RoutineEndpoint to null to disable endpoint.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">Action</span><span style="color: #000000">&lt;</span><span style="color: #001080">RoutineEndpoint</span><span style="color: #000000">?>? </span><span style="color: #001080">EndpointCreated</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span></code></pre></div><p>To change endpoint properties, simply change them on the parameter instance directly or set to null to disable if necessary:</p><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">UseNpgsqlRest</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">connectionString</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">EndpointCreated</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">    {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">endpoint</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Routine</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">==</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"restricted"</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">        {</span></span>
<span class="line"><span style="color: #6A9955">            // disable the endpoint</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">});</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">UseNpgsqlRest</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000">(</span><span style="color: #001080">connectionString</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">EndpointCreated</span><span style="color: #000000"> = </span><span style="color: #001080">endpoint</span><span style="color: #000000"> => </span></span>
<span class="line"><span style="color: #000000">    {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">endpoint</span><span style="color: #000000">?.</span><span style="color: #001080">Routine</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000"> == </span><span style="color: #A31515">"restricted"</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">        {</span></span>
<span class="line"><span style="color: #008000">            // disable the endpoint</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">endpoint</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">});</span></span></code></pre></div><h4 id="added-path-to-comment-annotation-parser">Added PATH to Comment Annotation Parser<a class="anchor bookmark-target" href="#added-path-to-comment-annotation-parser"><i class="bi bi-link-45deg"></i></a></h4><ul><li>New comment annotation: <code>PATH path</code>.</li><li>Ability to set just HTTP path without method by using <code>PATH /my-path/</code></li><li>If HTTP tag has only two params and second param is not valid VERB (GET, POST, etc) - it is treated as the path.</li></ul><h4 id="added-securitysensitive-routine-option">Added SecuritySensitive Routine Option<a class="anchor bookmark-target" href="#added-securitysensitive-routine-option"><i class="bi bi-link-45deg"></i></a></h4><ul><li><p>New Endpoint Option and Comment Annotation: <code>securitysensitive</code> <code>sensitive</code> <code>security</code> <code>security_sensitive</code> <code>security-sensitive</code></p></li><li><p>This will manually obfuscate all parameter values before sending them to log.</p></li></ul><h4 id="hashing-capabilities">Hashing Capabilities<a class="anchor bookmark-target" href="#hashing-capabilities"><i class="bi bi-link-45deg"></i></a></h4><ul><li>This is a completely new feature. There is a default hasher class that can be injected into the system with the new option called <code>PasswordHasher</code>.</li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Default password hasher object. Inject custom password hasher object to add default password hasher.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">IPasswordHasher</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">PasswordHasher</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">PasswordHasher</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Default password hasher object. Inject custom password hasher object to add default password hasher.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">IPasswordHasher</span><span style="color: #000000"> </span><span style="color: #001080">PasswordHasher</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">PasswordHasher</span><span style="color: #000000">();</span></span></code></pre></div><ul><li>Default implementation in <code>PasswordHasher</code> class is using PBKDF2 (Password-Based Key Derivation Function 2) with SHA-256 and it incorporates 128-bit salt with 600,000 iterations (OWASP-recommended as of 2025). So it's secure, but there is an option to inject a different one.</li></ul><h5 id="mark-parameter-as-hash">Mark Parameter as Hash<a class="anchor bookmark-target" href="#mark-parameter-as-hash"><i class="bi bi-link-45deg"></i></a></h5><ul><li><p>Ability to mark the parameter as hash and the value will be pre-hashed with the default hasher.</p></li><li><p>New comment annotations:</p><ul><li><code>param param_name1 is hash of param_name2</code> - the first parameter <code>param_name1</code> will have the hashed value of <code>param_name2</code>.</li><li><code>param param_name is hash of param_name</code> - this parameter <code>param_name</code> will have the original value hashed.</li><li>Typical usage: <code>param _hashed_password is hash of _password</code> or just <code>param _password is hash of _password</code>.</li></ul></li><li><p>This can be set programmatically also:</p></li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">UseNpgsqlRest</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">connectionString</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">EndpointCreated</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">    {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">endpoint</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Routine</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">==</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"login"</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">        {</span></span>
<span class="line"><span style="color: #6A9955">            // Set the second parameter to contain the hash instead of plain text</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Routine</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Parameters</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">HashOf</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Routine</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Parameters</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">];</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">});</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">UseNpgsqlRest</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000">(</span><span style="color: #001080">connectionString</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">EndpointCreated</span><span style="color: #000000"> = </span><span style="color: #001080">endpoint</span><span style="color: #000000"> => </span></span>
<span class="line"><span style="color: #000000">    {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">endpoint</span><span style="color: #000000">?.</span><span style="color: #001080">Routine</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000"> == </span><span style="color: #A31515">"login"</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">        {</span></span>
<span class="line"><span style="color: #008000">            // Set the second parameter to contain the hash instead of plain text</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">Routine</span><span style="color: #000000">.</span><span style="color: #001080">Parameters</span><span style="color: #000000">[</span><span style="color: #098658">1</span><span style="color: #000000">].</span><span style="color: #001080">HashOf</span><span style="color: #000000"> = </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">Routine</span><span style="color: #000000">.</span><span style="color: #001080">Parameters</span><span style="color: #000000">[</span><span style="color: #098658">1</span><span style="color: #000000">];</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">});</span></span></code></pre></div><h5 id="login-endpoints-can-verify-hashes">Login Endpoints Can Verify Hashes<a class="anchor bookmark-target" href="#login-endpoints-can-verify-hashes"><i class="bi bi-link-45deg"></i></a></h5><ul><li><p>New ability of the Login endpoints to compare and verify returned password hashes.</p></li><li><p>Login endpoints can now return field <code>hash</code> (configurable) and when they do, it will be verified against a parameter that contains "pass" (configurable).</p></li><li><p>If verification fails, login will:</p><ul><li>Automatically return status 404 with no message.</li><li>Relevant information will be logged as a warning to default logger: <code>Password verification failed for attempted login: path={path} userId={userId}, username={userName}</code>.</li><li>If the option <code>AuthenticationOptions.PasswordVerificationFailedCommand</code> is defined, this command will be executed with following optional parameters:<ul><li><ol><li>scheme (text)</li></ol></li><li><ol start="2"><li>user name (text)</li></ol></li><li><ol start="3"><li>user id (text)</li></ol></li></ul></li></ul></li><li><p>New <code>AuthenticationOptions</code> values to support this feature are these:</p></li></ul><ol><li><p><code>AuthenticationOptions.HashColumnName</code></p><ul><li>Type: <code>string</code></li><li>Default: <code>"hash"</code></li></ul><p>The default column name in the data reader that will contain password hash. If this column is present, value will be verified with the default hasher against the password parameter.</p></li><li><p><code>AuthenticationOptions.PasswordParameterNameContains</code></p></li></ol><ul><li>Type: <code>string</code></li><li>Default: <code>"pass"</code></li></ul><p>When the login endpoint tries to verify supplied hash with the password parameter, this value will be used to locate the password parameter from the parameter collection. That will be the first parameter that contains this string in parameter name (either original or translated).</p><ol start="3"><li><code>AuthenticationOptions.PasswordVerificationFailedCommand</code></li></ol><p>Text command with three optional parameters that is executed when automatic hash verification fails. Executing this command gives you chance to update appswrod attempts in database for example.</p><p>Command accepts three optional and positional parameters:</p><ol><li>scheme (text)</li><li>user name (text)</li><li>user id (text)</li></ol><p>Execution will be skipped if this option is null or empty.</p><h4 id="upload-support">Upload Support<a class="anchor bookmark-target" href="#upload-support"><i class="bi bi-link-45deg"></i></a></h4><ul><li><p>There is robust and flexible UPLOAD endpoint support from this version.</p></li><li><p>There are three new options to support this feature:</p></li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Default upload handler options. </span></span>
<span class="line"><span style="color: #6A9955">/// Set this option to null to disable upload handlers or use this to modify upload handler options.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UploadHandlerOptions</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUploadHandlerOptions</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">UploadHandlerOptions</span><span style="color: #E6E6E6">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Upload handlers dictionary map. </span></span>
<span class="line"><span style="color: #6A9955">/// When the endpoint has set Upload to true, this dictionary will be used to find the upload handlers for the current request. </span></span>
<span class="line"><span style="color: #6A9955">/// Handler will be located by the key values from the endpoint UploadHandlers string array property if set or by the default upload handler (DefaultUploadHandler option).</span></span>
<span class="line"><span style="color: #6A9955">/// Set this option to null to use default upload handler from the UploadHandlerOptions property.</span></span>
<span class="line"><span style="color: #6A9955">/// Set this option to empty dictionary to disable upload handlers.</span></span>
<span class="line"><span style="color: #6A9955">/// Set this option to a dictionary with one or more upload handlers to enable your own custom upload handlers.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Dictionary</span><span style="color: #D4D4D4">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">Func</span><span style="color: #D4D4D4">&lt;</span><span style="color: #9CDCFE">IUploadHandler</span><span style="color: #D4D4D4">>>?</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UploadHandlers</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #6A9955">/// Default upload handler name. This value is used when the upload handlers are not specified.</span></span>
<span class="line"><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DefaultUploadHandler</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Default upload handler options. </span></span>
<span class="line"><span style="color: #008000">/// Set this option to null to disable upload handlers or use this to modify upload handler options.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">UploadHandlerOptions</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUploadHandlerOptions</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">UploadHandlerOptions</span><span style="color: #000000">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Upload handlers dictionary map. </span></span>
<span class="line"><span style="color: #008000">/// When the endpoint has set Upload to true, this dictionary will be used to find the upload handlers for the current request. </span></span>
<span class="line"><span style="color: #008000">/// Handler will be located by the key values from the endpoint UploadHandlers string array property if set or by the default upload handler (DefaultUploadHandler option).</span></span>
<span class="line"><span style="color: #008000">/// Set this option to null to use default upload handler from the UploadHandlerOptions property.</span></span>
<span class="line"><span style="color: #008000">/// Set this option to empty dictionary to disable upload handlers.</span></span>
<span class="line"><span style="color: #008000">/// Set this option to a dictionary with one or more upload handlers to enable your own custom upload handlers.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">Dictionary</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #001080">Func</span><span style="color: #000000">&lt;</span><span style="color: #001080">IUploadHandler</span><span style="color: #000000">>>? </span><span style="color: #001080">UploadHandlers</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class="line"><span style="color: #008000">/// Default upload handler name. This value is used when the upload handlers are not specified.</span></span>
<span class="line"><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">DefaultUploadHandler</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">;</span></span></code></pre></div><ul><li>Endpoints also have two new properties:</li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Upload</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">[]</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UploadHandlers</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">Upload</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">[]? </span><span style="color: #001080">UploadHandlers</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span></code></pre></div><ul><li><p>When the endpoint has Upload set to true, the request will first try to locate appropriate handlers.</p></li><li><p>Endpoint can specify one or more handlers with <code>UploadHandlers</code> property (keys in <code>UploadHandlers</code> dictionary).</p></li><li><p>When endpoint <code>UploadHandlers</code> property is null, Upload handler will use the one from the <code>DefaultUploadHandler</code> option ("large_object" by default).</p></li><li><p>Option <code>Dictionary&lt;string, Func&lt;IUploadHandler>>? UploadHandlers</code> is initialized from the <code>DefaultUploadHandlerOptions</code> option which has these defaults:</p></li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">UploadsEnabled</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">LargeObjectEnabled</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">LargeObjectKey</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">LargeObjectHandlerBufferSize</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">8192</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">FileSystemEnabled</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">FileSystemKey</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"file_system"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">FileSystemHandlerPath</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"./"</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">FileSystemHandlerUseUniqueFileName</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">FileSystemHandlerCreatePathIfNotExists</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">FileSystemHandlerBufferSize</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">get</span><span style="color: #E6E6E6">; </span><span style="color: #9CDCFE">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">8192</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">UploadsEnabled</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">LargeObjectEnabled</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">LargeObjectKey</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"large_object"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">LargeObjectHandlerBufferSize</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #098658">8192</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">FileSystemEnabled</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">FileSystemKey</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"file_system"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">FileSystemHandlerPath</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #A31515">"./"</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">FileSystemHandlerUseUniqueFileName</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">bool</span><span style="color: #000000"> </span><span style="color: #001080">FileSystemHandlerCreatePathIfNotExists</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">FileSystemHandlerBufferSize</span><span style="color: #000000"> { </span><span style="color: #001080">get</span><span style="color: #000000">; </span><span style="color: #001080">set</span><span style="color: #000000">; } = </span><span style="color: #098658">8192</span><span style="color: #000000">;</span></span></code></pre></div><ul><li><p>Each upload handler returns a string text by convention, which usually represents JSON metadata for the upload.</p></li><li><p>This metadata is then assigned to a routine parameter that has <code>UploadMetadata</code> set to true.</p></li><li><p>That routine is executed on PostgreSQL after successful upload (handlers execution).</p></li><li><p>If the routine fails, upload handlers automatically perform upload cleanup.</p></li><li><p>There are currently two upload handlers implemented in the library:</p></li></ul><ol><li>PostgreSQL Large Object Upload Handler</li></ol><ul><li>Key: <code>large_object</code></li><li>Description: uses <a href="https://www.postgresql.org/docs/current/largeobjects.html">PostgreSQL Large Object API</a> to upload content directly to database.</li><li>Metadata example: <code>{"type": "large_object", "fileName": "test.txt", "fileType": "text/plain", "size": 100, "oid": 1234}</code></li></ul><ol start="2"><li>File System Upload Handler</li></ol><ul><li><p>Key: <code>file_system</code></p></li><li><p>Description: Uploads files to the file system</p></li><li><p>Metadata example: <code>{"type": "file_system", "fileName": "test.txt", "fileType": "text/plain", "size": 100, "filePath": "/tmp/uploads/ADF3B177-D0A5-4AA0-8805-FB63F8504ED8.txt"}</code></p></li><li><p>If the endpoint has multiple upload handlers, metadata parameter is expected to be array of text or array of JSON.</p></li><li><p>Example of programmatic usage:</p></li></ul><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">UseNpgsqlRest</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">connectionString</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">DefaultUploadHandlerOptions</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">() { </span><span style="color: #9CDCFE">FileSystemHandlerPath</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"./images/"</span><span style="color: #E6E6E6"> },</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">EndpointCreated</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class="line"><span style="color: #E6E6E6">    {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">endpoint</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Url</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">EndsWith</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"upload"</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">        {</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Upload</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">endpoint</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Url</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Contains</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"image"</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">            {</span></span>
<span class="line"><span style="color: #E6E6E6">                </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">UploadHandlers</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> [</span><span style="color: #CE9178">"file_system"</span><span style="color: #E6E6E6">];</span></span>
<span class="line"><span style="color: #E6E6E6">            }</span></span>
<span class="line"><span style="color: #E6E6E6">            </span><span style="color: #C586C0">else</span><span style="color: #E6E6E6"> </span><span style="color: #C586C0">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">endpoint</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Url</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Contains</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"csv"</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">            {</span></span>
<span class="line"><span style="color: #E6E6E6">                </span><span style="color: #9CDCFE">endpoint</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">UploadHandlers</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> [</span><span style="color: #CE9178">"large_object"</span><span style="color: #E6E6E6">];</span></span>
<span class="line"><span style="color: #E6E6E6">            }</span></span>
<span class="line"><span style="color: #E6E6E6">        }</span></span>
<span class="line"><span style="color: #E6E6E6">    }</span></span>
<span class="line"><span style="color: #E6E6E6">});</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">UseNpgsqlRest</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000">(</span><span style="color: #001080">connectionString</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">DefaultUploadHandlerOptions</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000">() { </span><span style="color: #001080">FileSystemHandlerPath</span><span style="color: #000000"> = </span><span style="color: #A31515">"./images/"</span><span style="color: #000000"> },</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">EndpointCreated</span><span style="color: #000000"> = </span><span style="color: #001080">endpoint</span><span style="color: #000000"> =></span></span>
<span class="line"><span style="color: #000000">    {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">endpoint</span><span style="color: #000000">?.</span><span style="color: #001080">Url</span><span style="color: #000000">.</span><span style="color: #795E26">EndsWith</span><span style="color: #000000">(</span><span style="color: #A31515">"upload"</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">        {</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">Upload</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">endpoint</span><span style="color: #000000">?.</span><span style="color: #001080">Url</span><span style="color: #000000">.</span><span style="color: #795E26">Contains</span><span style="color: #000000">(</span><span style="color: #A31515">"image"</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">            {</span></span>
<span class="line"><span style="color: #000000">                </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">UploadHandlers</span><span style="color: #000000"> = [</span><span style="color: #A31515">"file_system"</span><span style="color: #000000">];</span></span>
<span class="line"><span style="color: #000000">            }</span></span>
<span class="line"><span style="color: #000000">            </span><span style="color: #AF00DB">else</span><span style="color: #000000"> </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">endpoint</span><span style="color: #000000">?.</span><span style="color: #001080">Url</span><span style="color: #000000">.</span><span style="color: #795E26">Contains</span><span style="color: #000000">(</span><span style="color: #A31515">"csv"</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">            {</span></span>
<span class="line"><span style="color: #000000">                </span><span style="color: #001080">endpoint</span><span style="color: #000000">.</span><span style="color: #001080">UploadHandlers</span><span style="color: #000000"> = [</span><span style="color: #A31515">"large_object"</span><span style="color: #000000">];</span></span>
<span class="line"><span style="color: #000000">            }</span></span>
<span class="line"><span style="color: #000000">        }</span></span>
<span class="line"><span style="color: #000000">    }</span></span>
<span class="line"><span style="color: #000000">});</span></span></code></pre></div><ul><li><p>This example will enable upload for all URL paths that end with "upload" text.</p></li><li><p>If the URL path contains "image", it will upload them to file system and to configured <code>./images/</code> path.</p></li><li><p>If the URL path contains "csv", it will be uploaded as the PostgreSQL large object.</p></li><li><p>There is also robust comment annotation support for this feature:</p><ul><li><code>upload</code> - mark routine as upload (uses default handlers)</li><li><code>upload for handler_name1, handler_name2 [, ...]</code> mark routine as upload and set handler key to be used (e.g. <code>upload for file_system</code>).</li><li><code>upload param_name as metadata</code> mark routine as upload (uses default handlers) and sets <code>param_name</code> as metadata parameter.</li><li>Note: mixing these two is not (yet) possible, <code>upload for file_system param_name as metadata</code> or <code>upload param_name as metadata for file_system</code> will not work.</li><li><code>param param_name1 is upload metadata</code> set <code>param_name1</code> as the upload metadata.</li></ul></li><li><p>Examples:</p></li></ul><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span></span>
<span class="line"><span style="color: #E6E6E6">    _meta </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> plpgsql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">begin</span></span>
<span class="line"><span style="color: #E6E6E6">    raise info </span><span style="color: #CE9178">'upload metadata: %'</span><span style="color: #E6E6E6">, _meta;</span></span>
<span class="line"><span style="color: #569CD6">end</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">comment </span><span style="color: #569CD6">on</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span><span style="color: #569CD6">json</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'upload'</span><span style="color: #E6E6E6">; </span><span style="color: #6A9955">-- does not send _meta parameter</span></span>
<span class="line"><span style="color: #6A9955">-- or --</span></span>
<span class="line"><span style="color: #E6E6E6">comment </span><span style="color: #569CD6">on</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span><span style="color: #569CD6">json</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'upload _meta as metadata'</span><span style="color: #E6E6E6"> </span><span style="color: #6A9955">-- sends _meta parameter</span></span>
<span class="line"><span style="color: #6A9955">-- or --</span></span>
<span class="line"><span style="color: #E6E6E6">comment </span><span style="color: #569CD6">on</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span><span style="color: #569CD6">json</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">upload</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">; </span></span>
<span class="line"><span style="color: #6A9955">-- or --</span></span>
<span class="line"><span style="color: #E6E6E6">comment </span><span style="color: #569CD6">on</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span><span style="color: #569CD6">json</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">upload for file_system</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #6A9955">-- or --</span></span>
<span class="line"><span style="color: #E6E6E6">comment </span><span style="color: #569CD6">on</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span><span style="color: #569CD6">json</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">upload for large_object</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span></span>
<span class="line"><span style="color: #000000">    _meta </span><span style="color: #0000FF">json</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> plpgsql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">begin</span></span>
<span class="line"><span style="color: #000000">    raise info </span><span style="color: #A31515">'upload metadata: %'</span><span style="color: #000000">, _meta;</span></span>
<span class="line"><span style="color: #0000FF">end</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">comment </span><span style="color: #0000FF">on</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span><span style="color: #0000FF">json</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #A31515">'upload'</span><span style="color: #000000">; </span><span style="color: #008000">-- does not send _meta parameter</span></span>
<span class="line"><span style="color: #008000">-- or --</span></span>
<span class="line"><span style="color: #000000">comment </span><span style="color: #0000FF">on</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span><span style="color: #0000FF">json</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #A31515">'upload _meta as metadata'</span><span style="color: #000000"> </span><span style="color: #008000">-- sends _meta parameter</span></span>
<span class="line"><span style="color: #008000">-- or --</span></span>
<span class="line"><span style="color: #000000">comment </span><span style="color: #0000FF">on</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span><span style="color: #0000FF">json</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">upload</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">; </span></span>
<span class="line"><span style="color: #008000">-- or --</span></span>
<span class="line"><span style="color: #000000">comment </span><span style="color: #0000FF">on</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span><span style="color: #0000FF">json</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">upload for file_system</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #008000">-- or --</span></span>
<span class="line"><span style="color: #000000">comment </span><span style="color: #0000FF">on</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span><span style="color: #0000FF">json</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">upload for large_object</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span></code></pre></div><ul><li>In case of multiple handlers, parameter has to be an array:</li></ul><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span></span>
<span class="line"><span style="color: #E6E6E6">    _meta[] </span><span style="color: #569CD6">json</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> plpgsql</span></span>
<span class="line"><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">begin</span></span>
<span class="line"><span style="color: #E6E6E6">    raise info </span><span style="color: #CE9178">'upload metadata: %'</span><span style="color: #E6E6E6">, _meta;</span></span>
<span class="line"><span style="color: #569CD6">end</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">-- multiple handlers</span></span>
<span class="line"><span style="color: #E6E6E6">comment </span><span style="color: #569CD6">on</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">procedure</span><span style="color: #E6E6E6"> simple_upload(</span><span style="color: #569CD6">json</span><span style="color: #E6E6E6">) </span><span style="color: #569CD6">is</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'</span></span>
<span class="line"><span style="color: #CE9178">upload for large_object, file_system</span></span>
<span class="line"><span style="color: #CE9178">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #CE9178">'</span><span style="color: #E6E6E6">;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span></span>
<span class="line"><span style="color: #000000">    _meta[] </span><span style="color: #0000FF">json</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> plpgsql</span></span>
<span class="line"><span style="color: #0000FF">as</span><span style="color: #000000"> </span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">begin</span></span>
<span class="line"><span style="color: #000000">    raise info </span><span style="color: #A31515">'upload metadata: %'</span><span style="color: #000000">, _meta;</span></span>
<span class="line"><span style="color: #0000FF">end</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">$$;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">-- multiple handlers</span></span>
<span class="line"><span style="color: #000000">comment </span><span style="color: #0000FF">on</span><span style="color: #000000"> </span><span style="color: #0000FF">procedure</span><span style="color: #000000"> simple_upload(</span><span style="color: #0000FF">json</span><span style="color: #000000">) </span><span style="color: #0000FF">is</span><span style="color: #000000"> </span><span style="color: #A31515">'</span></span>
<span class="line"><span style="color: #A31515">upload for large_object, file_system</span></span>
<span class="line"><span style="color: #A31515">param _meta is upload metadata</span></span>
<span class="line"><span style="color: #A31515">'</span><span style="color: #000000">;</span></span></code></pre></div><h4 id="other-improvements-2">Other Improvements<a class="anchor bookmark-target" href="#other-improvements-2"><i class="bi bi-link-45deg"></i></a></h4><ol><li><p>Fixed issue with endpoint with default parameters. When they receive non-existing parameters in same number as default parameters, the endpoint now returns 404 instead of 200 error as it should be.</p></li><li><p>Fixed serialization of binary data in the response. From now on, endpoints that return either:</p></li></ol><ul><li>single value of type bytea (binary)</li><li>single column of type setof bytea (binary)</li><li>will be written raw directly to response.</li><li>This allows, for example, displaying images directly from the database.</li></ul><h3 id="npgsqlrest-client-app-3">NpgsqlRest Client App<a class="anchor bookmark-target" href="#npgsqlrest-client-app-3"><i class="bi bi-link-45deg"></i></a></h3><h4 id="external-login-fixes-and-improvements">External Login Fixes and Improvements<a class="anchor bookmark-target" href="#external-login-fixes-and-improvements"><i class="bi bi-link-45deg"></i></a></h4><ul><li>External login was fundamentally broken</li></ul><div class="pt-5 border-top"><div id="comments-section" class="h5">Comments</div><script defer src="https://cdn.commento.io/js/commento.js" data-no-fonts="true" data-css-override="https://vb-consulting.github.io/style.css"></script><div id="commento"></div></div><footer class="mt-3 py-5"><div class="w-fit mx-auto mb-3 border-top border-bottom"><div class="alert text-center fs-smaller text-muted"><div class="alert text-center fs-smaller text-muted mb-1">If you like my content, use my software, or otherwise benefit from my work, consider supporting me by buying me a coffee. The software runs on coffee after all.</div><a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="Click Here to Buy Me a Coffee Or Scan the Code" href="https://www.buymeacoffee.com/vbilopavu" style="display: inline-grid;">Buy me a Coffee <img class="m-auto svelte-byttq0" alt="Scan Here To Buy Me a Cofee" src="/bmc_qr.png"></a></div></div><div class="d-flex justify-content-center"><a class="btn rl-arrow me-1" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="changelog.md on GitHub" href="https://github.com/vb-consulting/NpgsqlRest/blob/master/changelog.md" style="display: inline-grid;">changelog.md on GitHub <i class="bi bi-github"></i></a> <a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="I Post Software Development Content Daily" href="https://www.linkedin.com/in/vb-software/" style="display: inline-grid;">Follow me on LinkedIn <i class="bi bi-linkedin"></i></a></div><div class="text-center"><div class="mt-5 mb-5 background-floki svelte-byttq0" data-bs-toggle="tooltip" data-bs-html="true" title="Floki is a developer dog."></div></div></footer></div></div><div class="rightside svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav svelte-9zwk14"><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">on this page</span><hr class="svelte-9zwk14"></li><li class="nav-item toc1 right svelte-9zwk14 bookmark-nav" data-id="changelog" title="Changelog"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#changelog">Changelog</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="version-2280-2025-06-12" title="Version 2.28.0 (2025-06-12)"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#version-2280-2025-06-12">Version 2.28.0 (2025-06-12)</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="core-library" title="Core Library"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#core-library">Core Library</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="improved-error-handling" title="Improved error handling."><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#improved-error-handling">Improved error handling.</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="big-improvements-in-upload-handlers" title="Big Improvements in Upload Handlers"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#big-improvements-in-upload-handlers">Big Improvements in Upload Handlers</a></li><li class="nav-item toc3 mt-2 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-client" title="NpgsqlRest Client"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-client">NpgsqlRest Client</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="added-usecryptographicalgorithms-option-to-dataprotection" title="Added UseCryptographicAlgorithms option to DataProtection"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#added-usecryptographicalgorithms-option-to-dataprotection">Added UseCryptographicAlgorithms option to DataProtection</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="improved-cors-handling" title="Improved CORS Handling"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#improved-cors-handling">Improved CORS Handling</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="excel-upload-handler" title="Excel Upload Handler"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#excel-upload-handler">Excel Upload Handler</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="new-upload-options" title="New Upload Options"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#new-upload-options">New Upload Options</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="version-2270-2025-05-19" title="Version 2.27.0 (2025-05-19)"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#version-2270-2025-05-19">Version 2.27.0 (2025-05-19)</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="authenticationoptions-changes" title="AuthenticationOptions Changes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#authenticationoptions-changes">AuthenticationOptions Changes</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="uploadoptions-changes" title="UploadOptions Changes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#uploadoptions-changes">UploadOptions Changes</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-client-app-static-file-parser" title="NpgsqlRest Client App Static File Parser"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-client-app-static-file-parser">NpgsqlRest Client App Static File Parser</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="comment-annotation-system-changes" title="Comment Annotation System Changes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#comment-annotation-system-changes">Comment Annotation System Changes</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="fixes-and-other-improvements" title="Fixes and Other Improvements"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#fixes-and-other-improvements">Fixes and Other Improvements</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="version-2260-2025-05-11" title="Version 2.26.0 (2025-05-11)"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#version-2260-2025-05-11">Version 2.26.0 (2025-05-11)</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="core-npgsqlrest-library" title="Core NpgsqlRest Library"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#core-npgsqlrest-library">Core NpgsqlRest Library</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="upload-handlers-improvements" title="Upload Handlers Improvements"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#upload-handlers-improvements">Upload Handlers Improvements</a></li><li class="nav-item toc5 right svelte-9zwk14 bookmark-nav" data-id="csv-upload-handler" title="CSV Upload Handler"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#csv-upload-handler">CSV Upload Handler</a></li><li class="nav-item toc5 right svelte-9zwk14 bookmark-nav" data-id="new-upload-parameters" title="New Upload Parameters"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#new-upload-parameters">New Upload Parameters</a></li><li class="nav-item toc4 mt-2 right svelte-9zwk14 bookmark-nav" data-id="new-custom-parameters" title="New Custom Parameters"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#new-custom-parameters">New Custom Parameters</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="improved-error-handling-1" title="Improved Error Handling"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#improved-error-handling-1">Improved Error Handling</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="fixes" title="Fixes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#fixes">Fixes</a></li><li class="nav-item toc3 mt-2 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-client-app" title="NpgsqlRest Client App"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-client-app">NpgsqlRest Client App</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="fixes-1" title="Fixes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#fixes-1">Fixes</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="version-2250-2025-05-06" title="Version 2.25.0 (2025-05-06)"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#version-2250-2025-05-06">Version 2.25.0 (2025-05-06)</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="core-npgsqlrest-library-1" title="Core NpgsqlRest Library"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#core-npgsqlrest-library-1">Core NpgsqlRest Library</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="support-for-custom-parameters" title="Support for Custom Parameters"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#support-for-custom-parameters">Support for Custom Parameters</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="other-improvements" title="Other Improvements"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#other-improvements">Other Improvements</a></li><li class="nav-item toc3 mt-2 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-client-app-1" title="NpgsqlRest Client App"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-client-app-1">NpgsqlRest Client App</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="added-data-protection" title="Added Data Protection"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#added-data-protection">Added Data Protection</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="other-improvements-1" title="Other Improvements"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#other-improvements-1">Other Improvements</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="version-2240-2025-04-29" title="Version 2.24.0 (2025-04-29)"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#version-2240-2025-04-29">Version 2.24.0 (2025-04-29)</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="core-npgsqlrest-library-2" title="Core NpgsqlRest Library"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#core-npgsqlrest-library-2">Core NpgsqlRest Library</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-client-app-2" title="NpgsqlRest Client App"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-client-app-2">NpgsqlRest Client App</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="version-2230-2025-04-28" title="Version 2.23.0 (2025-04-28)"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#version-2230-2025-04-28">Version 2.23.0 (2025-04-28)</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="tsclient-plugin-fixes" title="TsClient Plugin Fixes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#tsclient-plugin-fixes">TsClient Plugin Fixes</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="core-npgsqlrest-library-3" title="Core NpgsqlRest Library"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#core-npgsqlrest-library-3">Core NpgsqlRest Library</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="simplified-endpointcreated-option-event" title="Simplified EndpointCreated Option Event"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#simplified-endpointcreated-option-event">Simplified EndpointCreated Option Event</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="added-path-to-comment-annotation-parser" title="Added PATH to Comment Annotation Parser"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#added-path-to-comment-annotation-parser">Added PATH to Comment Annotation Parser</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="added-securitysensitive-routine-option" title="Added SecuritySensitive Routine Option"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#added-securitysensitive-routine-option">Added SecuritySensitive Routine Option</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="hashing-capabilities" title="Hashing Capabilities"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#hashing-capabilities">Hashing Capabilities</a></li><li class="nav-item toc5 right svelte-9zwk14 bookmark-nav" data-id="mark-parameter-as-hash" title="Mark Parameter as Hash"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#mark-parameter-as-hash">Mark Parameter as Hash</a></li><li class="nav-item toc5 right svelte-9zwk14 bookmark-nav" data-id="login-endpoints-can-verify-hashes" title="Login Endpoints Can Verify Hashes"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#login-endpoints-can-verify-hashes">Login Endpoints Can Verify Hashes</a></li><li class="nav-item toc4 mt-2 right svelte-9zwk14 bookmark-nav" data-id="upload-support" title="Upload Support"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#upload-support">Upload Support</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="other-improvements-2" title="Other Improvements"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#other-improvements-2">Other Improvements</a></li><li class="nav-item toc3 mt-2 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-client-app-3" title="NpgsqlRest Client App"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-client-app-3">NpgsqlRest Client App</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="external-login-fixes-and-improvements" title="External Login Fixes and Improvements"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#external-login-fixes-and-improvements">External Login Fixes and Improvements</a></li></ul></div></div></main><script>!function(){var i=document.querySelector("nav.navbar"),f=document.getElementsByTagName("main")[0],L=f.getElementsByClassName("sidebar")[0],w=f.getElementsByClassName("content")[0],o=document.querySelectorAll("div.code"),k=i.querySelector(".home");function E(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n])}function T(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n]);E(e,t),e.classList.add(t)}function t(e,t){var n=e.currentTarget;if(!n.classList.contains("bi-check")){for(var i="",o=0;o<n.classList.length;o++)if(n.classList[o].startsWith("bi-")){i=n.classList[o];break}n.classList.remove(i),n.classList.add("spinner-border-sm"),n.classList.add("spinner-border");e=bootstrap.Tooltip.getInstance(n);e&&(e.setContent({".tooltip-inner":"Copying..."}),e.show()),t(n,function(){var e;n.classList.remove(i),n.classList.remove("spinner-border-sm"),n.classList.remove("spinner-border"),n.classList.add("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&(e.setContent({".tooltip-inner":"Copied!"}),e.show()),setTimeout(function(){var e;n.classList.add(i),n.classList.remove("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&e.setContent({".tooltip-inner":n.dataset.bsTitle})},2e3)})}}"/"==document.location.pathname&&T(k,"d-none");var e=document.querySelector(".post-share > .copy-url"),n=(e&&e.addEventListener("click",function(e){t(e,function(e,t){navigator.clipboard.writeText(document.location.origin+document.location.pathname),t()})}),document.getElementsByTagName("html")[0]),a=i.querySelector("#theme-btn"),s="theme";function l(e){var t=a.getElementsByTagName("svg");"dark"===e?(t[0].style.display="",t[1].style.display="none",a.getElementsByClassName("check")[0].classList.add("checked")):(t[0].style.display="none",t[1].style.display="",a.getElementsByClassName("check")[0].classList.remove("checked"));for(var n=0;n<o.length;n++){var i=o[n];"dark"===e?(i.children[1].style.display="inherit",i.children[2].style.display="none"):"light"===e&&(i.children[1].style.display="none",i.children[2].style.display="inherit")}window._theme&&window._theme(e)}function r(e){t(e,function(e,t){navigator.clipboard.writeText(e.parentElement.nextSibling.innerText),t()})}function c(e){t(e,function(e,t){var n=localStorage.getItem(s);e="dark"===n?e.parentElement.parentElement.children[1]:e.parentElement.parentElement.children[2],setTimeout(function(){html2canvas(e).then(e=>{e.toBlob(e=>navigator.clipboard.write([new ClipboardItem({"image/png":e})])),t()})},0)})}a.addEventListener("click",()=>{var e="dark"===localStorage.getItem(s)?"light":"dark";localStorage.setItem(s,e),l(n.dataset.bsTheme=e)}),l(localStorage.getItem(s)),a.children[0].classList.remove("hidden");for(var d=0;d<o.length;d++){o[d].getElementsByClassName("copy-code")[0].addEventListener("click",r);var m=o[d].getElementsByClassName("photo-code");m.length&&m[0].addEventListener("click",c)}for(var S=function(){var a,o,s;if(f.children[2]&&"none"!=f.children[2].style.display)return a=f.querySelector(".main-content").querySelectorAll("[id]"),o=void 0,this.initNavs=function(e){s=e.querySelectorAll("li.bookmark-nav");for(var t=0;t<a.length;t++){for(var n=a[t].id,i=null,o=0;o<s.length;o++)if(s[o].dataset.id==n){i=s[o];break}a[t].nav=i}setTimeout(function(){for(var e=0;e<a.length;e++){var t=a[e];if(l(t).visible&&t.nav)return void t.nav.classList.add("active")}},1e3),r()},f.children[1].addEventListener("scroll",r),this;function l(e){var e=e.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight),n=0<e.top&&!(e.bottom<0||0<=e.top-t)||e.top<0&&e.bottom>t,i=!1;return{visible:n,above:i=n?i:e.bottom<t}}function r(){if(s&&s.length){for(var e=0;e<s.length;e++)s[e].classList.remove("active");for(var t=void 0,e=0;e<a.length;e++){const i=a[e];var n=l(i);if(!n.visible&&n.above&&(t=i.nav),n.visible&&i.nav&&!i.nav.classList.contains("active"))return i.nav.classList.add("active"),o&&clearTimeout(o),void(o=setTimeout(function(){i.nav.scrollIntoView({behavior:"smooth"}),o=void 0},250))}t&&!t.classList.contains("active")&&(t.classList.add("active"),o&&clearTimeout(o),o=setTimeout(function(){t.scrollIntoView({behavior:"smooth"}),o=void 0},250))}}}(),h=function(){var l,r=i.querySelector("#nav-btn"),c=480,d="200px",m="0.25fr",h=730,v=535,u=f.children[0].children[0].children[0],g=f.children[2]&&f.children[2].children[0].children[0],t="sidebar-pinned",p=null==localStorage.getItem(t)||"true"==localStorage.getItem(t),y=!1,b=!1;function n(){window._onresize&&window._onresize();var e=window.outerWidth||window.innerWidth,t=e<c,n=t?y?"100%":"0":p?""+d:"0",i=`grid-template-columns: ${n} 1fr`,o=t&&y?"width: 100%":"0"!=n?"":"display: none",a=t&&y?"display: none":"",s=t?y?"sidebar-show":"sidebar-hide":p?"sidebar-show":"sidebar-hide",n="0"==n;f.children[2]&&(m&&h&&v&&(n&&e<v||!n&&e<h?b||(u.innerHTML=l+g.innerHTML,S.initNavs(u),b=!0):b&&(u.innerHTML=l,S.initNavs(g),b=!1)),!m||t||b?(i+=";",f.children[2].style.display="none"):(i+=` ${m};`,f.children[2].style.display="")),T(r,!t&&p||t&&y?"rotate":"rotate-back","rotate","rotate-back"),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),f.style=L?i:"display: grid;",L&&T(L,s,"sidebar-show","sidebar-hide"),L&&(L.firstChild.style=o),w.style=a,t&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),t&&y&&T(k,"d-none")}function e(){var e=window.outerWidth<c;e?y=!y:p=!p,localStorage.setItem(t,p.toString()),n(),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),e&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),e&&y&&T(k,"d-none")}return m&&h&&v&&g&&(l=u.innerHTML,S.initNavs(g)),r.addEventListener("click",e),(window.onresize=n)(),this.closeSidebar=function(){window.outerWidth<c&&y&&e()},this}(),v=document.getElementsByClassName("auto-close"),u=0;u<v.length;u++)v[u].addEventListener("click",function(e){h.closeSidebar()});location.hash&&(e=document.getElementById(location.hash.replace("#","")))&&e.scrollIntoView()}();</script><script src="/bootstrap.bundle.min.js"></script><script>!function(){for(var e=document.querySelectorAll('[data-bs-toggle="tooltip"]'),t=0;t<e.length;t++)new bootstrap.Tooltip(e[t]);var n=document.getElementsByClassName("accordion-item");if(n.length){for(t=0;t<n.length;t++){var o=n[t];o.querySelectorAll("[href='"+document.location.pathname+"']").length&&o.firstChild.click()}var l=document.querySelector("nav.navbar").querySelector(".home"),a=document.getElementsByClassName("accordion");"/"==document.location.pathname&&l.classList.add("d-none");for(t=0;t<n.length;t++){var s=a[t];s&&s.firstChild&&"VB-Consulting"==s.firstChild.title&&(null!=s.firstChild.querySelector(".collapse")&&l.classList.contains("d-none")&&"/"!=document.location.pathname&&l.classList.remove("d-none"),s.addEventListener("show.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none"),l.classList.add("d-none")}),s.addEventListener("hide.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none")}))}}}();</script><script src="/html2canvas.min.js"></script><script async defer src="https://buttons.github.io/buttons.js"></script></body><script async data-id="101435862" src="//static.getclicky.com/js"></script></html>