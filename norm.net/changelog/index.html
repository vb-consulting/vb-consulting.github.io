<!DOCTYPE html><html lang=en><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Norm.net Changelog</title><meta name=description content="Norm.net High Performance Micro-ORM Data Access for .NET"><meta name=keywords content="net, dotnet, c#, csharp, netcore, orm, microorm, database-mapper, mapper, data, sql"><link href=https://vb-consulting.github.io//norm.net/changelog/ rel=canonical><link rel=stylesheet href=/_elderjs/assets/svelte-6dac2da0.css media=all><style></style><link href=/style.css?1698761136345 rel=stylesheet><script>!function(){var e="theme",t=localStorage.getItem(e);t||(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",localStorage.setItem(e,t)),document.getElementsByTagName("html")[0].dataset.bsTheme=t}();</script><body class="d-flex flex-column h-100"><header id=header><nav class="navbar navbar-expand-md navbar-dark fixed-top py-0 py-md-0 svelte-1qdmkpb"><div class="container-fluid flex-nowrap svelte-1qdmkpb"><div class="d-flex svelte-1qdmkpb"><button id=nav-btn type=button class="d-flex btn btn-sm logo animate-rotate svelte-1qdmkpb"><i class=material-icons-outlined>menu</i></button> <a class="my-auto ms-3 svelte-1qdmkpb"href=https://vb-consulting.github.io/ >NORM.NET <span style="display: block;position: absolute;top: 27px;font-size: 9px;color: #b09350;">web under consturction</span></a><div class="vr text-white my-auto svelte-1qdmkpb"></div><a class="my-auto svelte-1qdmkpb"href=https://vb-consulting.github.io/docs/1-introduction/ id=docs><i class="bi bi-file-text"></i> <span class=svelte-1qdmkpb>Docs</span></a> <a class="my-auto ms-3 svelte-1qdmkpb"href=https://vb-consulting.github.io/blog/ id=blog><i class="bi bi-journal-text"></i> <span class=svelte-1qdmkpb>Blog</span></a></div><div class="d-flex right svelte-1qdmkpb"><a class="nav-link my-auto me-2 svelte-1qdmkpb"href=https://github.com/vb-consulting/Norm.net/ ><i class=bi-github></i></a> <a class="github-button svelte-1qdmkpb"href=https://github.com/vb-consulting/Norm.net data-color-scheme="no-preference: light_high_contrast; light: light_high_contrast; dark: light_high_contrast;"data-icon=octicon-star data-show-count=true aria-label="Star vb-consulting/Norm.net on GitHub"></a><div class="vr text-white my-auto svelte-1qdmkpb"></div><button id=theme-btn type=button aria-pressed=true aria-label=theme class=svelte-1qdmkpb><span class="check hidden svelte-1qdmkpb"><span class="icon svelte-1qdmkpb"><svg xmlns=http://www.w3.org/2000/svg width=32 height=32 viewBox="0 0 24 24"class=svelte-1qdmkpb><path fill=currentColor d="M12 21q-3.775 0-6.388-2.613T3 12q0-3.45 2.25-5.988T11 3.05q.625-.075.975.45t-.025 1.1q-.425.65-.638 1.375T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q.775 0 1.538-.225t1.362-.625q.525-.35 1.075-.037t.475.987q-.35 3.45-2.937 5.725T12 21Zm0-2q2.2 0 3.95-1.213t2.55-3.162q-.5.125-1 .2t-1 .075q-3.075 0-5.238-2.163T9.1 7.5q0-.5.075-1t.2-1q-1.95.8-3.163 2.55T5 12q0 2.9 2.05 4.95T12 19Zm-.25-6.75Z"></path></svg> <svg xmlns=http://www.w3.org/2000/svg width=32 height=32 viewBox="0 0 24 24"class=svelte-1qdmkpb><g fill=none stroke-linecap=round stroke-linejoin=round stroke-width=2><path d="M0 0h24v24H0z"></path><path fill=currentColor d="M12 19a1 1 0 0 1 .993.883L13 20v1a1 1 0 0 1-1.993.117L11 21v-1a1 1 0 0 1 1-1zm6.313-2.09l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7a1 1 0 0 1 1.218-1.567l.102.07zm-11.306.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM4 11a1 1 0 0 1 .117 1.993L4 13H3a1 1 0 0 1-.117-1.993L3 11h1zm17 0a1 1 0 0 1 .117 1.993L21 13h-1a1 1 0 0 1-.117-1.993L20 11h1zM6.213 4.81l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7A1 1 0 0 1 6.11 4.74l.102.07zm12.894.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM12 2a1 1 0 0 1 .993.883L13 3v1a1 1 0 0 1-1.993.117L11 4V3a1 1 0 0 1 1-1zm0 5a5 5 0 1 1-4.995 5.217L7 12l.005-.217A5 5 0 0 1 12 7z"></path></g></svg></span></span></button></div></div></nav></header><main class=svelte-1qdmkpb><div class="sidebar sidebar-hide svelte-1qdmkpb"><div class=svelte-1qdmkpb><button type=button class="btn btn-sm close-sidebar svelte-1qdmkpb"style="display: none;"><i class=material-icons-outlined>close</i></button><ul class="navbar-nav sidenav accordion svelte-1qdmkpb"><li class="nav-divider svelte-1qdmkpb"><hr class=svelte-1qdmkpb><li class="nav-item svelte-1qdmkpb active"data-id=""title=changelog><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/changelog/ ><i class="bi bi-archive svelte-1qdmkpb"></i> changelog</a><li class="accordion-item svelte-1qdmkpb"title=docs><button class="accordion-header accordion-button collapsed svelte-1qdmkpb lr-arrow text-uppercase"type=button data-bs-toggle=collapse data-bs-target=#accordion-docs aria-expanded=false aria-controls=accordion-docs><i class="bi bi-file-earmark-text svelte-1qdmkpb"></i> docs</button><div id=accordion-docs class="accordion-collapse collapse svelte-1qdmkpb"><div class="accordion-body svelte-1qdmkpb"><ul class=navbar-nav><li class="nav-txt-divider text-muted svelte-1qdmkpb"><hr class=svelte-1qdmkpb><span class=svelte-1qdmkpb>getting started</span><hr class=svelte-1qdmkpb><li class="nav-item svelte-1qdmkpb"data-id=""title=Introduction><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/getting-started/introduction/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Introduction</a><li class="nav-item svelte-1qdmkpb"data-id=""title=Installation><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/getting-started/installation/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Installation</a><li class="nav-item svelte-1qdmkpb"data-id=""title="First Use"><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/getting-started/first-use/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> First Use</a><li class="nav-item svelte-1qdmkpb"data-id=""title="Basic Concepts"><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/getting-started/basic-concepts/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Basic Concepts</a><li class="nav-txt-divider text-muted svelte-1qdmkpb"><hr class=svelte-1qdmkpb><span class=svelte-1qdmkpb>fundamentals</span><hr class=svelte-1qdmkpb><li class="nav-item svelte-1qdmkpb"data-id=""title="Read Method"><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/fundamentals/read-method/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Read Method</a><li class="nav-item svelte-1qdmkpb"data-id=""title="Non-Generic Read"><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/fundamentals/non-generic-read/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Non-Generic Read</a><li class="nav-item svelte-1qdmkpb"data-id=""title="Read Mappings"><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/fundamentals/read-mappings/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Read Mappings</a><li class="nav-txt-divider text-muted svelte-1qdmkpb"><hr class=svelte-1qdmkpb><span class=svelte-1qdmkpb>reference</span><hr class=svelte-1qdmkpb><li class="nav-item svelte-1qdmkpb"data-id=""title="Extensions Methods"><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/reference/extension-methods/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Extensions Methods</a><li class="nav-item svelte-1qdmkpb"data-id=""title=Options><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/reference/options/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Options</a><li class="nav-item svelte-1qdmkpb"data-id=""title=Parameters><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/norm.net/docs/reference/parameters/ ><i class="bi bi-file-text svelte-1qdmkpb"></i> Parameters</a></ul></div></div><li class="nav-divider svelte-1qdmkpb"><hr class=svelte-1qdmkpb><li class="nav-item svelte-1qdmkpb"data-id=""title=Blog><a class="nav-link svelte-1qdmkpb lr-arrow text-uppercase"href=/blog/ ><i class="bi bi-journal-text svelte-1qdmkpb"></i> Blog</a></ul></div></div><div class="content svelte-1qdmkpb"><div class="container main-content gh-content"><h1 id=changelog>Changelog<a class="anchor bookmark-target"href=#changelog><i class="bi bi-link-45deg"></i></a></h1><a href=https://github.com/vb-consulting/Norm.net/blob/master/changelog.md class=github-edit><i class="bi bi-github"></i>Edit this page on GitHub</a><h2 id=539-2023-10-07><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.9>5.3.9</a> (2023-10-07)<a class="anchor bookmark-target"href=#539-2023-10-07><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.8...5.3.9>Full Changelog</a><p>Fix the issue with mapping protected properties.<p>Setting the global option should also include mapping to protected properties:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">MapPrivateSetters</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">MapPrivateSetters</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">});</span></span></code></pre></div><p>By setting this global option, it was possible to map public properties with protected setter <code>public int ProtectedSetInt { get; protected set; }</code>, but not protected properties <code>protected int ProtectedInt { get; set; }</code>.<p>This inconsistency is fixed with this release.<h2 id=538-2023-09-07><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.8>5.3.8</a> (2023-09-07)<a class="anchor bookmark-target"href=#538-2023-09-07><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.7...5.3.8>Full Changelog</a><p>Support for HSTORE PostgreSQL data type.<p>HSTORE is a key/value data type that is returned as <code>Dictionary&lt;string, string></code> by the Npgsql reader.<p>There was a <a href=https://github.com/vb-consulting/Norm.net/issues/20>mapping issue with HSTORE data type</a> - when mapping to class instances by name that was fixed in this release.<p>This works properly now:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">HstoreTest</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">I</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Dictionary</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">> </span><span style="color: #9CDCFE">J</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line><span style="color: #E6E6E6">        </span></span>
<span class=line><span style="color: #E6E6E6">[</span><span style="color: #4EC9B0">Fact</span><span style="color: #E6E6E6">]</span></span>
<span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">void</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">Hstore_Read_Class_Instance_Sync</span><span style="color: #E6E6E6">()</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlConnection</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">fixture</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">ConnectionString</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Execute</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"create extension if not exists hstore"</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">ReloadTypes</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">HstoreTest</span><span style="color: #E6E6E6">>(</span><span style="color: #9CDCFE">query</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">IsType</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">I</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">IsType</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Dictionary</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>>(</span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">J</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"123"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">J</span><span style="color: #E6E6E6">[</span><span style="color: #CE9178">"foo"</span><span style="color: #E6E6E6">]);</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HstoreTest</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">I</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">Dictionary</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">> </span><span style="color: #001080">J</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line><span style="color: #000000">        </span></span>
<span class=line><span style="color: #000000">[</span><span style="color: #267F99">Fact</span><span style="color: #000000">]</span></span>
<span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">void</span><span style="color: #000000"> </span><span style="color: #795E26">Hstore_Read_Class_Instance_Sync</span><span style="color: #000000">()</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">connection</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlConnection</span><span style="color: #000000">(</span><span style="color: #001080">fixture</span><span style="color: #000000">.</span><span style="color: #001080">ConnectionString</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Execute</span><span style="color: #000000">(</span><span style="color: #A31515">"create extension if not exists hstore"</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">ReloadTypes</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">HstoreTest</span><span style="color: #000000">>(</span><span style="color: #001080">query</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">IsType</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">I</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">IsType</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Dictionary</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>>(</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">J</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"123"</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">J</span><span style="color: #000000">[</span><span style="color: #A31515">"foo"</span><span style="color: #000000">]);</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><p>Also, this release includes some minor performance optimizations too (objects not passed by reference). There will be new performance tests soon.<h2 id=537-2023-07-17><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.7>5.3.7</a> (2023-07-17)<a class="anchor bookmark-target"href=#537-2023-07-17><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.6...5.3.7>Full Changelog</a><h3 id=new-feature-nameparsercallback-option>New feature NameParserCallback option<a class="anchor bookmark-target"href=#new-feature-nameparsercallback-option><i class="bi bi-link-45deg"></i></a></h3><p>This is a new global option that can be set for all <code>Read</code> operations globally via options:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NormOptions</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">/// Set the global name parser to return custom names for columns.</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">/// </span><span style="color: #808080">&lt;/</span><span style="color: #569CD6">summary</span><span style="color: #808080">></span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Func</span><span style="color: #E6E6E6">&lt;(</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">), </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">> </span><span style="color: #9CDCFE">NameParserCallback</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; } </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// ...</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">NormOptions</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">/// </span><span style="color: #800000">&lt;summary></span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">/// Set the global name parser to return custom names for columns.</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">/// </span><span style="color: #800000">&lt;/summary></span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">Func</span><span style="color: #000000">&lt;(</span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Name</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">Ordinal</span><span style="color: #000000">), </span><span style="color: #0000FF">string</span><span style="color: #000000">> </span><span style="color: #001080">NameParserCallback</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; } = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">// ...</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><p>This callback is invoked once per query for every column when column names are retrieved before any mapping.<p>It is very useful in situations where you need to map column names to a different format, or in general to be able to map to different names.<p>Input parameter is a tuple with the column name (as it is retrieved from database connection) and ordinal position. Use return value to set the name for the column.<p>For example, if you want to remove a prefix (<code>prefix_</code> for example) string from all column names where it appears, you can do it like this:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #6A9955">// Program startup</span></span>
<span class=line><span style="color: #6A9955">//</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">o</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">o</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">NameParserCallback</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">StartsWith</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"prefix_"</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">[</span><span style="color: #F44747">7..</span><span style="color: #E6E6E6">] </span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #6A9955">// In your code, when mapping by name, target class doesn't require prefix "prefix_" in property name</span></span>
<span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #569CD6">private</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NameParserTest</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">Foo</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">Bar</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">// Read to single result:</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">NameParserTest</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select * from name_parser_test"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #008000">// Program startup</span></span>
<span class=line><span style="color: #008000">//</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">o</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">o</span><span style="color: #000000">.</span><span style="color: #001080">NameParserCallback</span><span style="color: #000000"> = </span><span style="color: #001080">arg</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">.</span><span style="color: #795E26">StartsWith</span><span style="color: #000000">(</span><span style="color: #A31515">"prefix_"</span><span style="color: #000000">) ? </span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">[</span><span style="color: #CD3131">7..</span><span style="color: #000000">] : </span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">});</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #008000">// In your code, when mapping by name, target class doesn't require prefix "prefix_" in property name</span></span>
<span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">NameParserTest</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">Foo</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">Bar</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">// Read to single result:</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">NameParserTest</span><span style="color: #000000">>(</span><span style="color: #A31515">"select * from name_parser_test"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span></code></pre></div><p>Since this callback, if defined, is executed once per query it doesn't have any impact on mapping performances.<h3 id=more-internal-optimizations>More internal optimizations<a class="anchor bookmark-target"href=#more-internal-optimizations><i class="bi bi-link-45deg"></i></a></h3><p>There were two missed optimization opportunities in the code that were fixed in this release:<ul><li>Passing some structures by references instead of values.<li>Retrieving column names from the reader once per query instead of once per row.</ul><p>These optimizations aren't significant and are hardly noticeable, but they required a completely new set of performance tests. See <a href=https://github.com/vb-consulting/Norm.net/blob/5.3.4/performance-tests.md>performance test results here.</a><p>To facilitate easier performance testing, there is a <a href=https://github.com/vb-consulting/Norm.net/blob/master/Benchmarks/Dockerfile>docker file</a> that can be used to run performance tests in a docker environment.<h3 id=changed-access-modifiers-for-internal-mappers>Changed access modifiers for internal mappers<a class="anchor bookmark-target"href=#changed-access-modifiers-for-internal-mappers><i class="bi bi-link-45deg"></i></a></h3><p>Previously public parts of internal mappers that were marked as <code>public</code> are now <code>internal</code>.<h2 id=536-2023-07-02><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.6>5.3.6</a> (2023-07-02)<a class="anchor bookmark-target"href=#536-2023-07-02><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.5...5.3.6>Full Changelog</a><h3 id=global-handler-for-reader-callback>Global handler for reader callback<a class="anchor bookmark-target"href=#global-handler-for-reader-callback><i class="bi bi-link-45deg"></i></a></h3><p>Added global handler that can be set for all Read operations globally via options:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">DbReaderCallback</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6"> </span><span style="color: #C586C0">switch</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetInt32</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">,  </span><span style="color: #6A9955">// add 1 to the first field with ordinal 0, mapped to the first tuple named "a"</span></span>
<span class=line><span style="color: #E6E6E6">        _ </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">                       </span><span style="color: #6A9955">// for all other fields, use the default mapping</span></span>
<span class=line><span style="color: #E6E6E6">    });</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">DbReaderCallback</span><span style="color: #000000"> = </span><span style="color: #001080">r</span><span style="color: #000000"> => </span><span style="color: #001080">r</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000"> </span><span style="color: #AF00DB">switch</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #098658">0</span><span style="color: #000000"> => </span><span style="color: #001080">r</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetInt32</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">) + </span><span style="color: #098658">1</span><span style="color: #000000">,  </span><span style="color: #008000">// add 1 to the first field with ordinal 0, mapped to the first tuple named "a"</span></span>
<span class=line><span style="color: #000000">        _ => </span><span style="color: #0000FF">null</span><span style="color: #000000">                       </span><span style="color: #008000">// for all other fields, use the default mapping</span></span>
<span class=line><span style="color: #000000">    });</span></span>
<span class=line><span style="color: #000000">});</span></span></code></pre></div><p>This would be equivalent to executing every Read operation with the <code>WithReaderCallback</code> method like this:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">array</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithReaderCallback</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6"> </span><span style="color: #C586C0">switch</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetInt32</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">,  </span><span style="color: #6A9955">// add 1 to the first field with ordinal 0, mapped to the first tuple named "a"</span></span>
<span class=line><span style="color: #E6E6E6">        _ </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">                       </span><span style="color: #6A9955">// for all other fields, use the default mapping</span></span>
<span class=line><span style="color: #E6E6E6">    })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;(</span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">c</span><span style="color: #E6E6E6">)>(</span><span style="color: #CE9178">"select * from (values (1, 1, 1), (2, 2, 2), (3, 3, 3)) t(a, b, c)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">ToArray</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">array</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithReaderCallback</span><span style="color: #000000">(</span><span style="color: #001080">r</span><span style="color: #000000"> => </span><span style="color: #001080">r</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000"> </span><span style="color: #AF00DB">switch</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #098658">0</span><span style="color: #000000"> => </span><span style="color: #001080">r</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetInt32</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">) + </span><span style="color: #098658">1</span><span style="color: #000000">,  </span><span style="color: #008000">// add 1 to the first field with ordinal 0, mapped to the first tuple named "a"</span></span>
<span class=line><span style="color: #000000">        _ => </span><span style="color: #0000FF">null</span><span style="color: #000000">                       </span><span style="color: #008000">// for all other fields, use the default mapping</span></span>
<span class=line><span style="color: #000000">    })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;(</span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">a</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">c</span><span style="color: #000000">)>(</span><span style="color: #A31515">"select * from (values (1, 1, 1), (2, 2, 2), (3, 3, 3)) t(a, b, c)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">ToArray</span><span style="color: #000000">();</span></span></code></pre></div><blockquote><p>Important: reader callback can be set only once per read operation and that includes global reader callbacks.</blockquote><p>If you set global reader callback and another reader callback with <code>WithReaderCallback</code> - a <code>NormReaderAlreadyAssignedException</code> exception will be thrown.<ul><li>You can assign reader callbacks from private methods, for example:</ul><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">private</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">object</span><span style="color: #E6E6E6">? </span><span style="color: #DCDCAA">ReaderCallback</span><span style="color: #E6E6E6">((</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DbDataReader</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">) </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetDataTypeName</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">) </span><span style="color: #C586C0">switch</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #CE9178">"json"</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">JsonNode</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Parse</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetString</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">))</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">AsObject</span><span style="color: #E6E6E6">(),</span></span>
<span class=line><span style="color: #E6E6E6">    _ </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class=line><span style="color: #E6E6E6">};</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #6A9955">// in your startup</span></span>
<span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">o</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">o</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">DbReaderCallback</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ReaderCallback</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">object</span><span style="color: #000000">? </span><span style="color: #795E26">ReaderCallback</span><span style="color: #000000">((</span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Name</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">Ordinal</span><span style="color: #000000">, </span><span style="color: #267F99">DbDataReader</span><span style="color: #000000"> </span><span style="color: #001080">Reader</span><span style="color: #000000">) </span><span style="color: #001080">arg</span><span style="color: #000000">) => </span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetDataTypeName</span><span style="color: #000000">(</span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000">) </span><span style="color: #AF00DB">switch</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #A31515">"json"</span><span style="color: #000000"> => </span><span style="color: #001080">JsonNode</span><span style="color: #000000">.</span><span style="color: #795E26">Parse</span><span style="color: #000000">(</span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetString</span><span style="color: #000000">(</span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000">))?.</span><span style="color: #795E26">AsObject</span><span style="color: #000000">(),</span></span>
<span class=line><span style="color: #000000">    _ => </span><span style="color: #0000FF">null</span></span>
<span class=line><span style="color: #000000">};</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #008000">// in your startup</span></span>
<span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">o</span><span style="color: #000000"> => </span><span style="color: #001080">o</span><span style="color: #000000">.</span><span style="color: #001080">DbReaderCallback</span><span style="color: #000000"> = </span><span style="color: #001080">ReaderCallback</span><span style="color: #000000">);</span></span></code></pre></div><p>The example above of the global reader handler shows how to implement a custom type mapping in your application: If the record type is <code>json</code> it will be automatically parsed to <code>JsonObject</code> object.<p>Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">private</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">object</span><span style="color: #E6E6E6">? </span><span style="color: #DCDCAA">ReaderCallback</span><span style="color: #E6E6E6">((</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DbDataReader</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">) </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetDataTypeName</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">) </span><span style="color: #C586C0">switch</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #CE9178">"json"</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">JsonNode</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Parse</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetString</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">arg</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6">))</span><span style="color: #D4D4D4">?</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">AsObject</span><span style="color: #E6E6E6">(),</span></span>
<span class=line><span style="color: #E6E6E6">    _ </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span></span>
<span class=line><span style="color: #E6E6E6">};</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #6A9955">// in your startup</span></span>
<span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">o</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">o</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">DbReaderCallback</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ReaderCallback</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">private</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">JsonTest</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">I</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">JsonObject</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">J</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">// all `json` types are automatically converted to `JsonObject` object</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">instance</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">JsonTest</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select '{</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">a</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">: 1}'::text as i, '{</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">a</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">: 1}'::json as j"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">object</span><span style="color: #000000">? </span><span style="color: #795E26">ReaderCallback</span><span style="color: #000000">((</span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Name</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">Ordinal</span><span style="color: #000000">, </span><span style="color: #267F99">DbDataReader</span><span style="color: #000000"> </span><span style="color: #001080">Reader</span><span style="color: #000000">) </span><span style="color: #001080">arg</span><span style="color: #000000">) => </span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetDataTypeName</span><span style="color: #000000">(</span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000">) </span><span style="color: #AF00DB">switch</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #A31515">"json"</span><span style="color: #000000"> => </span><span style="color: #001080">JsonNode</span><span style="color: #000000">.</span><span style="color: #795E26">Parse</span><span style="color: #000000">(</span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetString</span><span style="color: #000000">(</span><span style="color: #001080">arg</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000">))?.</span><span style="color: #795E26">AsObject</span><span style="color: #000000">(),</span></span>
<span class=line><span style="color: #000000">    _ => </span><span style="color: #0000FF">null</span></span>
<span class=line><span style="color: #000000">};</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #008000">// in your startup</span></span>
<span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">o</span><span style="color: #000000"> => </span><span style="color: #001080">o</span><span style="color: #000000">.</span><span style="color: #001080">DbReaderCallback</span><span style="color: #000000"> = </span><span style="color: #001080">ReaderCallback</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">JsonTest</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">I</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">JsonObject</span><span style="color: #000000"> </span><span style="color: #001080">J</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">// all `json` types are automatically converted to `JsonObject` object</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">instance</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">JsonTest</span><span style="color: #000000">>(</span><span style="color: #A31515">"select '{</span><span style="color: #EE0000">\"</span><span style="color: #A31515">a</span><span style="color: #EE0000">\"</span><span style="color: #A31515">: 1}'::text as i, '{</span><span style="color: #EE0000">\"</span><span style="color: #A31515">a</span><span style="color: #EE0000">\"</span><span style="color: #A31515">: 1}'::json as j"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span></code></pre></div><h2 id=535-2023-07-01><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.5>5.3.5</a> (2023-07-01)<a class="anchor bookmark-target"href=#535-2023-07-01><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.4...5.3.5>Full Changelog</a><p>When using the method for mapping anonymous instances based on instance prototype, e.g.:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> {</span><span style="color: #9CDCFE">id</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">), </span><span style="color: #9CDCFE">name</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)}, </span><span style="color: #6A9955">// anonymous instance prototype</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"select 1 as id, 'foo' as name"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Id</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"foo"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result1</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">new</span><span style="color: #000000"> {</span><span style="color: #001080">id</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #0000FF">int</span><span style="color: #000000">), </span><span style="color: #001080">name</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #0000FF">string</span><span style="color: #000000">)}, </span><span style="color: #008000">// anonymous instance prototype</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"select 1 as id, 'foo' as name"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">, </span><span style="color: #001080">result1</span><span style="color: #000000">.</span><span style="color: #001080">Id</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"foo"</span><span style="color: #000000">, </span><span style="color: #001080">result1</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">);</span></span></code></pre></div><p>From version <code>5.3.5</code> you can use a normal instance as a prototype, e.g.:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Class1</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Id</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">instance1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Class1</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">instance1</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"select 1 as id, 'foo' as name"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Id</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"foo"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Class1</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">Id</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Name</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">instance1</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Class1</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result1</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #001080">instance1</span><span style="color: #000000">, </span><span style="color: #A31515">"select 1 as id, 'foo' as name"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">, </span><span style="color: #001080">result1</span><span style="color: #000000">.</span><span style="color: #001080">Id</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"foo"</span><span style="color: #000000">, </span><span style="color: #001080">result1</span><span style="color: #000000">.</span><span style="color: #001080">Name</span><span style="color: #000000">);</span></span></code></pre></div><p>When the mapper encounters an instance that is not anonymous, it will use the standard method of mapping instances.<h2 id=534-2023-05-26><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.4>5.3.4</a> (2023-05-26)<a class="anchor bookmark-target"href=#534-2023-05-26><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.3...5.3.4>Full Changelog</a><h3 id=new-option---keeporiginalnames>New option - KeepOriginalNames<a class="anchor bookmark-target"href=#new-option---keeporiginalnames><i class="bi bi-link-45deg"></i></a></h3><p>When matching by name, the default behavior is to strip all database names of underscores and @ at characters.<p>This is done to make it easier to map underscore-separated names to C# properties (<code>field_name</code> to <code>FieldName</code> for example).<p>Set this option to true to skip this behavior and keep the original names.<p>Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #6A9955">// in your startup</span></span>
<span class=line><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">KeepOriginalNames</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">...</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">FooBarClass</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">Foo_Bar</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">FooBar</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">...</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">FooBarClass</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select 'foobar' as foo_bar"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"foobar"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Foo_Bar</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Null</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">FooBar</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #008000">// in your startup</span></span>
<span class=line><span style="color: #008000">//</span></span>
<span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">KeepOriginalNames</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">});</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">...</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">FooBarClass</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">Foo_Bar</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">FooBar</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">...</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">FooBarClass</span><span style="color: #000000">>(</span><span style="color: #A31515">"select 'foobar' as foo_bar"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"foobar"</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">Foo_Bar</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Null</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">FooBar</span><span style="color: #000000">);</span></span></code></pre></div><h3 id=new-optimization-and-new-performance-tests>New optimization and new performance tests<a class="anchor bookmark-target"href=#new-optimization-and-new-performance-tests><i class="bi bi-link-45deg"></i></a></h3><p>Some missed performance optimizations were added in this version. See the <a href=https://github.com/vb-consulting/Norm.net/compare/5.3.3...5.3.4>changelog</a> for more details.<p>Also, see <a href=https://github.com/vb-consulting/Norm.net/blob/5.3.4/performance-tests.md>performance tests results</a>.<h2 id=533-2023-05-16><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.3>5.3.3</a> (2023-05-16)<a class="anchor bookmark-target"href=#533-2023-05-16><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.2...5.3.3>Full Changelog</a><h3 id=fix---nullableinstances-option-turned-on-but-have-non-nullable-properties>Fix - NullableInstances option turned on but have non-nullable properties<a class="anchor bookmark-target"href=#fix---nullableinstances-option-turned-on-but-have-non-nullable-properties><i class="bi bi-link-45deg"></i></a></h3><ul><li><p>In previous version a new feature - when <code>NullableInstances</code> option is turned on, the mapper will return <code>null</code> instances if all mapped values are <code>null</code>.<li><p>However, there was a edge-case bug in this implementation: Mapper tried first to assign a <code>null</code> value to instance, and if the property being mapped is not nullable - mapper would crash.<li><p>This is now fixed in this version - if all mapped values are null, and <code>NullableInstances</code> option is on - return instance will be null, regardless of property types.</ul><h3 id=new-feature---normnullexception>New feature - NormNullException<a class="anchor bookmark-target"href=#new-feature---normnullexception><i class="bi bi-link-45deg"></i></a></h3><ul><li>Attempted mapping of database null value to a non-nullable property will now throw <code>NormNullException</code> exception with nice message, for example: <code>Can't map null value for database field "foo" to non-nullable property "Foo".</code>.</ul><h2 id=532-2023-05-03><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.2>5.3.2</a> (2023-05-03)<a class="anchor bookmark-target"href=#532-2023-05-03><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.1...5.3.2>Full Changelog</a><h3 id=new-feature---nullableinstances>New Feature - NullableInstances<a class="anchor bookmark-target"href=#new-feature---nullableinstances><i class="bi bi-link-45deg"></i></a></h3><ul><li><p>There is a new option <code>NullableInstances</code> that can be used to control whether to return <code>null</code> instances or not.<li><p>When this option is set to <code>true</code>, the mapper will return <code>null</code> instances for all classes that have all properties set to <code>null</code>.<li><p>The default is <code>false</code> which is the same behavior as before (no changes).<li><p>Example:</ul><ol><li>Set this option switch to true in your program startup:</ol><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">NullableInstances</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">NullableInstances</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">});</span></span></code></pre></div><ol start=2><li>When all mapped property values are <code>NULL</code>, instance will be null as well:</ol><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">TestClass</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">Foo</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">? </span><span style="color: #9CDCFE">Bar</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    }</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">TestClass</span><span style="color: #E6E6E6">?>(</span><span style="color: #CE9178">"select NULL as foo, NULL as bar"</span><span style="color: #E6E6E6">).</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #E6E6E6">    </span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// result is null since all properties are null</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Null</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">TestClass</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000">? </span><span style="color: #001080">Foo</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000">? </span><span style="color: #001080">Bar</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    }</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">TestClass</span><span style="color: #000000">?>(</span><span style="color: #A31515">"select NULL as foo, NULL as bar"</span><span style="color: #000000">).</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #000000">    </span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">// result is null since all properties are null</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Null</span><span style="color: #000000">(</span><span style="color: #001080">result</span><span style="color: #000000">);</span></span></code></pre></div><p>This is can be useful when doing left joins and you want to know if join is matched. Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">asset</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">vehicle</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">ReadAsync</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Asset</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">Vehicle</span><span style="color: #E6E6E6">?>(</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"""</span></span>
<span class=line><span style="color: #CE9178">        select a.*, v.</span><span style="color: #F44747">*</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">from</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">assets</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">a</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">left</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">join</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">vehicles</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">v</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">on</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">id</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">v</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">id</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"""</span></span>
<span class=line><span style="color: #CE9178">    </span><span style="color: #F44747">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #E6E6E6">    </span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #DCDCAA">if</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">vehicle</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">is</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">null</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// no matching vehicle</span></span>
<span class=line><span style="color: #E6E6E6">    }</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">asset</span><span style="color: #000000">, </span><span style="color: #001080">vehicle</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">ReadAsync</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Asset</span><span style="color: #000000">, </span><span style="color: #267F99">Vehicle</span><span style="color: #000000">?>(</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"""</span></span>
<span class=line><span style="color: #A31515">        select a.*, v.</span><span style="color: #CD3131">*</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">from</span><span style="color: #000000"> </span><span style="color: #001080">assets</span><span style="color: #000000"> </span><span style="color: #001080">a</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">left</span><span style="color: #000000"> </span><span style="color: #001080">join</span><span style="color: #000000"> </span><span style="color: #001080">vehicles</span><span style="color: #000000"> </span><span style="color: #001080">v</span><span style="color: #000000"> </span><span style="color: #001080">on</span><span style="color: #000000"> </span><span style="color: #001080">a</span><span style="color: #000000">.</span><span style="color: #001080">id</span><span style="color: #000000"> = </span><span style="color: #001080">v</span><span style="color: #000000">.</span><span style="color: #001080">id</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"""</span></span>
<span class=line><span style="color: #A31515">    </span><span style="color: #CD3131">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #000000">    </span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #795E26">if</span><span style="color: #000000"> (</span><span style="color: #001080">vehicle</span><span style="color: #000000"> </span><span style="color: #267F99">is</span><span style="color: #000000"> </span><span style="color: #001080">null</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// no matching vehicle</span></span>
<span class=line><span style="color: #000000">    }</span></span></code></pre></div><h3 id=improvements>Improvements<a class="anchor bookmark-target"href=#improvements><i class="bi bi-link-45deg"></i></a></h3><ul><li>All tests with SqlServer are now using Microsoft.Data.SqlClient instead of System.Data.SqlClient.</ul><h2 id=531-2022-11-18><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.1>5.3.1</a> (2022-11-18)<a class="anchor bookmark-target"href=#531-2022-11-18><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.3.0...5.3.1>Full Changelog</a><p>Minor optimizations and improvements.<h2 id=530-2022-10-16><a href=https://github.com/vb-consulting/Norm.net/tree/5.3.0>5.3.0</a> (2022-10-16)<a class="anchor bookmark-target"href=#530-2022-10-16><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.2.5...5.3.0>Full Changelog</a><h3 id=new-feature---dynamic-mapping-support>New feature - dynamic mapping support<a class="anchor bookmark-target"href=#new-feature---dynamic-mapping-support><i class="bi bi-link-45deg"></i></a></h3><p>For this version <code>5.3.0</code> it is possible to map objects to a dynamic class.<p>Simply, instead of class or record name - use <code>dynamic</code> and the mapper will return a dynamic instance of <code>ExpandoObjects</code> objects:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">dynamic</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"select *</span></span>
<span class=line><span style="color: #CE9178">                from (</span></span>
<span class=line><span style="color: #CE9178">                values </span></span>
<span class=line><span style="color: #CE9178">                    (1, 'foo1', '1977-05-19'::date, true, null),</span></span>
<span class=line><span style="color: #CE9178">                    (2, 'foo2', '1978-05-19'::date, false, 'bar2'),</span></span>
<span class=line><span style="color: #CE9178">                    (3, 'foo3', '1979-05-19'::date, null, 'bar3')</span></span>
<span class=line><span style="color: #CE9178">                ) t(id, foo, day, bool, foo_bar)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">ToList</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">3</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Count</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">id</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">id</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">3</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">id</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"foo1"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"foo2"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"foo3"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">[</span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">].</span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">dynamic</span><span style="color: #000000">>(</span><span style="color: #A31515">@"select *</span></span>
<span class=line><span style="color: #A31515">                from (</span></span>
<span class=line><span style="color: #A31515">                values </span></span>
<span class=line><span style="color: #A31515">                    (1, 'foo1', '1977-05-19'::date, true, null),</span></span>
<span class=line><span style="color: #A31515">                    (2, 'foo2', '1978-05-19'::date, false, 'bar2'),</span></span>
<span class=line><span style="color: #A31515">                    (3, 'foo3', '1979-05-19'::date, null, 'bar3')</span></span>
<span class=line><span style="color: #A31515">                ) t(id, foo, day, bool, foo_bar)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">ToList</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">3</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">Count</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">[</span><span style="color: #098658">0</span><span style="color: #000000">].</span><span style="color: #001080">id</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">2</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">[</span><span style="color: #098658">1</span><span style="color: #000000">].</span><span style="color: #001080">id</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">3</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">[</span><span style="color: #098658">2</span><span style="color: #000000">].</span><span style="color: #001080">id</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"foo1"</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">[</span><span style="color: #098658">0</span><span style="color: #000000">].</span><span style="color: #001080">foo</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"foo2"</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">[</span><span style="color: #098658">1</span><span style="color: #000000">].</span><span style="color: #001080">foo</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"foo3"</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">[</span><span style="color: #098658">2</span><span style="color: #000000">].</span><span style="color: #001080">foo</span><span style="color: #000000">);</span></span></code></pre></div><p>Note that <code>ExpandoObjects</code> are a bit slow and you will lose on auto-complete features as well as static typing.<p><code>dynamic</code> can also be mixed with mapping to normal classes, for example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Class1</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">dynamic</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"select *</span></span>
<span class=line><span style="color: #CE9178">                from (</span></span>
<span class=line><span style="color: #CE9178">                values </span></span>
<span class=line><span style="color: #CE9178">                    (1, 'foo1', '1977-05-19'::date, true, null),</span></span>
<span class=line><span style="color: #CE9178">                    (2, 'foo2', '1978-05-19'::date, false, 'bar2'),</span></span>
<span class=line><span style="color: #CE9178">                    (3, 'foo3', '1979-05-19'::date, null, 'bar3')</span></span>
<span class=line><span style="color: #CE9178">                ) t(id, foo, day, bool, foo_bar)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">ToList</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Class1</span><span style="color: #000000">, </span><span style="color: #0000FF">dynamic</span><span style="color: #000000">>(</span><span style="color: #A31515">@"select *</span></span>
<span class=line><span style="color: #A31515">                from (</span></span>
<span class=line><span style="color: #A31515">                values </span></span>
<span class=line><span style="color: #A31515">                    (1, 'foo1', '1977-05-19'::date, true, null),</span></span>
<span class=line><span style="color: #A31515">                    (2, 'foo2', '1978-05-19'::date, false, 'bar2'),</span></span>
<span class=line><span style="color: #A31515">                    (3, 'foo3', '1979-05-19'::date, null, 'bar3')</span></span>
<span class=line><span style="color: #A31515">                ) t(id, foo, day, bool, foo_bar)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">ToList</span><span style="color: #000000">();</span></span></code></pre></div><p>In this example, whatever is not mapped to <code>Class1</code> will be mapped to a dynamic type.<p>See examples in <a href=https://github.com/vb-consulting/Norm.net/blob/5.3.0/Tests/PostgreSqlUnitTests/DynamicMapUnitTests.cs>this unit tests</a>.<h3 id=fix---duplicate-field-names-in-multi-mapping>Fix - duplicate field names in multi mapping<a class="anchor bookmark-target"href=#fix---duplicate-field-names-in-multi-mapping><i class="bi bi-link-45deg"></i></a></h3><p>Some queries can return duplicate field names.<p>For example, if we have these multiple mappings:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Shop</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Id</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">IList</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Account</span><span style="color: #E6E6E6">> </span><span style="color: #9CDCFE">Accounts</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Account</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Id</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Name</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Address</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Country</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ShopId</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Shop</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">Shop</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">//...</span></span>
<span class=line><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Shop</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">Account</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"</span></span>
<span class=line><span style="color: #CE9178">        select s.*, a.*</span></span>
<span class=line><span style="color: #CE9178">        from shop s </span></span>
<span class=line><span style="color: #CE9178">        inner join account a on s.id = a.shop_id"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #6A9955">//...</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Shop</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">Id</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Name</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">IList</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Account</span><span style="color: #000000">> </span><span style="color: #001080">Accounts</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Account</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">Id</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Name</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Address</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">string</span><span style="color: #000000"> </span><span style="color: #001080">Country</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">ShopId</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #267F99">Shop</span><span style="color: #000000"> </span><span style="color: #001080">Shop</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">//...</span></span>
<span class=line><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Shop</span><span style="color: #000000">, </span><span style="color: #267F99">Account</span><span style="color: #000000">>(</span><span style="color: #A31515">@"</span></span>
<span class=line><span style="color: #A31515">        select s.*, a.*</span></span>
<span class=line><span style="color: #A31515">        from shop s </span></span>
<span class=line><span style="color: #A31515">        inner join account a on s.id = a.shop_id"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #008000">//...</span></span></code></pre></div><p>This query returns duplicate names (<code>id</code> and <code>name</code>):<table class="table table-hover table-sm table-responsive-sm"><thead><tr><th><strong>id</strong><th><strong>name</strong><th><strong>id</strong><th><strong>name</strong><th>address<th>country<th>shop_id<tbody class=table-group-divider><tr><td>1<td>shop1<td>3<td>account3<td>addr3<td>country3<td>1<tr><td>1<td>shop1<td>2<td>account2<td>addr2<td>country2<td>1<tr><td>1<td>shop1<td>1<td>account1<td>addr1<td>country1<td>1<tr><td>2<td>shop2<td>5<td>account5<td>addr5<td>country5<td>2<tr><td>2<td>shop2<td>4<td>account4<td>addr4<td>country4<td>2</table><p>In previous versions, duplicate names were not handled correctly. In this example, only <code>Id</code> and <code>Name</code> from <code>Shop</code> class would be mapped correctly and the <code>Id</code> and <code>Name</code> from <code>Account</code> class would be skipped because the mapper would incorrectly conclude that those fields were already mapped.<p>In this version, this is fixed and classes <code>Shop</code> and <code>Account</code> are mapped correctly.<p>This makes it easier to build nested object maps with the <code>Linq</code> expressions for example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">shops</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Shop</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">Account</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"</span></span>
<span class=line><span style="color: #CE9178">    select s.*, a.*</span></span>
<span class=line><span style="color: #CE9178">    from shop s </span></span>
<span class=line><span style="color: #CE9178">    inner join account a on s.id = a.shop_id"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">GroupBy</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">item</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">item</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Item1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Id</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Select</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">group</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">shop</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">group</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">First</span><span style="color: #E6E6E6">().</span><span style="color: #9CDCFE">Item1</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">shop</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Accounts</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">group</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Select</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">item</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">        {</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">account</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">item</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Item2</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">account</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Shop</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">shop</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #C586C0">return</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">account</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">        }).</span><span style="color: #DCDCAA">ToList</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #C586C0">return</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">shop</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">ToList</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">shops</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Shop</span><span style="color: #000000">, </span><span style="color: #267F99">Account</span><span style="color: #000000">>(</span><span style="color: #A31515">@"</span></span>
<span class=line><span style="color: #A31515">    select s.*, a.*</span></span>
<span class=line><span style="color: #A31515">    from shop s </span></span>
<span class=line><span style="color: #A31515">    inner join account a on s.id = a.shop_id"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">GroupBy</span><span style="color: #000000">(</span><span style="color: #001080">item</span><span style="color: #000000"> => </span><span style="color: #001080">item</span><span style="color: #000000">.</span><span style="color: #001080">Item1</span><span style="color: #000000">.</span><span style="color: #001080">Id</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Select</span><span style="color: #000000">(</span><span style="color: #001080">group</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">shop</span><span style="color: #000000"> = </span><span style="color: #001080">group</span><span style="color: #000000">.</span><span style="color: #795E26">First</span><span style="color: #000000">().</span><span style="color: #001080">Item1</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">shop</span><span style="color: #000000">.</span><span style="color: #001080">Accounts</span><span style="color: #000000"> = </span><span style="color: #001080">group</span><span style="color: #000000">.</span><span style="color: #795E26">Select</span><span style="color: #000000">(</span><span style="color: #001080">item</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">        {</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">account</span><span style="color: #000000"> = </span><span style="color: #001080">item</span><span style="color: #000000">.</span><span style="color: #001080">Item2</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">account</span><span style="color: #000000">.</span><span style="color: #001080">Shop</span><span style="color: #000000"> = </span><span style="color: #001080">shop</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">account</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">        }).</span><span style="color: #795E26">ToList</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">shop</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">ToList</span><span style="color: #000000">();</span></span></code></pre></div><p>This will build a nested object tree where each shop contains a list of accounts and that every account has a reference to a shop instance, and so on.<p>See the example in <a href=https://github.com/vb-consulting/Norm.net/blob/5.3.0/Tests/PostgreSqlUnitTests/NestedObjectMapUnitTests.cs>this unit tests</a>.<h3 id=new-benchmarks>New benchmarks<a class="anchor bookmark-target"href=#new-benchmarks><i class="bi bi-link-45deg"></i></a></h3><p>Since the mapper code was changed, there are also new benchmarks for this version: <a href=https://github.com/vb-consulting/Norm.net/blob/5.3.0/PERFOMANCE-TESTS.md>PERFOMANCE-TESTS</a><h2 id=525-2022-10-06><a href=https://github.com/vb-consulting/Norm.net/tree/5.2.5>5.2.5</a> (2022-10-06)<a class="anchor bookmark-target"href=#525-2022-10-06><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.2.4...5.2.5>Full Changelog</a><p>Very small change that affects how caller info is formatted.<p>Instead of this <code>at ChangeLogExample1 in /SourcePath/ChangeLogExample.cs 28</code>, hashtag was added now we have this <code>at ChangeLogExample1 in /SourcePath/ChangeLogExample.cs#28</code>.<p>This is because, when caller info is displayed with a hashtag in Visual Studio Code, <code>Ctrl+Click</code> will navigate editor to that exact line.<h2 id=524-2022-10-04><a href=https://github.com/vb-consulting/Norm.net/tree/5.2.4>5.2.4</a> (2022-10-04)<a class="anchor bookmark-target"href=#524-2022-10-04><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.2.3...5.2.4>Full Changelog</a><p>Fix anonymous parameter parser to allow for complex values.<h2 id=523-2022-07-08><a href=https://github.com/vb-consulting/Norm.net/tree/5.2.3>5.2.3</a> (2022-07-08)<a class="anchor bookmark-target"href=#523-2022-07-08><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.2.2...5.2.3>Full Changelog</a><p>Comment headers are now always multi-line SQL comments.<p>Quick example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">void</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">ChangeLogExample1</span><span style="color: #E6E6E6">()</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">bar</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">WithCommentHeader</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">comment</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"My foo bar query"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">includeCommandAttributes</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">includeParameters</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">includeCallerInfo</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"foo value"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">bar</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"bar value"</span><span style="color: #E6E6E6"> })</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select @foo, @bar"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">void</span><span style="color: #000000"> </span><span style="color: #795E26">ChangeLogExample1</span><span style="color: #000000">()</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">foo</span><span style="color: #000000">, </span><span style="color: #001080">bar</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">WithCommentHeader</span><span style="color: #000000">(</span><span style="color: #001080">comment</span><span style="color: #000000">: </span><span style="color: #A31515">"My foo bar query"</span><span style="color: #000000">, </span><span style="color: #001080">includeCommandAttributes</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #001080">includeParameters</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #001080">includeCallerInfo</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> { </span><span style="color: #001080">foo</span><span style="color: #000000"> = </span><span style="color: #A31515">"foo value"</span><span style="color: #000000">, </span><span style="color: #001080">bar</span><span style="color: #000000"> = </span><span style="color: #A31515">"bar value"</span><span style="color: #000000"> })</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">"select @foo, @bar"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><p>This will produce the following command on SQL Server:<pre><code>/*
My foo bar query
Sql Text Command. Timeout: 30 seconds.
at ChangeLogExample1 in /SourcePath/ChangeLogExample.cs 28
@foo nvarchar = "foo value"
@bar nvarchar = "bar value"
*/
select @foo, @bar
</code></pre><p>Single line comments, when showing parameter values that contain multiple lines could break comments and cause runtime errors.<p>This solves this problem.<p>Additionally, parameter values are parsed to replace comment start and end sequences (<code>/*</code> and <code>*/</code>) with <code>??</code>.<p>Comment header parameters now support PostgreSQL native positional parameters.<p>PostgreSQL array parameter output to comment header is also supported.<h2 id=522-2022-07-05><a href=https://github.com/vb-consulting/Norm.net/tree/5.2.2>5.2.2</a> (2022-07-05)<a class="anchor bookmark-target"href=#522-2022-07-05><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.2.1...5.2.2>Full Changelog</a><ul><li><p>Smaller internal improvements and fixed async disposal for the Multiple Batch class implementation.<li><p>New performance tests. They are showing that Norm is now at similar levels as Dapper. This might be due to the new feature implementations that have been added since version 4.3.0.</ul><h2 id=521-2022-06-26><a href=https://github.com/vb-consulting/Norm.net/tree/5.2.1>5.2.1</a> (2022-06-26)<a class="anchor bookmark-target"href=#521-2022-06-26><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.2.0...5.2.1>Full Changelog</a><h3 id=support-for-specific-parameter-types-when-using-postgresql-native-positional-parameters>Support for specific parameter types when using PostgreSQL native positional parameters<a class="anchor bookmark-target"href=#support-for-specific-parameter-types-when-using-postgresql-native-positional-parameters><i class="bi bi-link-45deg"></i></a></h3><p>In previous version with could set PostgreSQL positional paramters like this:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_b_"</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"a__"</span><span style="color: #E6E6E6">;</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"select * from </span></span>
<span class=line><span style="color: #CE9178">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #CE9178">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"abc"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p1</span><span style="color: #000000"> = </span><span style="color: #A31515">"_b_"</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p2</span><span style="color: #000000"> = </span><span style="color: #A31515">"a__"</span><span style="color: #000000">;</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #001080">p1</span><span style="color: #000000">, </span><span style="color: #001080">p2</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">@"select * from </span></span>
<span class=line><span style="color: #A31515">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #A31515">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"abc"</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">);</span></span></code></pre></div><p>However, sometimes when the parameter value is null, and the parameter type has not been set explicitly and PostgreSQL could not determine the data type of that parameter.<p>In fact, this would throw an exception:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_b_"</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> (</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)</span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">;</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"select * from </span></span>
<span class=line><span style="color: #CE9178">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #CE9178">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #4EC9B0">Unhandled</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">exception</span><span style="color: #E6E6E6">. </span><span style="color: #4EC9B0">Npgsql</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">PostgresException</span><span style="color: #E6E6E6"> (0x80004005): 42P08: could not determine data type of parameter $1</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p1</span><span style="color: #000000"> = </span><span style="color: #A31515">"_b_"</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p2</span><span style="color: #000000"> = (</span><span style="color: #0000FF">string</span><span style="color: #000000">)</span><span style="color: #0000FF">null</span><span style="color: #000000">;</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #001080">p1</span><span style="color: #000000">, </span><span style="color: #001080">p2</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">@"select * from </span></span>
<span class=line><span style="color: #A31515">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #A31515">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #267F99">Unhandled</span><span style="color: #000000"> </span><span style="color: #267F99">exception</span><span style="color: #000000">. </span><span style="color: #267F99">Npgsql</span><span style="color: #000000">.</span><span style="color: #795E26">PostgresException</span><span style="color: #000000"> (0x80004005): 42P08: could not determine data type of parameter $1</span></span></code></pre></div><p>From this version 5.2.1, positional parameter can be value tuple where first tuple is actual value and second value is database type:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_b_"</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> ((</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)</span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">DbType</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">AnsiString</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"select * from </span></span>
<span class=line><span style="color: #CE9178">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #CE9178">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p1</span><span style="color: #000000"> = </span><span style="color: #A31515">"_b_"</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p2</span><span style="color: #000000"> = ((</span><span style="color: #0000FF">string</span><span style="color: #000000">)</span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #001080">DbType</span><span style="color: #000000">.</span><span style="color: #001080">AnsiString</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #001080">p1</span><span style="color: #000000">, </span><span style="color: #001080">p2</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">@"select * from </span></span>
<span class=line><span style="color: #A31515">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #A31515">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span></code></pre></div><p>This will set the parameter type correctly and solve the error.<p>It is also possible to use native parameter type, for example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"_b_"</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> ((</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)</span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">NpgsqlDbType</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Text</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">p1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">p2</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">@"select * from </span></span>
<span class=line><span style="color: #CE9178">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #CE9178">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p1</span><span style="color: #000000"> = </span><span style="color: #A31515">"_b_"</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">p2</span><span style="color: #000000"> = ((</span><span style="color: #0000FF">string</span><span style="color: #000000">)</span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #001080">NpgsqlDbType</span><span style="color: #000000">.</span><span style="color: #001080">Text</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #001080">p1</span><span style="color: #000000">, </span><span style="color: #001080">p2</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">@"select * from </span></span>
<span class=line><span style="color: #A31515">        (values ('abc'), ('bcd')) t (t1) </span></span>
<span class=line><span style="color: #A31515">        where ($1 is null or t1 similar to $1) and ($2 is null or t1 similar to $2)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span></code></pre></div><p>Note that this approach will also save the underlying database driver of mapping correct types, and give another performance increase.<h2 id=520-2022-06-23><a href=https://github.com/vb-consulting/Norm.net/tree/5.2.0>5.2.0</a> (2022-06-23)<a class="anchor bookmark-target"href=#520-2022-06-23><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.1.0...5.2.0>Full Changelog</a><h3 id=support-for-postgresql-native-positional-parameters---npgsql-postgresql-6-only>Support for PostgreSQL native positional parameters - Npgsql (PostgreSQL) 6+ only<a class="anchor bookmark-target"href=#support-for-postgresql-native-positional-parameters---npgsql-postgresql-6-only><i class="bi bi-link-45deg"></i></a></h3><p>You can now use PostgreSQL <strong>native positional parameters</strong> (or any other database provider that supports unnamed positional parameters).<p>PostgreSQL example by using <a href=https://www.postgresql.org/docs/8.1/sql-expressions.html#AEN1626>standard dollar notation</a> to set parameters positions:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">), </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select $1, $2, $3, $4, $5"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">True</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">), </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Null</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">s</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">, </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #001080">d</span><span style="color: #000000">, </span><span style="color: #001080">@null</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #A31515">"str"</span><span style="color: #000000">, </span><span style="color: #098658">999</span><span style="color: #000000">, </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">), </span><span style="color: #0000FF">null</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span><span style="color: #0000FF">bool</span><span style="color: #000000">, </span><span style="color: #267F99">DateTime</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">"select $1, $2, $3, $4, $5"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"str"</span><span style="color: #000000">, </span><span style="color: #001080">s</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">999</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">True</span><span style="color: #000000">(</span><span style="color: #001080">b</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">), </span><span style="color: #001080">d</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Null</span><span style="color: #000000">(</span><span style="color: #001080">@null</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span></code></pre></div><p>Here the <code>$1</code> references the value of the first function argument, <code>$2</code> for the second, and so on.<p>There are two conditions to enable using PostgreSQL native positional parameters:<ol><li>Connection must be an instance of <code>NpgsqlConnection</code> from <code>Npgsql</code> version 6 or higher.<li>All supplied parameters must be a simple type (<code>int</code>, <code>string</code>, <code>DateTime</code>, <code>bool</code>, etc). Using class or record instance values of complex types will force using named parameters again.</ol><p>Mixing named and positional parameters in a query like this <code>SELECT * FROM employees WHERE first_name = $1 AND age = @age</code> will trow <code>System.NotSupportedException : Mixing named and positional parameters isn't supported</code> error.<p>Other then setting simple values, you can also use native <code>NpgsqlParameter</code> objects by setting only values, like this:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">Value</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6"> },</span></span>
<span class=line><span style="color: #E6E6E6">                    </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">Value</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6"> },</span></span>
<span class=line><span style="color: #E6E6E6">                    </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">Value</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6"> },</span></span>
<span class=line><span style="color: #E6E6E6">                    </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">Value</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">) },</span></span>
<span class=line><span style="color: #E6E6E6">                    </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">Value</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">DBNull</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Value</span><span style="color: #E6E6E6"> })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select $1, $2, $3, $4, $5"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">True</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">), </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Null</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">s</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">, </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #001080">d</span><span style="color: #000000">, </span><span style="color: #001080">@null</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000"> { </span><span style="color: #001080">Value</span><span style="color: #000000"> = </span><span style="color: #A31515">"str"</span><span style="color: #000000"> },</span></span>
<span class=line><span style="color: #000000">                    </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000"> { </span><span style="color: #001080">Value</span><span style="color: #000000"> = </span><span style="color: #098658">999</span><span style="color: #000000"> },</span></span>
<span class=line><span style="color: #000000">                    </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000"> { </span><span style="color: #001080">Value</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000"> },</span></span>
<span class=line><span style="color: #000000">                    </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000"> { </span><span style="color: #001080">Value</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">) },</span></span>
<span class=line><span style="color: #000000">                    </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000"> { </span><span style="color: #001080">Value</span><span style="color: #000000"> = </span><span style="color: #001080">DBNull</span><span style="color: #000000">.</span><span style="color: #001080">Value</span><span style="color: #000000"> })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span><span style="color: #0000FF">bool</span><span style="color: #000000">, </span><span style="color: #267F99">DateTime</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">"select $1, $2, $3, $4, $5"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"str"</span><span style="color: #000000">, </span><span style="color: #001080">s</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">999</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">True</span><span style="color: #000000">(</span><span style="color: #001080">b</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">), </span><span style="color: #001080">d</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Null</span><span style="color: #000000">(</span><span style="color: #001080">@null</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span></code></pre></div><p><strong><strong>Important:</strong></strong><p>Using PostgreSQL native positional parameters will disable SQL rewriting by the <code>Npgsql</code> drivers for that command.<p>That has a positive performance impact since the driver doesn't have to parse the command anymore.<p>However, sending multiple commands in one command string separated by a semicolon will be disabled and will throw <code>Npgsql.PostgresException : 42601: cannot insert multiple commands into a prepared statement</code>.<p>See following <a href=https://www.roji.org/parameters-batching-and-sql-rewriting>article</a>.<h2 id=npgsqlenablesqlrewriting-global-setting---npgsql-postgresql-6-only>NpgsqlEnableSqlRewriting global setting - Npgsql (PostgreSQL) 6+ only<a class="anchor bookmark-target"href=#npgsqlenablesqlrewriting-global-setting---npgsql-postgresql-6-only><i class="bi bi-link-45deg"></i></a></h2><p>You can force all <code>Npgsql</code> commands to "raw" mode that disables <code>Npgsql</code> parser for all <code>Npgsql</code> commands globally.<p>Set global <code>NpgsqlEnableSqlRewriting</code> settings to false:<div class=one-liner><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">NpgsqlEnableSqlRewriting</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> => </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">NpgsqlEnableSqlRewriting</span><span style="color: #000000"> = </span><span style="color: #0000FF">false</span><span style="color: #000000">);</span></span></code></pre></div></div><p>Notes:<ul><li><p>This option only has an impact if it is set before any <code>Npgsql</code> command is executed. <code>NpgsqlCommand</code> caches internally this value.<li><p>Default value is <code>null</code> which doesn't change anything, uses <code>Npgsql</code> default which is false.<li><p>Only available for <code>Npgsql</code> version 6 or higher.<li><p>When in "raw" mode (SQL rewriting disabled) following features are disabled:<ul><li>Named parameters are disabled, and positional parameters with $ syntax must be used always (throws <code>System.NotSupportedException : Mixing named and positional parameters isn't supported</code>).<li>Multiple commands in one command string separated by a semicolon (throws <code>Npgsql.PostgresException : 42601: cannot insert multiple commands into a prepared statement</code>)</ul></ul><h3 id=withunknownresulttypeparams-bool-list-connection-extension-method---npgsql-postgresql-6-only>WithUnknownResultType(params bool[] list) connection extension method - Npgsql (PostgreSQL) 6+ only<a class="anchor bookmark-target"href=#withunknownresulttypeparams-bool-list-connection-extension-method---npgsql-postgresql-6-only><i class="bi bi-link-45deg"></i></a></h3><p>This new method extension will tell the underlying <code>Npgsql</code> command results parser not to map command results and return raw strings only.<p>For example, results of this PostgreSQL query are all strings:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">@int</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@bool</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@date</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@num</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@json</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithUnknownResultType</span><span style="color: #E6E6E6">()</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"select 1::int, true::bool, '1977-05-19'::date, 3.14::numeric, '{</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">x</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">: </span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">y</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">}'::json"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"1"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@int</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"t"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@bool</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"1977-05-19"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@date</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"3.14"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@num</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"{</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">x</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">: </span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">y</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">}"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@json</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">@int</span><span style="color: #000000">, </span><span style="color: #001080">@bool</span><span style="color: #000000">, </span><span style="color: #001080">@date</span><span style="color: #000000">, </span><span style="color: #001080">@num</span><span style="color: #000000">, </span><span style="color: #001080">@json</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithUnknownResultType</span><span style="color: #000000">()</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"select 1::int, true::bool, '1977-05-19'::date, 3.14::numeric, '{</span><span style="color: #EE0000">\"</span><span style="color: #A31515">x</span><span style="color: #EE0000">\"</span><span style="color: #A31515">: </span><span style="color: #EE0000">\"</span><span style="color: #A31515">y</span><span style="color: #EE0000">\"</span><span style="color: #A31515">}'::json"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"1"</span><span style="color: #000000">, </span><span style="color: #001080">@int</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"t"</span><span style="color: #000000">, </span><span style="color: #001080">@bool</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"1977-05-19"</span><span style="color: #000000">, </span><span style="color: #001080">@date</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"3.14"</span><span style="color: #000000">, </span><span style="color: #001080">@num</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"{</span><span style="color: #EE0000">\"</span><span style="color: #A31515">x</span><span style="color: #EE0000">\"</span><span style="color: #A31515">: </span><span style="color: #EE0000">\"</span><span style="color: #A31515">y</span><span style="color: #EE0000">\"</span><span style="color: #A31515">}"</span><span style="color: #000000">, </span><span style="color: #001080">@json</span><span style="color: #000000">);</span></span></code></pre></div><p>In this case, the results parser didn't even bother trying to map and just returned the raw string.<p>This, of course, has certain performance benefits. Sometimes, results don't have to be mapped and they can be passed as-is.<p>But sometimes, this can be useful when mapping rare and exotic PostgreSQL types which are not supported by the official <code>Npgsql</code> drivers.<p>PostgreSQL is unkown to have a variety of different and custom types and not all may be supported by the <code>Npgsql</code>. See this <a href=https://www.npgsql.org/doc/faq.html#a-nameunknowntypei-get-an-exception-the-field-field1-has-a-type-currently-unknown-to-npgsql-oid-xxxxx-you-can-retrieve-it-as-a-string-by-marking-it-as-unknowna>FAQ</a><p>If you supply array parameters for this method, you can tell the <code>Npgsql</code> that unknown types are only at certain position, by setting <code>true</code> at same paramater position. For example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">@int</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@bool</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@date</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@num</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@json</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithUnknownResultType</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">decimal</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #9CDCFE">sql</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"select 1::int, true::bool, '1977-05-19'::date, 3.14::numeric, '{</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">x</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">: </span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">y</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">}'::json"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"1"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@int</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@bool</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"1977-05-19"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@date</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">3.14m</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@num</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"{</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">x</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">: </span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">y</span><span style="color: #D7BA7D">\"</span><span style="color: #CE9178">}"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@json</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">@int</span><span style="color: #000000">, </span><span style="color: #001080">@bool</span><span style="color: #000000">, </span><span style="color: #001080">@date</span><span style="color: #000000">, </span><span style="color: #001080">@num</span><span style="color: #000000">, </span><span style="color: #001080">@json</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithUnknownResultType</span><span style="color: #000000">(</span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #0000FF">false</span><span style="color: #000000">, </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #0000FF">false</span><span style="color: #000000">, </span><span style="color: #0000FF">true</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">bool</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">decimal</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #001080">sql</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"select 1::int, true::bool, '1977-05-19'::date, 3.14::numeric, '{</span><span style="color: #EE0000">\"</span><span style="color: #A31515">x</span><span style="color: #EE0000">\"</span><span style="color: #A31515">: </span><span style="color: #EE0000">\"</span><span style="color: #A31515">y</span><span style="color: #EE0000">\"</span><span style="color: #A31515">}'::json"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"1"</span><span style="color: #000000">, </span><span style="color: #001080">@int</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #001080">@bool</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"1977-05-19"</span><span style="color: #000000">, </span><span style="color: #001080">@date</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">3.14m</span><span style="color: #000000">, </span><span style="color: #001080">@num</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"{</span><span style="color: #EE0000">\"</span><span style="color: #A31515">x</span><span style="color: #EE0000">\"</span><span style="color: #A31515">: </span><span style="color: #EE0000">\"</span><span style="color: #A31515">y</span><span style="color: #EE0000">\"</span><span style="color: #A31515">}"</span><span style="color: #000000">, </span><span style="color: #001080">@json</span><span style="color: #000000">);</span></span></code></pre></div><p>So, in this case only the first, third, and fourth results are unknown and therefore returned as raw strings.<p>If simply called this method without any parameters like this <code>.WithUnknownResultType()</code> - it would set all results to unknown raw mode.<h2 id=510-2022-06-20><a href=https://github.com/vb-consulting/Norm.net/tree/5.1.0>5.1.0</a> (2022-06-20)<a class="anchor bookmark-target"href=#510-2022-06-20><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.0.1...5.1.0>Full Changelog</a><h3 id=withcommandbehaviorcommandbehavior-connection-extension-method>WithCommandBehavior(CommandBehavior) connection extension method<a class="anchor bookmark-target"href=#withcommandbehaviorcommandbehavior-connection-extension-method><i class="bi bi-link-45deg"></i></a></h3><p>New extensions method that sets the command behavior of the data read for the next command.<p>You can combine <code>CommandBehavior</code> values as flags. For example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithCommandBehavior</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">CommandBehavior</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CloseConnection</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">|</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">CommandBehavior</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">SingleRow</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(...);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithCommandBehavior</span><span style="color: #000000">(</span><span style="color: #001080">CommandBehavior</span><span style="color: #000000">.</span><span style="color: #001080">CloseConnection</span><span style="color: #000000"> | </span><span style="color: #001080">CommandBehavior</span><span style="color: #000000">.</span><span style="color: #001080">SingleRow</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">(...);</span></span></code></pre></div><p>Here are all command behaviors available:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">namespace</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">System</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">Data</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #6A9955">//     Provides a description of the results of the query and its effect on the database.</span></span>
<span class=line><span style="color: #E6E6E6">    [</span><span style="color: #4EC9B0">Flags</span><span style="color: #E6E6E6">]</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">enum</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">CommandBehavior</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     The query may return multiple result sets. Execution of the query may affect</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     the database state. Default sets no System.Data.CommandBehavior flags, so calling</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     ExecuteReader(CommandBehavior.Default) is functionally equivalent to calling</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     ExecuteReader().</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">Default</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     The query returns a single result set.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">SingleResult</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     The query returns column information only. When using System.Data.CommandBehavior.SchemaOnly,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     the .NET Framework Data Provider for SQL Server precedes the statement being</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     executed with SET FMTONLY ON.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">SchemaOnly</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     The query returns column and primary key information. The provider appends extra</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     columns to the result set for existing primary key and timestamp columns.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">KeyInfo</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">4</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     The query is expected to return a single row of the first result set. Execution</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     of the query may affect the database state. Some .NET Framework data providers</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     may, but are not required to, use this information to optimize the performance</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     of the command. When you specify System.Data.CommandBehavior.SingleRow with the</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     System.Data.OleDb.OleDbCommand.ExecuteReader method of the System.Data.OleDb.OleDbCommand</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     object, the .NET Framework Data Provider for OLE DB performs binding using the</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     OLE DB IRow interface if it is available. Otherwise, it uses the IRowset interface.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     If your SQL statement is expected to return only a single row, specifying System.Data.CommandBehavior.SingleRow</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     can also improve application performance. It is possible to specify SingleRow</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     when executing queries that are expected to return multiple result sets. In that</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     case, where both a multi-result set SQL query and single row are specified, the</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     result returned will contain only the first row of the first result set. The</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     other result sets of the query will not be returned.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">SingleRow</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">8</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     Provides a way for the DataReader to handle rows that contain columns with large</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     binary values. Rather than loading the entire row, SequentialAccess enables the</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     DataReader to load data as a stream. You can then use the GetBytes or GetChars</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     method to specify a byte location to start the read operation, and a limited</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     buffer size for the data being returned.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">SequentialAccess</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">16</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">// Summary:</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     When the command is executed, the associated Connection object is closed when</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #6A9955">//     the associated DataReader object is closed.</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">CloseConnection</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">32</span></span>
<span class=line><span style="color: #E6E6E6">    }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">namespace</span><span style="color: #000000"> </span><span style="color: #267F99">System</span><span style="color: #000000">.</span><span style="color: #267F99">Data</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #008000">//     Provides a description of the results of the query and its effect on the database.</span></span>
<span class=line><span style="color: #000000">    [</span><span style="color: #267F99">Flags</span><span style="color: #000000">]</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">enum</span><span style="color: #000000"> </span><span style="color: #267F99">CommandBehavior</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     The query may return multiple result sets. Execution of the query may affect</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     the database state. Default sets no System.Data.CommandBehavior flags, so calling</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     ExecuteReader(CommandBehavior.Default) is functionally equivalent to calling</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     ExecuteReader().</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">Default</span><span style="color: #000000"> = </span><span style="color: #098658">0</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     The query returns a single result set.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">SingleResult</span><span style="color: #000000"> = </span><span style="color: #098658">1</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     The query returns column information only. When using System.Data.CommandBehavior.SchemaOnly,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     the .NET Framework Data Provider for SQL Server precedes the statement being</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     executed with SET FMTONLY ON.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">SchemaOnly</span><span style="color: #000000"> = </span><span style="color: #098658">2</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     The query returns column and primary key information. The provider appends extra</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     columns to the result set for existing primary key and timestamp columns.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">KeyInfo</span><span style="color: #000000"> = </span><span style="color: #098658">4</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     The query is expected to return a single row of the first result set. Execution</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     of the query may affect the database state. Some .NET Framework data providers</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     may, but are not required to, use this information to optimize the performance</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     of the command. When you specify System.Data.CommandBehavior.SingleRow with the</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     System.Data.OleDb.OleDbCommand.ExecuteReader method of the System.Data.OleDb.OleDbCommand</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     object, the .NET Framework Data Provider for OLE DB performs binding using the</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     OLE DB IRow interface if it is available. Otherwise, it uses the IRowset interface.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     If your SQL statement is expected to return only a single row, specifying System.Data.CommandBehavior.SingleRow</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     can also improve application performance. It is possible to specify SingleRow</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     when executing queries that are expected to return multiple result sets. In that</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     case, where both a multi-result set SQL query and single row are specified, the</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     result returned will contain only the first row of the first result set. The</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     other result sets of the query will not be returned.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">SingleRow</span><span style="color: #000000"> = </span><span style="color: #098658">8</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     Provides a way for the DataReader to handle rows that contain columns with large</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     binary values. Rather than loading the entire row, SequentialAccess enables the</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     DataReader to load data as a stream. You can then use the GetBytes or GetChars</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     method to specify a byte location to start the read operation, and a limited</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     buffer size for the data being returned.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">SequentialAccess</span><span style="color: #000000"> = </span><span style="color: #098658">16</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">// Summary:</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     When the command is executed, the associated Connection object is closed when</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #008000">//     the associated DataReader object is closed.</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">CloseConnection</span><span style="color: #000000"> = </span><span style="color: #098658">32</span></span>
<span class=line><span style="color: #000000">    }</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><h3 id=parameters-can-be-set-again-in-rea-and-execute-extensions-methods>Parameters can be set again in Rea` and Execute extensions methods<a class="anchor bookmark-target"href=#parameters-can-be-set-again-in-rea-and-execute-extensions-methods><i class="bi bi-link-45deg"></i></a></h3><p>This feature was removed after version 5.0.0.<p>The reason was that caller info default parameters were added and the <code>params</code> array doesn't work well with default parameters.<p>However, that doesn't mean that optional parameter object <code>object parameters = null</code> with null default value can't be used.<p>There is no convenience of the parameters array, but, it still can be used for an anonymous object which is the most common use case.<p>For example, now we can do this again:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"select @strValue, @intValue, @boolValue, @dateTimeValue, @nullValue"</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">new</span></span>
<span class=line><span style="color: #E6E6E6">        {</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">strValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">intValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">boolValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">dateTimeValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">nullValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> (</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)</span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">True</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">), </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Null</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">s</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">, </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #001080">d</span><span style="color: #000000">, </span><span style="color: #001080">@null</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span><span style="color: #0000FF">bool</span><span style="color: #000000">, </span><span style="color: #267F99">DateTime</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"select @strValue, @intValue, @boolValue, @dateTimeValue, @nullValue"</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">new</span></span>
<span class=line><span style="color: #000000">        {</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">strValue</span><span style="color: #000000"> = </span><span style="color: #A31515">"str"</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">intValue</span><span style="color: #000000"> = </span><span style="color: #098658">999</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">boolValue</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">dateTimeValue</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">nullValue</span><span style="color: #000000"> = (</span><span style="color: #0000FF">string</span><span style="color: #000000">)</span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"str"</span><span style="color: #000000">, </span><span style="color: #001080">s</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">999</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">True</span><span style="color: #000000">(</span><span style="color: #001080">b</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">), </span><span style="color: #001080">d</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Null</span><span style="color: #000000">(</span><span style="color: #001080">@null</span><span style="color: #000000">);</span></span></code></pre></div><p>However, the current extension methods <code>WithParameters</code> was not removed, and it's possible to combine both. The resulting parameters will be merged. Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">strValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">intValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">    })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"select @strValue, @intValue, @boolValue, @dateTimeValue, @nullValue"</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">new</span></span>
<span class=line><span style="color: #E6E6E6">        {</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">boolValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">dateTimeValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #9CDCFE">nullValue</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> (</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)</span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">True</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">), </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Null</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">@null</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">s</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">, </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #001080">d</span><span style="color: #000000">, </span><span style="color: #001080">@null</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">strValue</span><span style="color: #000000"> = </span><span style="color: #A31515">"str"</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">intValue</span><span style="color: #000000"> = </span><span style="color: #098658">999</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">    })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span><span style="color: #0000FF">bool</span><span style="color: #000000">, </span><span style="color: #267F99">DateTime</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"select @strValue, @intValue, @boolValue, @dateTimeValue, @nullValue"</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">new</span></span>
<span class=line><span style="color: #000000">        {</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">boolValue</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">dateTimeValue</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #001080">nullValue</span><span style="color: #000000"> = (</span><span style="color: #0000FF">string</span><span style="color: #000000">)</span><span style="color: #0000FF">null</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"str"</span><span style="color: #000000">, </span><span style="color: #001080">s</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">999</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">True</span><span style="color: #000000">(</span><span style="color: #001080">b</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">), </span><span style="color: #001080">d</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Null</span><span style="color: #000000">(</span><span style="color: #001080">@null</span><span style="color: #000000">);</span></span></code></pre></div><p>This new optional paramemeter <code>paramemeters</code> on <code>Read</code> and <code>Execute</code> extensions is no longer an array. To be able to pass parameters array, actual array needs to be constructed. Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">>(</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #CE9178">"select @s, @i, @b, @d"</span><span style="color: #E6E6E6">,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6">[] </span></span>
<span class=line><span style="color: #E6E6E6">        {</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"s"</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"i"</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"b"</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">            </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlParameter</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"d"</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">))</span></span>
<span class=line><span style="color: #E6E6E6">        })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"str"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">999</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">i</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">True</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1977</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">5</span><span style="color: #E6E6E6">, </span><span style="color: #B5CEA8">19</span><span style="color: #E6E6E6">), </span><span style="color: #9CDCFE">d</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">s</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">, </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #001080">d</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span><span style="color: #0000FF">bool</span><span style="color: #000000">, </span><span style="color: #267F99">DateTime</span><span style="color: #000000">>(</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #A31515">"select @s, @i, @b, @d"</span><span style="color: #000000">,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000">[] </span></span>
<span class=line><span style="color: #000000">        {</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000">(</span><span style="color: #A31515">"s"</span><span style="color: #000000">, </span><span style="color: #A31515">"str"</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000">(</span><span style="color: #A31515">"i"</span><span style="color: #000000">, </span><span style="color: #098658">999</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000">(</span><span style="color: #A31515">"b"</span><span style="color: #000000">, </span><span style="color: #0000FF">true</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">            </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlParameter</span><span style="color: #000000">(</span><span style="color: #A31515">"d"</span><span style="color: #000000">, </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">))</span></span>
<span class=line><span style="color: #000000">        })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #A31515">"str"</span><span style="color: #000000">, </span><span style="color: #001080">s</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">999</span><span style="color: #000000">, </span><span style="color: #001080">i</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">True</span><span style="color: #000000">(</span><span style="color: #001080">b</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">DateTime</span><span style="color: #000000">(</span><span style="color: #098658">1977</span><span style="color: #000000">, </span><span style="color: #098658">5</span><span style="color: #000000">, </span><span style="color: #098658">19</span><span style="color: #000000">), </span><span style="color: #001080">d</span><span style="color: #000000">);</span></span></code></pre></div><h3 id=withtransactiondbtransaction-connection-extension-method><code>WithTransaction(DbTransaction)</code> connection extension method<a class="anchor bookmark-target"href=#withtransactiondbtransaction-connection-extension-method><i class="bi bi-link-45deg"></i></a></h3><p>Support for the transaction control by using <code>DbTransaction</code> object.<p><code>WithTransaction(DbTransaction)</code> will set the transaction object for the next command.<p>Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">var</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">connection</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlConnection</span><span style="color: #E6E6E6">(</span><span style="color: #4EC9B0">fixture</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">ConnectionString</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #4EC9B0">Execute</span><span style="color: #E6E6E6">("</span><span style="color: #4EC9B0">create</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">temp</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">table</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">transaction_test1</span><span style="color: #E6E6E6"> (</span><span style="color: #4EC9B0">i</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">int</span><span style="color: #E6E6E6">);</span><span style="color: #CE9178">")</span><span style="color: #F44747">;</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">var</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">transaction</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">connection</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">BeginTransaction</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithTransaction</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">transaction</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Execute</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"insert into transaction_test1 values (1),(2),(3);"</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"select * from transaction_test1"</span><span style="color: #E6E6E6">).</span><span style="color: #DCDCAA">ToArray</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">3</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Length</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">transaction</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Rollback</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"select * from transaction_test1"</span><span style="color: #E6E6E6">).</span><span style="color: #DCDCAA">ToArray</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Empty</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">result2</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">var</span><span style="color: #000000"> </span><span style="color: #267F99">connection</span><span style="color: #000000"> = </span><span style="color: #267F99">new</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlConnection</span><span style="color: #000000">(</span><span style="color: #267F99">fixture</span><span style="color: #000000">.</span><span style="color: #267F99">ConnectionString</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #267F99">Execute</span><span style="color: #000000">("</span><span style="color: #267F99">create</span><span style="color: #000000"> </span><span style="color: #267F99">temp</span><span style="color: #000000"> </span><span style="color: #267F99">table</span><span style="color: #000000"> </span><span style="color: #267F99">transaction_test1</span><span style="color: #000000"> (</span><span style="color: #267F99">i</span><span style="color: #000000"> </span><span style="color: #267F99">int</span><span style="color: #000000">);</span><span style="color: #A31515">")</span><span style="color: #CD3131">;</span></span>
<span class=line></span>
<span class=line><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">var</span><span style="color: #000000"> </span><span style="color: #267F99">transaction</span><span style="color: #000000"> = </span><span style="color: #267F99">connection</span><span style="color: #000000">.</span><span style="color: #267F99">BeginTransaction</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithTransaction</span><span style="color: #000000">(</span><span style="color: #001080">transaction</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Execute</span><span style="color: #000000">(</span><span style="color: #A31515">"insert into transaction_test1 values (1),(2),(3);"</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result1</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #A31515">"select * from transaction_test1"</span><span style="color: #000000">).</span><span style="color: #795E26">ToArray</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">3</span><span style="color: #000000">, </span><span style="color: #001080">result1</span><span style="color: #000000">.</span><span style="color: #001080">Length</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">transaction</span><span style="color: #000000">.</span><span style="color: #795E26">Rollback</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result2</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #A31515">"select * from transaction_test1"</span><span style="color: #000000">).</span><span style="color: #795E26">ToArray</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Empty</span><span style="color: #000000">(</span><span style="color: #001080">result2</span><span style="color: #000000">);</span></span></code></pre></div><h3 id=withtimeout-connection-extension-method>WithTimeout connection extension method<a class="anchor bookmark-target"href=#withtimeout-connection-extension-method><i class="bi bi-link-45deg"></i></a></h3><p>This is equivalent to the <code>Timeout</code> connection extension, added only for the naming consistency ("with" prefix).<p>It just sets the wait time in seconds for the connection commands, before terminating the attempt to execute a command and generating an error.<h3 id=mapprivatesetters-global-option>MapPrivateSetters global option<a class="anchor bookmark-target"href=#mapprivatesetters-global-option><i class="bi bi-link-45deg"></i></a></h3><p>By default, it is not possible to map instance properties that don't have a public setter method.<p>Now, it is possible to change that behavior with global options by using the <code>MapPrivateSetters</code> setting, like this:<div class=one-liner><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">MapPrivateSetters</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// default is false</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> => </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">MapPrivateSetters</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">); </span><span style="color: #008000">// default is false</span></span></code></pre></div></div><p>This will enable mapping of the instance properties with private and protected setter methods:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">class</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">TestClass</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">PrivateSetInt</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">private</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">ProtectedSetInt</span><span style="color: #E6E6E6"> { </span><span style="color: #569CD6">get</span><span style="color: #E6E6E6">; </span><span style="color: #569CD6">protected</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">set</span><span style="color: #E6E6E6">; }</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">TestClass</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">PrivateSetInt</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">ProtectedSetInt</span><span style="color: #000000"> { </span><span style="color: #0000FF">get</span><span style="color: #000000">; </span><span style="color: #0000FF">protected</span><span style="color: #000000"> </span><span style="color: #0000FF">set</span><span style="color: #000000">; }</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">TestClass</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select 1 as private_set_int, 2 as protected_set_int"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">PrivateSetInt</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span>
<span class=line><span style="color: #9CDCFE">Assert</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Equal</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">result</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">ProtectedSetInt</span><span style="color: #E6E6E6">); </span><span style="color: #6A9955">// true</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #267F99">TestClass</span><span style="color: #000000">>(</span><span style="color: #A31515">"select 1 as private_set_int, 2 as protected_set_int"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">PrivateSetInt</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span>
<span class=line><span style="color: #001080">Assert</span><span style="color: #000000">.</span><span style="color: #795E26">Equal</span><span style="color: #000000">(</span><span style="color: #098658">2</span><span style="color: #000000">, </span><span style="color: #001080">result</span><span style="color: #000000">.</span><span style="color: #001080">ProtectedSetInt</span><span style="color: #000000">); </span><span style="color: #008000">// true</span></span></code></pre></div><p>Note that instance properties without any setter or a public getter are still not going to be mapped.<h3 id=multiple-readers-now-implement-iasyncdisposable>Multiple readers now implement <code>IAsyncDisposable</code><a class="anchor bookmark-target"href=#multiple-readers-now-implement-iasyncdisposable><i class="bi bi-link-45deg"></i></a></h3><p>And now it's possible to do:<div class=one-liner><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">await</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">await</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">MultipleAsync</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">Queires</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">await</span><span style="color: #000000"> </span><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">multiple</span><span style="color: #000000"> = </span><span style="color: #0000FF">await</span><span style="color: #000000"> </span><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">MultipleAsync</span><span style="color: #000000">(</span><span style="color: #001080">Queires</span><span style="color: #000000">);</span></span></code></pre></div></div><h3 id=changed-member-scope-from-internal-to-allow-greater-extendibility>Changed member scope from internal to allow greater extendibility<a class="anchor bookmark-target"href=#changed-member-scope-from-internal-to-allow-greater-extendibility><i class="bi bi-link-45deg"></i></a></h3><h2 id=501-2022-06-16><a href=https://github.com/vb-consulting/Norm.net/tree/5.0.1>5.0.1</a> (2022-06-16)<a class="anchor bookmark-target"href=#501-2022-06-16><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/5.0.0...5.0.1>Full Changelog</a><ul><li>Fixed weird edge case bug with mapping <code>datetimeoffset</code> on SQL Server, when actual type is <code>datetimeoffset</code>.<li>Slightly improved parameters parsing when using positional parameters.</ul><h2 id=500-2022-05-24><a href=https://github.com/vb-consulting/Norm.net/tree/5.0.0>5.0.0</a> (2022-05-24)<a class="anchor bookmark-target"href=#500-2022-05-24><i class="bi bi-link-45deg"></i></a></h2><p><a href=https://github.com/vb-consulting/Norm.net/compare/4.3.0...5.0.0>Full Changelog</a><h3 id=new-feature---comment-headers>New feature - comment headers<a class="anchor bookmark-target"href=#new-feature---comment-headers><i class="bi bi-link-45deg"></i></a></h3><p>From version 5, Norm can create SQL comment headers on all or some SQL commands.<p>Those comment headers can include the following:<ul><li>Custom user comment.<li>Parameters names, types, and values.<li>Caller info such as calling method name, source code file name, and line number.<li>Command attributes such as database provider, command type (text or stored procedure), and command timeout.<li>Execution timestamp.</ul><p>When enabled, this feature can help with diagnostics and monitoring through:<ul><li>Standard application loggers.<li>Database monitoring tools such as Activity Monitor on SQL Server or monitoring tables on PostgreSQL such as <code>pg_stat_activity</code> or <code>pg_stat_statements</code>.</ul><p>Quick example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">public</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">void</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">ChangeLogExample1</span><span style="color: #E6E6E6">()</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> (</span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">bar</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">WithCommentHeader</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">comment</span><span style="color: #E6E6E6">: </span><span style="color: #CE9178">"My foo bar query"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">includeCommandAttributes</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">includeParameters</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">includeCallerInfo</span><span style="color: #E6E6E6">: </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> { </span><span style="color: #9CDCFE">foo</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"foo value"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">bar</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"bar value"</span><span style="color: #E6E6E6"> })</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">>(</span><span style="color: #CE9178">"select @foo, @bar"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">        .</span><span style="color: #DCDCAA">Single</span><span style="color: #E6E6E6">();</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">void</span><span style="color: #000000"> </span><span style="color: #795E26">ChangeLogExample1</span><span style="color: #000000">()</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #0000FF">var</span><span style="color: #000000"> (</span><span style="color: #001080">foo</span><span style="color: #000000">, </span><span style="color: #001080">bar</span><span style="color: #000000">) = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">WithCommentHeader</span><span style="color: #000000">(</span><span style="color: #001080">comment</span><span style="color: #000000">: </span><span style="color: #A31515">"My foo bar query"</span><span style="color: #000000">, </span><span style="color: #001080">includeCommandAttributes</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #001080">includeParameters</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #001080">includeCallerInfo</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> { </span><span style="color: #001080">foo</span><span style="color: #000000"> = </span><span style="color: #A31515">"foo value"</span><span style="color: #000000">, </span><span style="color: #001080">bar</span><span style="color: #000000"> = </span><span style="color: #A31515">"bar value"</span><span style="color: #000000"> })</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;</span><span style="color: #0000FF">string</span><span style="color: #000000">, </span><span style="color: #0000FF">string</span><span style="color: #000000">>(</span><span style="color: #A31515">"select @foo, @bar"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">        .</span><span style="color: #795E26">Single</span><span style="color: #000000">();</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><p>This will produce the following command on SQL Server:<pre><code>-- My foo bar query
-- Sql Text Command. Timeout: 30 seconds.
-- at ChangeLogExample1 in /SourcePath/ChangeLogExample.cs 28
-- @foo nvarchar = "foo value"
-- @bar nvarchar = "bar value"
select @foo, @bar
</code></pre><p>Same code on PostgreSQL:<pre><code>-- My foo bar query
-- Npgsql Text Command. Timeout: 30 seconds.
-- at ChangeLogExample1 in /SourcePath/ChangeLogExample.cs 28
-- @foo text = "foo value"
-- @bar text = "bar value"
select @foo, @bar
</code></pre><p>These header values can be enabled for individual commands and globally for all commands.<p>A quick example of enabling logging of caller info and parameter values for all commands in application:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #6A9955">/* On application startup */</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandCommentHeader</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Enabled</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandCommentHeader</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">IncludeCallerInfo</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandCommentHeader</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">IncludeParameters</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">DbCommandCallback</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">command</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">logger</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">LogInformation</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">command</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandText</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #008000">/* On application startup */</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandCommentHeader</span><span style="color: #000000">.</span><span style="color: #001080">Enabled</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandCommentHeader</span><span style="color: #000000">.</span><span style="color: #001080">IncludeCallerInfo</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandCommentHeader</span><span style="color: #000000">.</span><span style="color: #001080">IncludeParameters</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">DbCommandCallback</span><span style="color: #000000"> = </span><span style="color: #001080">command</span><span style="color: #000000"> => </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">LogInformation</span><span style="color: #000000">(</span><span style="color: #001080">command</span><span style="color: #000000">.</span><span style="color: #001080">CommandText</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">});</span></span></code></pre></div><p>This allows you to log all your commands with all relevant information needed for debugging, such as parameter values, and also with source code information that allows you to locate commands in your source code.<p>And since it is included in the command comment header, they are visible on a database server as well through monitoring tools.<blockquote><p>Note: Caller info is generated at the compile time by the compiler, which makes them no different than constant values, so, there is no performance penalty for including such information.</blockquote><p>To support this feature, several new extensions are added and support global configuration.<p>More details bellow:<h3 id=new-method-extensions>New method extensions<a class="anchor bookmark-target"href=#new-method-extensions><i class="bi bi-link-45deg"></i></a></h3><p>Important note:<p>Same <code>Norm</code> method extensions are available as <code>DbConnection</code> extension methods and Norm instance methods.<p>Those methods who don't return any results are returning <code>Norm</code> instance, which allows us to chain multiple calls like in example above or simplified:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithCommentHeader</span><span style="color: #E6E6E6">(</span><span style="color: #6A9955">/*comment header options*/</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #6A9955">/*parameters*/</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #6A9955">/*command*/</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">}</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithCommentHeader</span><span style="color: #000000">(</span><span style="color: #008000">/*comment header options*/</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #008000">/*parameters*/</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #008000">/*command*/</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">}</span></span></code></pre></div><h4 id=withparametersparams-object-parameters>WithParameters(params object[] parameters)<a class="anchor bookmark-target"href=#withparametersparams-object-parameters><i class="bi bi-link-45deg"></i></a></h4><p>Sets parameters for the next command.<p><strong>This is a breaking change!</strong><p>In versions 4 and lower, parameters were supplied using this pattern:<div class=one-liner><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Execute</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"command"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">param1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">param2</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">param3</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Execute</span><span style="color: #000000">(</span><span style="color: #A31515">"command"</span><span style="color: #000000">, </span><span style="color: #001080">param1</span><span style="color: #000000">, </span><span style="color: #001080">param2</span><span style="color: #000000">, </span><span style="color: #001080">param3</span><span style="color: #000000">);</span></span></code></pre></div></div><p>From version 5, parameters are supplied using <code>WithParameters</code> extension method:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithParameters</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">param1</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">param2</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">param3</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Execute</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"command"</span><span style="color: #E6E6E6">);</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithParameters</span><span style="color: #000000">(</span><span style="color: #001080">param1</span><span style="color: #000000">, </span><span style="color: #001080">param2</span><span style="color: #000000">, </span><span style="color: #001080">param3</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Execute</span><span style="color: #000000">(</span><span style="color: #A31515">"command"</span><span style="color: #000000">);</span></span></code></pre></div><h4 id=withcommandcallbackactiondbcommand-dbcommandcallback>WithCommandCallback(Action<dbcommand>dbCommandCallback)<a class="anchor bookmark-target"href=#withcommandcallbackactiondbcommand-dbcommandcallback><i class="bi bi-link-45deg"></i></a></h4><p>Executes supplied action with constructed <code>DbCommand</code> as a single parameter just before the actual execution.<p>This exposes created <code>DbCommand</code> object and allows for eventual changes to be made to the <code>DbCommand</code> object such as changes in a command text, parameters collection, etc, depending on a provider.<p>There is also a global version of this method that is commonly used for logging tasks.<h4 id=withreadercallbackfuncstring-name-int-ordinal-dbdatareader-reader-object-readercallback>WithReaderCallback(Func&lt;(string Name, int Ordinal, DbDataReader Reader), object> readerCallback)<a class="anchor bookmark-target"href=#withreadercallbackfuncstring-name-int-ordinal-dbdatareader-reader-object-readercallback><i class="bi bi-link-45deg"></i></a></h4><p>Executes reader callback function for each value just before assigning mapper results.<p>The input parameter is a named tuple of three values:<ol><li><code>Name</code> - field name from your command results.<li><code>Ordinal</code> - ordinal position of the field from your command results.<li><code>Reader</code> - <code>DbDataReader</code> object used for reading results.</ol><p>This allows supplying custom results to mapper by returning values:<ul><li>If this function callback returns a non-null value, that value is mapped.<li>If this function callback returns a null value, the default value is mapped.<li>For null values, return <code>DBNull.Value</code>.</ul><p>Example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">array</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">WithReaderCallback</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Ordinal</span><span style="color: #E6E6E6"> </span><span style="color: #C586C0">switch</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">GetInt32</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">0</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">,  </span><span style="color: #6A9955">// add 1 to the first field with ordinal 0, mapped to the first tuple named "a"</span></span>
<span class=line><span style="color: #E6E6E6">        _ </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">                       </span><span style="color: #6A9955">// for all other fields, use the default mapping</span></span>
<span class=line><span style="color: #E6E6E6">    })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">&lt;(</span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">a</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">b</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">c</span><span style="color: #E6E6E6">)>(</span><span style="color: #CE9178">"select * from (values (1, 1, 1), (2, 2, 2), (3, 3, 3)) t(a, b, c)"</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #DCDCAA">ToArray</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">array</span><span style="color: #000000"> = </span><span style="color: #001080">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">WithReaderCallback</span><span style="color: #000000">(</span><span style="color: #001080">r</span><span style="color: #000000"> => </span><span style="color: #001080">r</span><span style="color: #000000">.</span><span style="color: #001080">Ordinal</span><span style="color: #000000"> </span><span style="color: #AF00DB">switch</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #098658">0</span><span style="color: #000000"> => </span><span style="color: #001080">r</span><span style="color: #000000">.</span><span style="color: #001080">Reader</span><span style="color: #000000">.</span><span style="color: #795E26">GetInt32</span><span style="color: #000000">(</span><span style="color: #098658">0</span><span style="color: #000000">) + </span><span style="color: #098658">1</span><span style="color: #000000">,  </span><span style="color: #008000">// add 1 to the first field with ordinal 0, mapped to the first tuple named "a"</span></span>
<span class=line><span style="color: #000000">        _ => </span><span style="color: #0000FF">null</span><span style="color: #000000">                       </span><span style="color: #008000">// for all other fields, use the default mapping</span></span>
<span class=line><span style="color: #000000">    })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">Read</span><span style="color: #000000">&lt;(</span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">a</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">b</span><span style="color: #000000">, </span><span style="color: #0000FF">int</span><span style="color: #000000"> </span><span style="color: #001080">c</span><span style="color: #000000">)>(</span><span style="color: #A31515">"select * from (values (1, 1, 1), (2, 2, 2), (3, 3, 3)) t(a, b, c)"</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #795E26">ToArray</span><span style="color: #000000">();</span></span></code></pre></div><p>Note:<p><strong>This is a breaking change!</strong><p>In version 4 and lower, this callback function was supplied as an optional parameter to the <code>Read</code> method overloads extensions.<div class=one-liner><div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">connection</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"command"</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">r</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> { </span><span style="color: #6A9955">/*...*/</span><span style="color: #E6E6E6">});</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">connection</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #A31515">"command"</span><span style="color: #000000">, </span><span style="color: #001080">r</span><span style="color: #000000"> => { </span><span style="color: #008000">/*...*/</span><span style="color: #000000">});</span></span></code></pre></div></div><p>From version 5, the <code>WithReaderCallback</code> extension method is used to supply this callback to the next read operation.<h4 id=withcommentstring-comment>WithComment(string comment)<a class="anchor bookmark-target"href=#withcommentstring-comment><i class="bi bi-link-45deg"></i></a></h4><p>Adds a custom comment header to the next command.<h4 id=withcommentparameters>WithCommentParameters()<a class="anchor bookmark-target"href=#withcommentparameters><i class="bi bi-link-45deg"></i></a></h4><p>Adds a comment header with command parameters described with names, database types, and values to the next command.<h4 id=withcommentcallerinfo>WithCommentCallerInfo()<a class="anchor bookmark-target"href=#withcommentcallerinfo><i class="bi bi-link-45deg"></i></a></h4><p>Adds a comment header with caller info data (calling method names, source code file, and line number) to the next command.<h4 id=withcommentheaderstring-comment--null-bool-includecommandattributes--true-bool-includeparameters--true-bool-includecallerinfo--true-bool-includetimestamp--false>WithCommentHeader(string comment = null, bool includeCommandAttributes = true, bool includeParameters = true, bool includeCallerInfo = true, bool includeTimestamp = false)<a class="anchor bookmark-target"href=#withcommentheaderstring-comment--null-bool-includecommandattributes--true-bool-includeparameters--true-bool-includecallerinfo--true-bool-includetimestamp--false><i class="bi bi-link-45deg"></i></a></h4><p>Adds a comment header to the next command and configures options:<ul><li><p><code>comment</code> - custom comment text.<li><p><code>includeCommandAttributes</code> - command attributes such as database provider, command type, and command timeout.<li><p><code>includeParameters</code> - command parameters described with names, database types, and values.<li><p><code>includeCallerInfo</code> - caller info data (calling method names, source code file, and line number).<li><p><code>includeTimestamp</code> - timestamp of command execution.</ul><h3 id=global-configuration>Global Configuration<a class="anchor bookmark-target"href=#global-configuration><i class="bi bi-link-45deg"></i></a></h3><p>Use the global static method <code>NormOptions.Configure(options => { /* options */ });</code> to configure global options.<p>This is usually called once at program startup. Do not call this from multithreaded sections of your application and do not call it more than once.<p>For example:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #9CDCFE">NormOptions</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Configure</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandTimeout</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">10</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">*</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">60</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandCommentHeader</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">Enabled</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandCommentHeader</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">IncludeCallerInfo</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandCommentHeader</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">IncludeParameters</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">;</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">options</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">DbCommandCallback</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">command</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">logger</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">LogInformation</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">command</span><span style="color: #E6E6E6">.</span><span style="color: #9CDCFE">CommandText</span><span style="color: #E6E6E6">);</span></span>
<span class=line><span style="color: #E6E6E6">});</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #001080">NormOptions</span><span style="color: #000000">.</span><span style="color: #795E26">Configure</span><span style="color: #000000">(</span><span style="color: #001080">options</span><span style="color: #000000"> =></span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandTimeout</span><span style="color: #000000"> = </span><span style="color: #098658">10</span><span style="color: #000000"> * </span><span style="color: #098658">60</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandCommentHeader</span><span style="color: #000000">.</span><span style="color: #001080">Enabled</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandCommentHeader</span><span style="color: #000000">.</span><span style="color: #001080">IncludeCallerInfo</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">CommandCommentHeader</span><span style="color: #000000">.</span><span style="color: #001080">IncludeParameters</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span><span style="color: #000000">;</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">options</span><span style="color: #000000">.</span><span style="color: #001080">DbCommandCallback</span><span style="color: #000000"> = </span><span style="color: #001080">command</span><span style="color: #000000"> => </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">LogInformation</span><span style="color: #000000">(</span><span style="color: #001080">command</span><span style="color: #000000">.</span><span style="color: #001080">CommandText</span><span style="color: #000000">);</span></span>
<span class=line><span style="color: #000000">});</span></span></code></pre></div><p>This will configure all commands to have a timeout of 10 minutes and enables comment headers with parameters description.<p>Available options are:<table class="table table-hover table-sm table-responsive-sm"><thead><tr><th>Option name<th>Description<th>Default<tbody class=table-group-divider><tr><td><code>CommandTimeout</code><td>Sets the wait time in seconds for the connection commands, before terminating the attempt to execute a command and generating an error<td><code>NULL</code> (system default)<tr><td><code>DbCommandCallback</code><td>Command callback that will be called before every execution.<td><code>NULL</code> (don't run this callback)<tr><td><code>RawInterpolationParameterEscape</code><td>Escape sequence, when using parameters via string interpolation formats, use this escape to skip parameter parsing and use values as is.<td>"raw"<tr><td><code>Prepared</code><td>Set to true to run all commands in prepared mode every time by calling <code>Prepare()</code> method before execution.<td><code>false</code><tr><td><code>CommandCommentHeader</code><td>Autmoatic command comment header options.<td>see table bellow</table><p><code>CommandCommentHeader</code> options are:<table class="table table-hover table-sm table-responsive-sm"><thead><tr><th>Option name<th>Description<th>Default<tbody class=table-group-divider><tr><td><code>Enabled</code><td>Enable automatic comment headers that are added to each query command.<td><code>false</code><tr><td><code>IncludeCommandAttributes</code><td>Include current command attributes like database provider, command type, and command timeout.<td><code>true</code><tr><td><code>IncludeCallerInfo</code><td>Include command caller info like calling method member name, source code file path, and source code line number.<td><code>true</code><tr><td><code>IncludeParameters</code><td>Include command parameters in comment headers.<td><code>true</code><tr><td><code>ParametersFormat</code><td>Format string for parameters in comment headers. Placeholder 0 is the parameter name, 1 is the parameter type and 2 is the parameter value. Used only when <code>IncludeParameters</code> is <code>true</code>.<td><code>$"-- @{{!0!}} {{!1!}} = {{!2!}}{Environment.NewLine}"</code><tr><td><code>IncludeTimestamp</code><td>Include command execution timestamp in comment headers.<td><code>false</code><tr><td><code>OmmitStoredProcCommandCommentHeaderForDbTypes</code><td>Omits comment headers if enabled from a command text when command type is Stored Procedure for the database providers that do not support comments in a Stored Procedure calls (SQL Server and MySQL).<td>` DatabaseType.Sql</table><h3 id=new-feature---multiple-and-multipleasync-now-support-reader-callbacks>New feature - Multiple and MultipleAsync now support reader callbacks<a class="anchor bookmark-target"href=#new-feature---multiple-and-multipleasync-now-support-reader-callbacks><i class="bi bi-link-45deg"></i></a></h3><p>This was previously missing. Now, it is possible to use reader callbacks with multiple queries:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">var</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">multiple</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">await</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">connection</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #4EC9B0">WithReaderCallback</span><span style="color: #E6E6E6">(</span><span style="color: #4EC9B0">r</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6">> </span><span style="color: #4EC9B0">r</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">Ordinal</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">switch</span></span>
<span class=line><span style="color: #E6E6E6">    {</span></span>
<span class=line><span style="color: #E6E6E6">        0 </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6">> </span><span style="color: #4EC9B0">r</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">Reader</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">GetInt32</span><span style="color: #E6E6E6">(0) + 1,</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #4EC9B0">_</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6">> </span><span style="color: #4EC9B0">null</span></span>
<span class=line><span style="color: #E6E6E6">    })</span></span>
<span class=line><span style="color: #E6E6E6">    .</span><span style="color: #4EC9B0">MultipleAsync</span><span style="color: #E6E6E6">(@"</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #4EC9B0">select</span><span style="color: #E6E6E6"> 1 </span><span style="color: #4EC9B0">as</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">id1</span><span style="color: #E6E6E6">, '</span><span style="color: #4EC9B0">foo1</span><span style="color: #E6E6E6">' </span><span style="color: #4EC9B0">as</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">foo1</span><span style="color: #E6E6E6">, '</span><span style="color: #4EC9B0">bar1</span><span style="color: #E6E6E6">' </span><span style="color: #4EC9B0">as</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">bar1</span><span style="color: #E6E6E6">; </span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">select</span><span style="color: #E6E6E6"> </span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">as</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">id2</span><span style="color: #E6E6E6">, '</span><span style="color: #9CDCFE">foo2</span><span style="color: #E6E6E6">' </span><span style="color: #9CDCFE">as</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">foo2</span><span style="color: #E6E6E6">, '</span><span style="color: #9CDCFE">bar2</span><span style="color: #E6E6E6">' </span><span style="color: #9CDCFE">as</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">bar2</span><span style="color: #E6E6E6">");</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">await</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">ReadAsync</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Record1</span><span style="color: #E6E6E6">>().</span><span style="color: #DCDCAA">SingleAsync</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">next1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Next</span><span style="color: #E6E6E6">(); </span><span style="color: #6A9955">// true</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">result2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">await</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">ReadAsync</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">Record2</span><span style="color: #E6E6E6">>().</span><span style="color: #DCDCAA">SingleAsync</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">next2</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Next</span><span style="color: #E6E6E6">();  </span><span style="color: #6A9955">// false</span></span>
<span class=line></span>
<span class=line><span style="color: #6A9955">// ...</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">var</span><span style="color: #000000"> </span><span style="color: #267F99">multiple</span><span style="color: #000000"> = </span><span style="color: #267F99">await</span><span style="color: #000000"> </span><span style="color: #267F99">connection</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #267F99">WithReaderCallback</span><span style="color: #000000">(</span><span style="color: #267F99">r</span><span style="color: #000000"> => </span><span style="color: #267F99">r</span><span style="color: #000000">.</span><span style="color: #267F99">Ordinal</span><span style="color: #000000"> </span><span style="color: #267F99">switch</span></span>
<span class=line><span style="color: #000000">    {</span></span>
<span class=line><span style="color: #000000">        0 => </span><span style="color: #267F99">r</span><span style="color: #000000">.</span><span style="color: #267F99">Reader</span><span style="color: #000000">.</span><span style="color: #267F99">GetInt32</span><span style="color: #000000">(0) + 1,</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #267F99">_</span><span style="color: #000000"> => </span><span style="color: #267F99">null</span></span>
<span class=line><span style="color: #000000">    })</span></span>
<span class=line><span style="color: #000000">    .</span><span style="color: #267F99">MultipleAsync</span><span style="color: #000000">(@"</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #267F99">select</span><span style="color: #000000"> 1 </span><span style="color: #267F99">as</span><span style="color: #000000"> </span><span style="color: #267F99">id1</span><span style="color: #000000">, '</span><span style="color: #267F99">foo1</span><span style="color: #000000">' </span><span style="color: #267F99">as</span><span style="color: #000000"> </span><span style="color: #267F99">foo1</span><span style="color: #000000">, '</span><span style="color: #267F99">bar1</span><span style="color: #000000">' </span><span style="color: #267F99">as</span><span style="color: #000000"> </span><span style="color: #267F99">bar1</span><span style="color: #000000">; </span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">select</span><span style="color: #000000"> </span><span style="color: #098658">2</span><span style="color: #000000"> </span><span style="color: #267F99">as</span><span style="color: #000000"> </span><span style="color: #001080">id2</span><span style="color: #000000">, '</span><span style="color: #001080">foo2</span><span style="color: #000000">' </span><span style="color: #001080">as</span><span style="color: #000000"> </span><span style="color: #001080">foo2</span><span style="color: #000000">, '</span><span style="color: #001080">bar2</span><span style="color: #000000">' </span><span style="color: #001080">as</span><span style="color: #000000"> </span><span style="color: #001080">bar2</span><span style="color: #000000">");</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result1</span><span style="color: #000000"> = </span><span style="color: #0000FF">await</span><span style="color: #000000"> </span><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">ReadAsync</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Record1</span><span style="color: #000000">>().</span><span style="color: #795E26">SingleAsync</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">next1</span><span style="color: #000000"> = </span><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">Next</span><span style="color: #000000">(); </span><span style="color: #008000">// true</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">result2</span><span style="color: #000000"> = </span><span style="color: #0000FF">await</span><span style="color: #000000"> </span><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">ReadAsync</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Record2</span><span style="color: #000000">>().</span><span style="color: #795E26">SingleAsync</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">next2</span><span style="color: #000000"> = </span><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">Next</span><span style="color: #000000">();  </span><span style="color: #008000">// false</span></span>
<span class=line></span>
<span class=line><span style="color: #008000">// ...</span></span></code></pre></div><h3 id=new-feature---anonymous-read-and-readasync-overloads-for-anonymous-types-added-to-multiple-and-multipleasync>New feature - anonymous Read and ReadAsync overloads for anonymous types added to Multiple and MultipleAsync<a class="anchor bookmark-target"href=#new-feature---anonymous-read-and-readasync-overloads-for-anonymous-types-added-to-multiple-and-multipleasync><i class="bi bi-link-45deg"></i></a></h3><p>This was previously missing. Now, it is possible to map anonymous types with multiple queries:<div class="code csharp"><div class=toolbar><div class="copy-code bi-clipboard"data-bs-toggle=tooltip data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera"data-bs-toggle=tooltip data-bs-title="Copy code image to clipboard"></div></div><pre class=shiki style="background-color: #222222"><code class=code-highlight><span class=line><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">var</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">multiple</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">connection</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">Multiple</span><span style="color: #E6E6E6">(@"</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #4EC9B0">select</span><span style="color: #E6E6E6"> * </span><span style="color: #4EC9B0">from</span><span style="color: #E6E6E6"> (</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #4EC9B0">values</span><span style="color: #E6E6E6"> </span></span>
<span class=line><span style="color: #E6E6E6">        (1, '</span><span style="color: #4EC9B0">foo1</span><span style="color: #E6E6E6">'),</span></span>
<span class=line><span style="color: #E6E6E6">        (2, '</span><span style="color: #4EC9B0">foo2</span><span style="color: #E6E6E6">'),</span></span>
<span class=line><span style="color: #E6E6E6">        (3, '</span><span style="color: #4EC9B0">foo3</span><span style="color: #E6E6E6">')</span></span>
<span class=line><span style="color: #E6E6E6">    ) </span><span style="color: #4EC9B0">t</span><span style="color: #E6E6E6">(</span><span style="color: #4EC9B0">first</span><span style="color: #E6E6E6">, </span><span style="color: #4EC9B0">bar</span><span style="color: #E6E6E6">);</span></span>
<span class=line></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">select</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">*</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">from</span><span style="color: #E6E6E6"> (</span></span>
<span class=line><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">values</span><span style="color: #E6E6E6"> </span></span>
<span class=line><span style="color: #E6E6E6">        (</span><span style="color: #CE9178">'1977-05-19'</span><span style="color: #E6E6E6">::</span><span style="color: #9CDCFE">date</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">true</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">        (</span><span style="color: #CE9178">'1978-05-19'</span><span style="color: #E6E6E6">::</span><span style="color: #9CDCFE">date</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">false</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">'bar2'</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">        (</span><span style="color: #9CDCFE">null</span><span style="color: #E6E6E6">::</span><span style="color: #9CDCFE">date</span><span style="color: #E6E6E6">, </span><span style="color: #569CD6">null</span><span style="color: #E6E6E6">, </span><span style="color: #CE9178">'bar3'</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">    ) </span><span style="color: #DCDCAA">t</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">day</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">bool</span><span style="color: #E6E6E6">, </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #CE9178">")</span><span style="color: #F44747">;</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">first</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">first</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">bar</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">)</span></span>
<span class=line><span style="color: #E6E6E6">}).</span><span style="color: #DCDCAA">ToList</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Next</span><span style="color: #E6E6E6">();</span></span>
<span class=line></span>
<span class=line><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">second</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">multiple</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Read</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span></span>
<span class=line><span style="color: #E6E6E6">{</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">day</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #4EC9B0">DateTime</span><span style="color: #E6E6E6">?),</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">@bool</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">bool</span><span style="color: #E6E6E6">?),</span></span>
<span class=line><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">s</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">default</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">string</span><span style="color: #E6E6E6">),</span></span>
<span class=line><span style="color: #E6E6E6">}).</span><span style="color: #DCDCAA">ToList</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class=shiki style="background-color: #FFFFFF"><code class=code-highlight><span class=line><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">var</span><span style="color: #000000"> </span><span style="color: #267F99">multiple</span><span style="color: #000000"> = </span><span style="color: #267F99">connection</span><span style="color: #000000">.</span><span style="color: #267F99">Multiple</span><span style="color: #000000">(@"</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #267F99">select</span><span style="color: #000000"> * </span><span style="color: #267F99">from</span><span style="color: #000000"> (</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #267F99">values</span><span style="color: #000000"> </span></span>
<span class=line><span style="color: #000000">        (1, '</span><span style="color: #267F99">foo1</span><span style="color: #000000">'),</span></span>
<span class=line><span style="color: #000000">        (2, '</span><span style="color: #267F99">foo2</span><span style="color: #000000">'),</span></span>
<span class=line><span style="color: #000000">        (3, '</span><span style="color: #267F99">foo3</span><span style="color: #000000">')</span></span>
<span class=line><span style="color: #000000">    ) </span><span style="color: #267F99">t</span><span style="color: #000000">(</span><span style="color: #267F99">first</span><span style="color: #000000">, </span><span style="color: #267F99">bar</span><span style="color: #000000">);</span></span>
<span class=line></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">select</span><span style="color: #000000"> * </span><span style="color: #795E26">from</span><span style="color: #000000"> (</span></span>
<span class=line><span style="color: #000000">        </span><span style="color: #001080">values</span><span style="color: #000000"> </span></span>
<span class=line><span style="color: #000000">        (</span><span style="color: #A31515">'1977-05-19'</span><span style="color: #000000">::</span><span style="color: #001080">date</span><span style="color: #000000">, </span><span style="color: #0000FF">true</span><span style="color: #000000">, </span><span style="color: #0000FF">null</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">        (</span><span style="color: #A31515">'1978-05-19'</span><span style="color: #000000">::</span><span style="color: #001080">date</span><span style="color: #000000">, </span><span style="color: #0000FF">false</span><span style="color: #000000">, </span><span style="color: #A31515">'bar2'</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">        (</span><span style="color: #001080">null</span><span style="color: #000000">::</span><span style="color: #001080">date</span><span style="color: #000000">, </span><span style="color: #0000FF">null</span><span style="color: #000000">, </span><span style="color: #A31515">'bar3'</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">    ) </span><span style="color: #795E26">t</span><span style="color: #000000">(</span><span style="color: #001080">day</span><span style="color: #000000">, </span><span style="color: #001080">bool</span><span style="color: #000000">, </span><span style="color: #001080">s</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #A31515">")</span><span style="color: #CD3131">;</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">first</span><span style="color: #000000"> = </span><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">first</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #0000FF">int</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">bar</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #0000FF">string</span><span style="color: #000000">)</span></span>
<span class=line><span style="color: #000000">}).</span><span style="color: #795E26">ToList</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">Next</span><span style="color: #000000">();</span></span>
<span class=line></span>
<span class=line><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">second</span><span style="color: #000000"> = </span><span style="color: #001080">multiple</span><span style="color: #000000">.</span><span style="color: #795E26">Read</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span></span>
<span class=line><span style="color: #000000">{</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">day</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #267F99">DateTime</span><span style="color: #000000">?),</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">@bool</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #0000FF">bool</span><span style="color: #000000">?),</span></span>
<span class=line><span style="color: #000000">    </span><span style="color: #001080">s</span><span style="color: #000000"> = </span><span style="color: #0000FF">default</span><span style="color: #000000">(</span><span style="color: #0000FF">string</span><span style="color: #000000">),</span></span>
<span class=line><span style="color: #000000">}).</span><span style="color: #795E26">ToList</span><span style="color: #000000">();</span></span></code></pre></div><h3 id=internal-improvements>Internal improvements<a class="anchor bookmark-target"href=#internal-improvements><i class="bi bi-link-45deg"></i></a></h3><ul><li>Removed some unused leftovers from before version 4.0.0 on methods <code>Execute</code> and <code>ExecuteAsync</code> which were still using tuple parameters, although they are not supported since 4.0.0.<li>Changed internal instance methods scope modifiers from private to protected to improve future extendibility.<li>Removed unnecessary type caching. They give no performance gains and are using memory. No need to have them.<li>Remove unnecessary and obsolete instance managament mechanism: improves memory and perfomances a bit.<li>Many other improvements for internal structure that allow for future extendibility.</ul></div><footer class="py-5 px-5 container svelte-1nj15r2"><div class=row><div class="col svelte-1nj15r2"><a class="btn-link rl-arrow svelte-1nj15r2"target=_blank href=https://github.com/vb-consulting/Norm.net>Repository <i class="bi bi-github"></i></a> <a class="btn-link rl-arrow svelte-1nj15r2"target=_blank href=https://github.com/vb-consulting/Norm.net/issues>Issues <i class="bi bi-github"></i></a> <a class="btn-link rl-arrow svelte-1nj15r2"target=_blank href=https://github.com/vb-consulting/Norm.net/discussions>Discussions <i class="bi bi-github"></i></a><div class=text-muted>© VB-Software & VB-Consulting 2023</div></div></div></footer></div><div class="rightside svelte-1qdmkpb"><div class=svelte-1qdmkpb><ul class="navbar-nav sidenav svelte-1qdmkpb"><li class="nav-txt-divider text-muted svelte-1qdmkpb"><hr class=svelte-1qdmkpb><span class=svelte-1qdmkpb>on this page</span><hr class=svelte-1qdmkpb><li class="nav-item toc1 right svelte-1qdmkpb bookmark-nav"data-id=changelog title=Changelog><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#changelog>Changelog</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=539-2023-10-07 title="5.3.9 (2023-10-07)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#539-2023-10-07>5.3.9 (2023-10-07)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=538-2023-09-07 title="5.3.8 (2023-09-07)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#538-2023-09-07>5.3.8 (2023-09-07)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=537-2023-07-17 title="5.3.7 (2023-07-17)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#537-2023-07-17>5.3.7 (2023-07-17)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature-nameparsercallback-option title="New feature NameParserCallback option"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature-nameparsercallback-option>New feature NameParserCallback option</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=more-internal-optimizations title="More internal optimizations"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#more-internal-optimizations>More internal optimizations</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=changed-access-modifiers-for-internal-mappers title="Changed access modifiers for internal mappers"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#changed-access-modifiers-for-internal-mappers>Changed access modifiers for internal mappers</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=536-2023-07-02 title="5.3.6 (2023-07-02)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#536-2023-07-02>5.3.6 (2023-07-02)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=global-handler-for-reader-callback title="Global handler for reader callback"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#global-handler-for-reader-callback>Global handler for reader callback</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=535-2023-07-01 title="5.3.5 (2023-07-01)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#535-2023-07-01>5.3.5 (2023-07-01)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=534-2023-05-26 title="5.3.4 (2023-05-26)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#534-2023-05-26>5.3.4 (2023-05-26)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-option---keeporiginalnames title="New option - KeepOriginalNames"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-option---keeporiginalnames>New option - KeepOriginalNames</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-optimization-and-new-performance-tests title="New optimization and new performance tests"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-optimization-and-new-performance-tests>New optimization and new performance tests</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=533-2023-05-16 title="5.3.3 (2023-05-16)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#533-2023-05-16>5.3.3 (2023-05-16)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=fix---nullableinstances-option-turned-on-but-have-non-nullable-properties title="Fix - NullableInstances option turned on but have non-nullable properties"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#fix---nullableinstances-option-turned-on-but-have-non-nullable-properties>Fix - NullableInstances option turned on but have non-nullable properties</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature---normnullexception title="New feature - NormNullException"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature---normnullexception>New feature - NormNullException</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=532-2023-05-03 title="5.3.2 (2023-05-03)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#532-2023-05-03>5.3.2 (2023-05-03)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature---nullableinstances title="New Feature - NullableInstances"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature---nullableinstances>New Feature - NullableInstances</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=improvements title=Improvements><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#improvements>Improvements</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=531-2022-11-18 title="5.3.1 (2022-11-18)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#531-2022-11-18>5.3.1 (2022-11-18)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=530-2022-10-16 title="5.3.0 (2022-10-16)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#530-2022-10-16>5.3.0 (2022-10-16)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature---dynamic-mapping-support title="New feature - dynamic mapping support"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature---dynamic-mapping-support>New feature - dynamic mapping support</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=fix---duplicate-field-names-in-multi-mapping title="Fix - duplicate field names in multi mapping"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#fix---duplicate-field-names-in-multi-mapping>Fix - duplicate field names in multi mapping</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-benchmarks title="New benchmarks"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-benchmarks>New benchmarks</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=525-2022-10-06 title="5.2.5 (2022-10-06)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#525-2022-10-06>5.2.5 (2022-10-06)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=524-2022-10-04 title="5.2.4 (2022-10-04)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#524-2022-10-04>5.2.4 (2022-10-04)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=523-2022-07-08 title="5.2.3 (2022-07-08)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#523-2022-07-08>5.2.3 (2022-07-08)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=522-2022-07-05 title="5.2.2 (2022-07-05)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#522-2022-07-05>5.2.2 (2022-07-05)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=521-2022-06-26 title="5.2.1 (2022-06-26)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#521-2022-06-26>5.2.1 (2022-06-26)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=support-for-specific-parameter-types-when-using-postgresql-native-positional-parameters title="Support for specific parameter types when using PostgreSQL native positional parameters"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#support-for-specific-parameter-types-when-using-postgresql-native-positional-parameters>Support for specific parameter types when using PostgreSQL native positional parameters</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=520-2022-06-23 title="5.2.0 (2022-06-23)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#520-2022-06-23>5.2.0 (2022-06-23)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=support-for-postgresql-native-positional-parameters---npgsql-postgresql-6-only title="Support for PostgreSQL native positional parameters - Npgsql (PostgreSQL) 6+ only"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#support-for-postgresql-native-positional-parameters---npgsql-postgresql-6-only>Support for PostgreSQL native positional parameters - Npgsql (PostgreSQL) 6+ only</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=npgsqlenablesqlrewriting-global-setting---npgsql-postgresql-6-only title="NpgsqlEnableSqlRewriting global setting - Npgsql (PostgreSQL) 6+ only"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#npgsqlenablesqlrewriting-global-setting---npgsql-postgresql-6-only>NpgsqlEnableSqlRewriting global setting - Npgsql (PostgreSQL) 6+ only</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=withunknownresulttypeparams-bool-list-connection-extension-method---npgsql-postgresql-6-only title="WithUnknownResultType(params bool[] list) connection extension method - Npgsql (PostgreSQL) 6+ only"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withunknownresulttypeparams-bool-list-connection-extension-method---npgsql-postgresql-6-only>WithUnknownResultType(params bool[] list) connection extension method - Npgsql (PostgreSQL) 6+ only</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=510-2022-06-20 title="5.1.0 (2022-06-20)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#510-2022-06-20>5.1.0 (2022-06-20)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=withcommandbehaviorcommandbehavior-connection-extension-method title="WithCommandBehavior(CommandBehavior) connection extension method"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withcommandbehaviorcommandbehavior-connection-extension-method>WithCommandBehavior(CommandBehavior) connection extension method</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=parameters-can-be-set-again-in-rea-and-execute-extensions-methods title="Parameters can be set again in Rea` and Execute extensions methods"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#parameters-can-be-set-again-in-rea-and-execute-extensions-methods>Parameters can be set again in Rea` and Execute extensions methods</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=withtransactiondbtransaction-connection-extension-method title=" connection extension method"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withtransactiondbtransaction-connection-extension-method>connection extension method</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=withtimeout-connection-extension-method title="WithTimeout connection extension method"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withtimeout-connection-extension-method>WithTimeout connection extension method</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=mapprivatesetters-global-option title="MapPrivateSetters global option"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#mapprivatesetters-global-option>MapPrivateSetters global option</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=multiple-readers-now-implement-iasyncdisposable title="Multiple readers now implement "><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#multiple-readers-now-implement-iasyncdisposable>Multiple readers now implement</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=changed-member-scope-from-internal-to-allow-greater-extendibility title="Changed member scope from internal to allow greater extendibility"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#changed-member-scope-from-internal-to-allow-greater-extendibility>Changed member scope from internal to allow greater extendibility</a><li class="nav-item toc2 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=501-2022-06-16 title="5.0.1 (2022-06-16)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#501-2022-06-16>5.0.1 (2022-06-16)</a><li class="nav-item toc2 right svelte-1qdmkpb bookmark-nav"data-id=500-2022-05-24 title="5.0.0 (2022-05-24)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#500-2022-05-24>5.0.0 (2022-05-24)</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature---comment-headers title="New feature - comment headers"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature---comment-headers>New feature - comment headers</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-method-extensions title="New method extensions"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-method-extensions>New method extensions</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withparametersparams-object-parameters title="WithParameters(params object[] parameters)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withparametersparams-object-parameters>WithParameters(params object[] parameters)</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withcommandcallbackactiondbcommand-dbcommandcallback title="WithCommandCallback(Action dbCommandCallback)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withcommandcallbackactiondbcommand-dbcommandcallback>WithCommandCallback(Action dbCommandCallback)</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withreadercallbackfuncstring-name-int-ordinal-dbdatareader-reader-object-readercallback title="WithReaderCallback(Func<(string Name, int Ordinal, DbDataReader Reader), object> readerCallback)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withreadercallbackfuncstring-name-int-ordinal-dbdatareader-reader-object-readercallback>WithReaderCallback(Func&lt;(string Name, int Ordinal, DbDataReader Reader), object> readerCallback)</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withcommentstring-comment title="WithComment(string comment)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withcommentstring-comment>WithComment(string comment)</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withcommentparameters title=WithCommentParameters()><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withcommentparameters>WithCommentParameters()</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withcommentcallerinfo title=WithCommentCallerInfo()><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withcommentcallerinfo>WithCommentCallerInfo()</a><li class="nav-item toc4 right svelte-1qdmkpb bookmark-nav"data-id=withcommentheaderstring-comment--null-bool-includecommandattributes--true-bool-includeparameters--true-bool-includecallerinfo--true-bool-includetimestamp--false title="WithCommentHeader(string comment = null, bool includeCommandAttributes = true, bool includeParameters = true, bool includeCallerInfo = true, bool includeTimestamp = false)"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#withcommentheaderstring-comment--null-bool-includecommandattributes--true-bool-includeparameters--true-bool-includecallerinfo--true-bool-includetimestamp--false>WithCommentHeader(string comment = null, bool includeCommandAttributes = true, bool includeParameters = true, bool includeCallerInfo = true, bool includeTimestamp = false)</a><li class="nav-item toc3 mt-4 right svelte-1qdmkpb bookmark-nav"data-id=global-configuration title="Global Configuration"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#global-configuration>Global Configuration</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature---multiple-and-multipleasync-now-support-reader-callbacks title="New feature - Multiple and MultipleAsync now support reader callbacks"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature---multiple-and-multipleasync-now-support-reader-callbacks>New feature - Multiple and MultipleAsync now support reader callbacks</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=new-feature---anonymous-read-and-readasync-overloads-for-anonymous-types-added-to-multiple-and-multipleasync title="New feature - anonymous Read and ReadAsync overloads for anonymous types added to Multiple and MultipleAsync"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#new-feature---anonymous-read-and-readasync-overloads-for-anonymous-types-added-to-multiple-and-multipleasync>New feature - anonymous Read and ReadAsync overloads for anonymous types added to Multiple and MultipleAsync</a><li class="nav-item toc3 right svelte-1qdmkpb bookmark-nav"data-id=internal-improvements title="Internal improvements"><a class="nav-link auto-close svelte-1qdmkpb bookmark-link"href=#internal-improvements>Internal improvements</a></ul></div></div></main><script>!function(){var i=document.querySelector("nav.navbar"),L=document.getElementsByTagName("main")[0],E=L.getElementsByClassName("sidebar")[0],k=L.getElementsByClassName("content")[0],a=document.querySelectorAll("div.code");function w(e,t){for(var n=2;n<arguments.length;n++)e.classList.remove(arguments[n]);e.classList.add(t)}var t=document.getElementsByTagName("html")[0],s=i.querySelector("#theme-btn"),o="theme";function n(e){var t=s.getElementsByTagName("svg");"dark"===e?(t[0].style.display="",t[1].style.display="none",s.getElementsByClassName("check")[0].classList.add("checked")):(t[0].style.display="none",t[1].style.display="",s.getElementsByClassName("check")[0].classList.remove("checked"));for(var n=0;n<a.length;n++){var i=a[n];"dark"===e?(i.children[1].style.display="inherit",i.children[2].style.display="none"):"light"===e&&(i.children[1].style.display="none",i.children[2].style.display="inherit")}}function l(e,t){var n=e.currentTarget;if(!n.classList.contains("bi-check")){for(var i="",a=0;a<n.classList.length;a++)if(n.classList[a].startsWith("bi-")){i=n.classList[a];break}n.classList.remove(i),n.classList.add("spinner-border-sm"),n.classList.add("spinner-border");e=bootstrap.Tooltip.getInstance(n);e&&(e.setContent({".tooltip-inner":"Copying..."}),e.show()),t(n,function(){var e;n.classList.remove(i),n.classList.remove("spinner-border-sm"),n.classList.remove("spinner-border"),n.classList.add("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&(e.setContent({".tooltip-inner":"Copied!"}),e.show()),setTimeout(function(){var e;n.classList.add(i),n.classList.remove("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&e.setContent({".tooltip-inner":n.dataset.bsTitle})},2e3)})}}function e(e){l(e,function(e,t){navigator.clipboard.writeText(e.parentElement.nextSibling.innerText),t()})}function r(e){l(e,function(e,t){var n=localStorage.getItem(o);e="dark"===n?e.parentElement.parentElement.children[1]:e.parentElement.parentElement.children[2],setTimeout(function(){html2canvas(e).then(e=>{e.toBlob(e=>navigator.clipboard.write([new ClipboardItem({"image/png":e})])),t()})},0)})}s.addEventListener("click",()=>{var e="dark"===localStorage.getItem(o)?"light":"dark";localStorage.setItem(o,e),n(t.dataset.bsTheme=e)}),n(localStorage.getItem(o)),s.children[0].classList.remove("hidden");for(var c=0;c<a.length;c++)a[c].getElementsByClassName("copy-code")[0].addEventListener("click",e),a[c].getElementsByClassName("photo-code")[0].addEventListener("click",r);for(var d,T=function(){var s,a,o;if("none"!=L.children[2].style.display)return s=L.children[1].children[0].querySelectorAll("[id]"),a=void 0,this.initNavs=function(e){o=e.querySelectorAll("li.bookmark-nav");for(var t=0;t<s.length;t++){for(var n=s[t].id,i=null,a=0;a<o.length;a++)if(o[a].dataset.id==n){i=o[a];break}s[t].nav=i}setTimeout(function(){for(var e=0;e<s.length;e++){var t=s[e];if(l(t).visible&&t.nav)return void t.nav.classList.add("active")}},1e3),r()},L.children[1].addEventListener("scroll",r),this;function l(e){var e=e.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight),n=0<e.top&&!(e.bottom<0||0<=e.top-t)||e.top<0&&e.bottom>t,i=!1;return{visible:n,above:i=n?i:e.bottom<t}}function r(){if(o&&o.length){for(var e=0;e<o.length;e++)o[e].classList.remove("active");for(var t=void 0,e=0;e<s.length;e++){const i=s[e];var n=l(i);if(!n.visible&&n.above&&(t=i.nav),n.visible&&i.nav&&!i.nav.classList.contains("active"))return i.nav.classList.add("active"),a&&clearTimeout(a),void(a=setTimeout(function(){i.nav.scrollIntoView({behavior:"smooth"}),a=void 0},250))}t&&!t.classList.contains("active")&&(t.classList.add("active"),a&&clearTimeout(a),a=setTimeout(function(){t.scrollIntoView({behavior:"smooth"}),a=void 0},250))}}}(),v=function(){var l,r=i.querySelector("#nav-btn"),c=E.firstChild.getElementsByTagName("button")[0],d=480,v="200px",h="0.25fr",m=730,u=535,g=L.children[0].children[0].children[1],b=L.children[2].children[0].children[0],e="sidebar-pinned",p=null==localStorage.getItem(e)||"true"==localStorage.getItem(e),y=!1,f=!1;function t(){var e=window.outerWidth||window.innerWidth,t=e<d,n=t?y?"100%":"0":p?""+v:"0",i=`grid-template-columns: ${n} 1fr`,a=t&&y?"width: 100%":"0"!=n?"":"display: none",s=t&&y?"display: none":"",o=t?y?"sidebar-show":"sidebar-hide":p?"sidebar-show":"sidebar-hide",n="0"==n;h&&m&&u&&(n&&e<u||!n&&e<m?f||(g.innerHTML=l+b.innerHTML,T.initNavs(g),f=!0):f&&(g.innerHTML=l,T.initNavs(b),f=!1)),!h||t||f?(i+=";",L.children[2].style.display="none"):(i+=` ${h};`,L.children[2].style.display=""),w(r,!t&&p||t&&y?"rotate":"rotate-back","rotate","rotate-back"),L.style=i,w(E,o,"sidebar-show","sidebar-hide"),E.firstChild.style=a,c.style.display=t?"":"none",k.style=s}function n(){window.outerWidth<d?y=!y:p=!p,localStorage.setItem(e,p.toString()),t()}return h&&m&&u&&(l=g.innerHTML,T.initNavs(b)),r.addEventListener("click",n),c.addEventListener("click",()=>{y=!1,t()}),(window.onresize=t)(),this.closeSidebar=function(){window.outerWidth<d&&y&&n()},this}(),h=document.getElementsByClassName("auto-close"),m=0;m<h.length;m++)h[m].addEventListener("click",function(e){v.closeSidebar()});location.hash&&(d=document.getElementById(location.hash.replace("#","")))&&d.scrollIntoView()}();</script><script src=/bootstrap.bundle.min.js></script><script>!function(){for(var t=document.querySelectorAll('[data-bs-toggle="tooltip"]'),e=0;e<t.length;e++)new bootstrap.Tooltip(t[e]);var o=document.getElementsByClassName("accordion-item");if(o.length)for(e=0;e<o.length;e++){var l=o[e];l.querySelectorAll("[href='"+document.location.pathname+"']").length&&l.firstChild.click()}}();</script><script src=/html2canvas.min.js></script><script async defer src=https://buttons.github.io/buttons.js></script>