<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>pgmigrations</title><meta name="description" content="Lightweight, Zero-Dependency, PostgreSQL Tool for Node.js and NPM."><meta name="keywords" content="postgresql, sql, migrationsm, schema, dump, unit tests"><link href="https://vb-consulting.github.io//pgmigrations/" rel="canonical"><link rel="stylesheet" href="/_elderjs/assets/svelte-0e23f477.css" media="all"><style></style><link href="/style.css?1754739439351" rel="stylesheet"><script>!function(){var e="theme",t=localStorage.getItem(e);t||(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",localStorage.setItem(e,t)),document.getElementsByTagName("html")[0].dataset.bsTheme=t}();</script></head><body class="d-flex flex-column h-100"><header id="header"><nav class="navbar navbar-expand-md navbar-dark fixed-top py-0 py-md-0 svelte-30jr7w"><div class="container-fluid flex-nowrap svelte-30jr7w"><div class="d-flex svelte-30jr7w"><button id="nav-btn" type="button" class="d-flex btn btn-sm logo animate-rotate svelte-30jr7w"><i class="material-icons-outlined">menu</i></button> <a class="nav-link my-auto ms-2 fw-semibold home svelte-30jr7w" href="/"><i class="bi-chevron-double-left"></i> VB Home</a></div><div class="d-flex right svelte-30jr7w"><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Become a Patreon" href="https://www.patreon.com/vbconsulting" target="_blank"><div class="patreon"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Buy Me a Coffee" href="https://www.buymeacoffee.com/vbilopavu" target="_blank"><div class="bmc"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto me-2 svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="pgmigrations on GitHub" href="https://github.com/vb-consulting/pgmigrations"><i class="bi-github"></i></a> <a class="github-button svelte-30jr7w" href="https://github.com/vb-consulting/pgmigrations" data-bs-toggle="tooltip" data-bs-html="true" title="Star pgmigrations on GitHub" data-color-scheme="no-preference: light_high_contrast; light: light_high_contrast; dark: light_high_contrast;" data-icon="octicon-star" data-show-count="true" aria-label="Star pgmigrations on GitHub"></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><button id="theme-btn" type="button" aria-pressed="true" aria-label="theme" class="svelte-30jr7w"><span class="check hidden svelte-30jr7w"><span class="icon svelte-30jr7w"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><path fill="currentColor" d="M12 21q-3.775 0-6.388-2.613T3 12q0-3.45 2.25-5.988T11 3.05q.625-.075.975.45t-.025 1.1q-.425.65-.638 1.375T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q.775 0 1.538-.225t1.362-.625q.525-.35 1.075-.037t.475.987q-.35 3.45-2.937 5.725T12 21Zm0-2q2.2 0 3.95-1.213t2.55-3.162q-.5.125-1 .2t-1 .075q-3.075 0-5.238-2.163T9.1 7.5q0-.5.075-1t.2-1q-1.95.8-3.163 2.55T5 12q0 2.9 2.05 4.95T12 19Zm-.25-6.75Z"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M0 0h24v24H0z"></path><path fill="currentColor" d="M12 19a1 1 0 0 1 .993.883L13 20v1a1 1 0 0 1-1.993.117L11 21v-1a1 1 0 0 1 1-1zm6.313-2.09l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7a1 1 0 0 1 1.218-1.567l.102.07zm-11.306.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM4 11a1 1 0 0 1 .117 1.993L4 13H3a1 1 0 0 1-.117-1.993L3 11h1zm17 0a1 1 0 0 1 .117 1.993L21 13h-1a1 1 0 0 1-.117-1.993L20 11h1zM6.213 4.81l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7A1 1 0 0 1 6.11 4.74l.102.07zm12.894.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM12 2a1 1 0 0 1 .993.883L13 3v1a1 1 0 0 1-1.993.117L11 4V3a1 1 0 0 1 1-1zm0 5a5 5 0 1 1-4.995 5.217L7 12l.005-.217A5 5 0 0 1 12 7z"></path></g></svg></span></span></button></div></div></nav></header><main class="svelte-9zwk14"><div class="sidebar sidebar-hide svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav svelte-9zwk14"><li class="nav-item svelte-9zwk14" data-id="" title="VB-Consulting"><a class="nav-link svelte-9zwk14 text-uppercase" href="/">VB-Consulting</a></li><li class="nav-divider svelte-9zwk14"><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/">NpgsqlRest</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="Norm.Net"><a class="nav-link svelte-9zwk14 text-uppercase" href="/norm.net/">Norm.Net</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="RazorSvelte"><a class="nav-link svelte-9zwk14 text-uppercase" href="/razorsvelte/">RazorSvelte</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PgRoutiner"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgroutiner/">PgRoutiner</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="XUnit.Npgsql"><a class="nav-link svelte-9zwk14 text-uppercase" href="/xunit.npgsql/">XUnit.Npgsql</a></li><li class="nav-item toc2 svelte-9zwk14 active" data-id="" title="pgmigrations"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgmigrations/">pgmigrations</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PostrgeSQL Schema Tools"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pg_schema_tools/">PostrgeSQL Schema Tools</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">blogs</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="See all blogs..."><a class="nav-link btn btn-sm w-fit px-3 mx-auto svelte-9zwk14 lr-arrow text-uppercase" href="/blogs/"><i class="bi bi-arrow-right-circle svelte-9zwk14"></i> <span class="btn-link">ALL BLOGS</span></a></li><li class="nav-item svelte-9zwk14" data-id="" title="WebAPI Load Tests PostgreSQL Function"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/load-test/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>WebAPI Load Tests</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Automatic REST API for PostgreSQL Database"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-v2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest v2 Update üêòüî•</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Automatic REST API for PostgreSQL Database"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-update1.6.2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest Update 1.6.2</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/todo/part1-todo-requirements/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Unit Testing and TDD With PostgreSQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/unit-testing-postgresql/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Unit Testing and TDD With PostgreSQL is Easy</a></li><li class="nav-item svelte-9zwk14" data-id="" title="From Transaction Scripts and Domain Model to SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/domain-model-transaction-script/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>From Transaction Scripts and Domain Model to SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Transaction Script DDD vs SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/transaction-script/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Transaction Script DDD vs SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Common Sense Software Design Approach for RDBMS-backed Type of Software"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/common-sense-design/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Common Sense Software Design</a></li><li class="nav-item svelte-9zwk14" data-id="" title="PostgreSQL Array Example"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-array/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>PostgreSQL Arrays üêò</a></li><li class="nav-item svelte-9zwk14" data-id="" title="How DDD is screwing up your SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/sql-vs-ddd/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>How DDD is screwing up your SQL</a></li></ul></div></div><div class="content svelte-9zwk14"><div class="container-sm main-content gh-content"><h1 id="pgmigrations">PgMigrations<a class="anchor bookmark-target" href="#pgmigrations"><i class="bi bi-link-45deg"></i></a></h1><a href="https://github.com/vb-consulting/pgmigrations" class="github-edit"><i class="bi bi-github"></i>Edit this page on GitHub</a><p><img src="https://badge.fury.io/js/pgmigrations.svg" alt="npm version"> <img src="https://img.shields.io/badge/license-MIT-green" alt="License"> <img src="https://img.shields.io/github/stars/vb-consulting/pgmigrations?style=social" alt="GitHub Stars"> <img src="https://img.shields.io/github/forks/vb-consulting/pgmigrations?style=social" alt="GitHub Forks"></p><p>Lightweight, Zero-Dependency, PostgreSQL Tool for Node.js and NPM. You can:</p><ul><li>Run Migrations Up or Down (Repeatable, Version, Before or After).</li><li>Run Arbitrary <code>psql</code> Commands by using your Project Configuration.</li><li>Create Database Schema Dumps by using your Project Configuration.</li><li>Run PostgreSQL Database Unit Tests in Functions or Procedures.</li></ul><p>Use the <code>pgmigrations</code> command to manage migrations and run database commands:</p><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations --help</span></span>
<span class="line"><span style="color: #E6E6E6">Usage:</span></span>
<span class="line"><span style="color: #E6E6E6"> pgmigrations [command] [switches]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">Commands:</span></span>
<span class="line"><span style="color: #E6E6E6">up               Run migrations migrations in order: before, before repeatable, up, repeatable, after. Optional switches: --list, --dry, --full, --dump. </span></span>
<span class="line"><span style="color: #E6E6E6">down             Run only down migrations. Optional switches: --list, --dry, --full, --dump. </span></span>
<span class="line"><span style="color: #E6E6E6">history          console.log the current migration schema history.</span></span>
<span class="line"><span style="color: #E6E6E6">run | exec       Run a command or a script file or script directory with psql. Command text or a script file is required as the second argument. Any additional arguments will be passed to a psql command.</span></span>
<span class="line"><span style="color: #E6E6E6">dump | schema    Run pg_dump command with --schema-only --encoding=UTF8 swtiches on (plus schemaDumpAdditionalArgs from the config). Any additional arguments will be passed to pg_dump command. </span></span>
<span class="line"><span style="color: #E6E6E6">psql             Run arbitrary psql command or open psql shell. Any additional arguments will be passed to a psql. </span></span>
<span class="line"><span style="color: #E6E6E6">test             Run database tests. </span></span>
<span class="line"><span style="color: #E6E6E6">config           console.log the current configuration. </span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">Switches:</span></span>
<span class="line"><span style="color: #E6E6E6">-h, --help       Show help </span></span>
<span class="line"><span style="color: #E6E6E6">--list           List available migrations in this direction (up or down) or list available database tests. </span></span>
<span class="line"><span style="color: #E6E6E6">--dry            Run in the migrations dry run mode on database in this direction (up or down). No changes will be made to the database (rollbacks changes). </span></span>
<span class="line"><span style="color: #E6E6E6">--full           Executes all migrations in this direction (up or down). Schema history will be ignored.</span></span>
<span class="line"><span style="color: #E6E6E6">--dump           Dump the SQL for the migration to the console instead of executing it.</span></span>
<span class="line"><span style="color: #E6E6E6">--verbose        Run in verbose mode. This switch applies to all commands. Default is false.</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E6E6E6">Configurations files:</span></span>
<span class="line"><span style="color: #E6E6E6">                 ./db.js from the current dir is the default configuration file. It will be ignored if not found.</span></span>
<span class="line"><span style="color: #E6E6E6">--config=[file]  Set the custom config file or multiple files (multiple --config switches). Config files are merged in the order they are provided.</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations --help</span></span>
<span class="line"><span style="color: #000000">Usage:</span></span>
<span class="line"><span style="color: #000000"> pgmigrations [command] [switches]</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">Commands:</span></span>
<span class="line"><span style="color: #000000">up               Run migrations migrations in order: before, before repeatable, up, repeatable, after. Optional switches: --list, --dry, --full, --dump. </span></span>
<span class="line"><span style="color: #000000">down             Run only down migrations. Optional switches: --list, --dry, --full, --dump. </span></span>
<span class="line"><span style="color: #000000">history          console.log the current migration schema history.</span></span>
<span class="line"><span style="color: #000000">run | exec       Run a command or a script file or script directory with psql. Command text or a script file is required as the second argument. Any additional arguments will be passed to a psql command.</span></span>
<span class="line"><span style="color: #000000">dump | schema    Run pg_dump command with --schema-only --encoding=UTF8 swtiches on (plus schemaDumpAdditionalArgs from the config). Any additional arguments will be passed to pg_dump command. </span></span>
<span class="line"><span style="color: #000000">psql             Run arbitrary psql command or open psql shell. Any additional arguments will be passed to a psql. </span></span>
<span class="line"><span style="color: #000000">test             Run database tests. </span></span>
<span class="line"><span style="color: #000000">config           console.log the current configuration. </span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">Switches:</span></span>
<span class="line"><span style="color: #000000">-h, --help       Show help </span></span>
<span class="line"><span style="color: #000000">--list           List available migrations in this direction (up or down) or list available database tests. </span></span>
<span class="line"><span style="color: #000000">--dry            Run in the migrations dry run mode on database in this direction (up or down). No changes will be made to the database (rollbacks changes). </span></span>
<span class="line"><span style="color: #000000">--full           Executes all migrations in this direction (up or down). Schema history will be ignored.</span></span>
<span class="line"><span style="color: #000000">--dump           Dump the SQL for the migration to the console instead of executing it.</span></span>
<span class="line"><span style="color: #000000">--verbose        Run in verbose mode. This switch applies to all commands. Default is false.</span></span>
<span class="line"></span>
<span class="line"><span style="color: #000000">Configurations files:</span></span>
<span class="line"><span style="color: #000000">                 ./db.js from the current dir is the default configuration file. It will be ignored if not found.</span></span>
<span class="line"><span style="color: #000000">--config=[file]  Set the custom config file or multiple files (multiple --config switches). Config files are merged in the order they are provided.</span></span></code></pre></div><p>Examples:</p><ul><li>Execute a query:</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations run </span><span style="color: #CE9178">"select * from city"</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations run </span><span style="color: #A31515">"select * from city"</span></span></code></pre></div></div><ul><li>Execute a script:</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations run ./script1.sql</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations run ./script1.sql</span></span></code></pre></div></div><ul><li>Execute a list of sql files in a dir:</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations run ./dir</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations run ./dir</span></span></code></pre></div></div><ul><li>List all tables</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations run </span><span style="color: #D7BA7D">\d</span><span style="color: #E6E6E6">t</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations run </span><span style="color: #EE0000">\d</span><span style="color: #000000">t</span></span></code></pre></div></div><ul><li>Display psql help</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations run --help</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations run --help</span></span></code></pre></div></div><ul><li>Enter the psql interactive mode</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations psql</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations psql</span></span></code></pre></div></div><ul><li>Display database schema to console</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations dump</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations dump</span></span></code></pre></div></div><ul><li>Write database schema to file</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations dump --file schema.sql</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations dump --file schema.sql</span></span></code></pre></div></div><ul><li>List all available migrations</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations up --list</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations up --list</span></span></code></pre></div></div><ul><li>Run all UP migrations</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations up</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations up</span></span></code></pre></div></div><ul><li>Run database tests</li></ul><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">> npx pgmigrations test</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">> npx pgmigrations test</span></span></code></pre></div></div><p>Etc.</p><p>Notes:</p><p>This tool spawns <code>psql</code> or <code>pg_dump</code> external processes to execute database commands. That means, that PostgreSQL client tools must be installed on the system to be able to use this package. PostgreSQL client tools are distributed with the default installation so most likely you already have them pre-installed.</p><p>If you don't, there is an option to install client tools only:</p><ul><li>On Linux systems, there is a <code>postgresql-client</code> package, the apt installation would be then: <code>$ apt-get install -y postgresql-client</code> for the latest version.</li><li>On Windows systems, there is an option to install client tools only in the official installer.</li></ul><p>The <code>db</code> tool from this package will pass your configuration to the PostgreSQL tools to be able to manage the database.</p><h2 id="migration-naming-convention">Migration Naming Convention<a class="anchor bookmark-target" href="#migration-naming-convention"><i class="bi bi-link-45deg"></i></a></h2><h3 id="versioned-migrations">Versioned Migrations<a class="anchor bookmark-target" href="#versioned-migrations"><i class="bi bi-link-45deg"></i></a></h3><p><code>[prefix][version][separator][description][suffix]</code></p><p>Versioned migrations run once per version number in order of the versions.</p><p>Versioned migrations can be:</p><ol><li>Version (version up).</li><li>Undo (version down).</li></ol><p><code>V001__my_migration.sql</code></p><p><code>U002__undo_my_migration.sql</code></p><ul><li><code>V</code> is a prefix for migration up. This version migration. Prefix is configurable.</li><li><code>U</code> is a prefix for migration down. This undo migration. Prefix is configurable.</li><li><code>002</code> is version info or the version number but it can be any text or number.</li><li><code>__</code> is a separator. Separator is configurable.</li><li><code>my_migration</code> and <code>undo_my_migration</code> are migration descriptions. This goes to the migration table as the description without underscores.</li><li><code>.sql</code> is the migration suffix. This goes to the migration table as the type with the removed dot and in uppercase.</li></ul><h3 id="repeatable-migrations">Repeatable Migrations<a class="anchor bookmark-target" href="#repeatable-migrations"><i class="bi bi-link-45deg"></i></a></h3><p><code>[prefix][separator][description][suffix]</code></p><p>Repeatable migrations can be:</p><ol><li>Repeatable migration: executed only once per file content. This migration will be executed only if the content is changed.</li><li>Repeatable before: as the normal repeatable, only run before version migration.</li><li>Before and after migrations. Migrations are executed always regardless of content.</li></ol><p>Examples:</p><p><code>R__my_migration.sql</code></p><p><code>_R__my_migration.sql</code></p><p><code>_A__my_migration.sql</code></p><p><code>_B__my_migration.sql</code></p><ul><li><code>R</code> is a prefix for repeatable migration. Prefix is configurable.</li><li><code>_R</code> is a prefix for repeatable before migration. Prefix is configurable.</li><li><code>_B</code> is a prefix for before migration. Prefix is configurable.</li><li><code>_A</code> is a prefix for before migration. Prefix is configurable.</li><li><code>__</code> is a separator. Separator is configurable.</li><li><code>my_migration</code> and <code>undo_my_migration</code> are migration descriptions. This goes to the migration table as the description without underscores.</li><li><code>.sql</code> is the migration suffix. This goes to the migration table as the type with the removed dot and in uppercase.</li></ul><h3 id="finalize-migrations">Finalize Migrations<a class="anchor bookmark-target" href="#finalize-migrations"><i class="bi bi-link-45deg"></i></a></h3><p>Finalize migrations have defualt prefix <code>TEST</code>. Finalize migrations will always be executed as a separate files, not part of of the migration transaction.</p><p>This is convinient place to keep TEST scripts.</p><h2 id="migration-order">Migration Order<a class="anchor bookmark-target" href="#migration-order"><i class="bi bi-link-45deg"></i></a></h2><ol><li>Before Migrations</li><li>Repeatable Before Migrations</li><li>Repeatable Migrations</li><li>Versioned Migrations</li><li>After Migrations</li></ol><h2 id="configuration">Configuration<a class="anchor bookmark-target" href="#configuration"><i class="bi bi-link-45deg"></i></a></h2><p>The tool will try to read the default configuration file from the running location: <code>db.js</code>.</p><p>Additional configuration files can be loaded with a command line switch <code>--config=[file]</code>. They will be loaded and merged in the order they appear, while the default configuration <code>db.js</code> is always first (if it exists).</p><p>Example of the configuration file:</p><div class="code js"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #4EC9B0">module</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">exports</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">host:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"localhost"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">port:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"5432"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">dbname:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"dvdrental"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">username:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"postgres"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">password:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"postgres"</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #267F99">module</span><span style="color: #000000">.</span><span style="color: #267F99">exports</span><span style="color: #000000"> = {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">host:</span><span style="color: #000000"> </span><span style="color: #A31515">"localhost"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">port:</span><span style="color: #000000"> </span><span style="color: #A31515">"5432"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">dbname:</span><span style="color: #000000"> </span><span style="color: #A31515">"dvdrental"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">username:</span><span style="color: #000000"> </span><span style="color: #A31515">"postgres"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">password:</span><span style="color: #000000"> </span><span style="color: #A31515">"postgres"</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>Any key in this configuration will override the default values listed below.</p><h3 id="server-connection">Server Connection<a class="anchor bookmark-target" href="#server-connection"><i class="bi bi-link-45deg"></i></a></h3><p>Optional connection parameters such as <code>host</code>, <code>port</code>, <code>dbname</code>, <code>username</code> and <code>passowrd</code>.</p><p>If connection parameters are not set, the PostgreSQL client tools will try to get them from the environment variables, so these parameters can be set in the environment.</p><p>See the <a href="https://www.postgresql.org/docs/current/libpq-envars.html">documentation</a> for more information.</p><p>Alternatively, they can be set from the <code>.ENV</code> file, if the <code>env</code> option is used.</p><h3 id="environment">Environment<a class="anchor bookmark-target" href="#environment"><i class="bi bi-link-45deg"></i></a></h3><h4 id="psql">psql<a class="anchor bookmark-target" href="#psql"><i class="bi bi-link-45deg"></i></a></h4><p>Sets the name of the <code>psql</code> command executable. The default is <code>psql</code>.</p><p>If the correct command executable is not in the search path you may have to set the right path manually with this configuration:</p><ul><li>For Linux systems that would be: <code>/usr/lib/postgresql/{major_version}/bin/psql</code></li><li>For Windows systems that would be: <code>C:\Program Files\PostgreSQL\{major_version}\bin\psql.exe</code></li></ul><h4 id="pgdump">pgdump<a class="anchor bookmark-target" href="#pgdump"><i class="bi bi-link-45deg"></i></a></h4><p>Sets the name of the <code>pg_dump</code> command executable. The default is <code>pg_dump</code>.</p><p>If the correct command executable is not in the search path you may have to set the right path manually with this configuration:</p><ul><li>For Linux systems that would be: <code>/usr/lib/postgresql/{major_version}/bin/pg_dump</code></li><li>For Windows systems that would be: <code>C:\Program Files\PostgreSQL\{major_version}\bin\pg_dump.exe</code></li></ul><h4 id="schemadumpadditionalargs">schemaDumpAdditionalArgs<a class="anchor bookmark-target" href="#schemadumpadditionalargs"><i class="bi bi-link-45deg"></i></a></h4><p>Additional arguments for the dump schema command that will added by default when dumping the schema. The default value is <code>["--no-owner", "--no-acl"]</code> (skip the object owners and the access control list). This value, when set, is expected to be an array of strings.</p><h4 id="verbose">verbose<a class="anchor bookmark-target" href="#verbose"><i class="bi bi-link-45deg"></i></a></h4><p>Set to true to log additional information, including all commands issued to client tools. The default is false. This switch can also be set from the command line.</p><h4 id="env">env<a class="anchor bookmark-target" href="#env"><i class="bi bi-link-45deg"></i></a></h4><ul><li>Set to true to load the enviorment file from <code>.env</code> by default.</li><li>Set to string value to load the enviorment file from the string value.</li><li>Set to false to ignore enviorment file.</li><li>Default is true.</li></ul><h3 id="migrations">Migrations<a class="anchor bookmark-target" href="#migrations"><i class="bi bi-link-45deg"></i></a></h3><h4 id="migrationdir">migrationDir<a class="anchor bookmark-target" href="#migrationdir"><i class="bi bi-link-45deg"></i></a></h4><p>Relative directory name where the migration files are located. This value can be a string or array of strings for the multiple directory support.</p><p>The default value is not set (empty string). This value needs to be set for every migration project.</p><h4 id="updirs">upDirs<a class="anchor bookmark-target" href="#updirs"><i class="bi bi-link-45deg"></i></a></h4><p>List of directories for versioned UP migrations. Prefix and version number is mandatory.</p><h4 id="downdirs">downDirs<a class="anchor bookmark-target" href="#downdirs"><i class="bi bi-link-45deg"></i></a></h4><p>List of directories for versioned DOWN migrations. Prefix and version number is mandatory.</p><h4 id="repetabledirs">repetableDirs<a class="anchor bookmark-target" href="#repetabledirs"><i class="bi bi-link-45deg"></i></a></h4><p>List of directories for versioned REPETABLE migrations. Prefix is mandatory.</p><h4 id="repetablebeforedirs">repetableBeforeDirs<a class="anchor bookmark-target" href="#repetablebeforedirs"><i class="bi bi-link-45deg"></i></a></h4><p>List of directories for versioned REPETABLE BEFORE migrations. Prefix is mandatory.</p><h4 id="beforedirs">beforeDirs<a class="anchor bookmark-target" href="#beforedirs"><i class="bi bi-link-45deg"></i></a></h4><p>List of directories for versioned BEFORE migrations. Prefix is mandatory.</p><h4 id="afterdirs">afterDirs<a class="anchor bookmark-target" href="#afterdirs"><i class="bi bi-link-45deg"></i></a></h4><p>List of directories for versioned AFTER migrations. Prefix is mandatory.</p><h4 id="keepmigrationdirhistory">keepMigrationDirHistory<a class="anchor bookmark-target" href="#keepmigrationdirhistory"><i class="bi bi-link-45deg"></i></a></h4><p>Migration scripts are created with a unique name in a temporary directory. Set this value to true to never delete old migration files in a temporary directory. The default value is false, temporary directory is emptied before the start of every migration.</p><h4 id="upprefix">upPrefix<a class="anchor bookmark-target" href="#upprefix"><i class="bi bi-link-45deg"></i></a></h4><p>Up version migration type prefix. The default is <code>V</code> (V for version).</p><h4 id="downprefix">downPrefix<a class="anchor bookmark-target" href="#downprefix"><i class="bi bi-link-45deg"></i></a></h4><p>Down version migration type prefix. The default is <code>U</code> (U for undo).</p><h4 id="repetableprefix">repetablePrefix<a class="anchor bookmark-target" href="#repetableprefix"><i class="bi bi-link-45deg"></i></a></h4><p>Repeatable migration type prefix. The default is <code>R</code> (R for repeatable).</p><h4 id="repetablebeforeprefix">repetableBeforePrefix<a class="anchor bookmark-target" href="#repetablebeforeprefix"><i class="bi bi-link-45deg"></i></a></h4><p>Repeatable before migration type prefix. The default is <code>_R</code> (R for repeatable).</p><h4 id="beforeprefix">beforePrefix<a class="anchor bookmark-target" href="#beforeprefix"><i class="bi bi-link-45deg"></i></a></h4><p>Before migration type prefix. The default is <code>B</code>.</p><h4 id="afterprefix">afterPrefix<a class="anchor bookmark-target" href="#afterprefix"><i class="bi bi-link-45deg"></i></a></h4><p>The after migration type prefix. The default is <code>A</code>.</p><h4 id="separatorprefix">separatorPrefix<a class="anchor bookmark-target" href="#separatorprefix"><i class="bi bi-link-45deg"></i></a></h4><p>Separator prefix. The default value is <code>__</code></p><h4 id="migrationextensions-sql">migrationExtensions: [".sql"],<a class="anchor bookmark-target" href="#migrationextensions-sql"><i class="bi bi-link-45deg"></i></a></h4><p>An array of file extensions that will be considered as the migration file. The default is <code>[".sql"]</code>.</p><h4 id="allfilesarerepetable">allFilesAreRepetable<a class="anchor bookmark-target" href="#allfilesarerepetable"><i class="bi bi-link-45deg"></i></a></h4><p>All files that don't have valid prefix are repetable migrations.</p><h4 id="recursivedirs">recursiveDirs<a class="anchor bookmark-target" href="#recursivedirs"><i class="bi bi-link-45deg"></i></a></h4><p>Search recursively trough migration subdirectories. The default is false.</p><h4 id="dirsorderedbyname">dirsOrderedByName<a class="anchor bookmark-target" href="#dirsorderedbyname"><i class="bi bi-link-45deg"></i></a></h4><p>When <code>recursiveDirs</code> is true, order the migrations based on the directory first and second based on migration type. Default is true.</p><h4 id="dirsnaturalorder">dirsNaturalOrder<a class="anchor bookmark-target" href="#dirsnaturalorder"><i class="bi bi-link-45deg"></i></a></h4><p>When <code>dirsOrderedByName</code> is true, order directories same as Visual Studio Code Explorer would (natural order), For example:</p><pre><code>backend/auth/file1.sql
backend/auth/file2.sql
backend/schema/subdir/file1.sql
backend/schema/file1.sql
backend/file1.sql
</code></pre><p>Defualt is true.</p><h4 id="dirsorderreversed">dirsOrderReversed<a class="anchor bookmark-target" href="#dirsorderreversed"><i class="bi bi-link-45deg"></i></a></h4><p>When <code>dirsOrderedByName</code> is true, this will reverse order of directories. Defualt is false.</p><h4 id="appendtopdirtoversion">appendTopDirToVersion<a class="anchor bookmark-target" href="#appendtopdirtoversion"><i class="bi bi-link-45deg"></i></a></h4><p>If <code>migrationDir</code> is true and versioned migration - add the top level directory name to version number,</p><p>Default is false.</p><h4 id="appendtopdirtoversionsplitby">appendTopDirToVersionSplitBy<a class="anchor bookmark-target" href="#appendtopdirtoversionsplitby"><i class="bi bi-link-45deg"></i></a></h4><p>If <code>migrationDir</code> is true and versioned migration: split the top level directory name by this string and the index <code>appendTopDirToVersionPart</code> to version number.</p><p>Default is "__".</p><h4 id="appendtopdirtoversionpart">appendTopDirToVersionPart<a class="anchor bookmark-target" href="#appendtopdirtoversionpart"><i class="bi bi-link-45deg"></i></a></h4><p>If <code>migrationDir</code> is true and versioned migration: split the top level directory name by this string and the index <code>appendTopDirToVersionPart</code> to version number.</p><p>Default is 0.</p><h4 id="tmpdir">tmpDir<a class="anchor bookmark-target" href="#tmpdir"><i class="bi bi-link-45deg"></i></a></h4><p>Temporary directory for migration scripts. The Default value is your OS temp dir plus <code>./___pgmigrations</code>.</p><h4 id="historytableschema">historyTableSchema<a class="anchor bookmark-target" href="#historytableschema"><i class="bi bi-link-45deg"></i></a></h4><p>Schema name for the history table. If this schema doesn't exist, it will be created. The default is <code>pgmigrations</code>.</p><h4 id="historytablename">historyTableName<a class="anchor bookmark-target" href="#historytablename"><i class="bi bi-link-45deg"></i></a></h4><p>Name of the history table. If this table doesn't exist, it will be created. The default is <code>schema_history</code>.</p><h4 id="skippattern">skipPattern<a class="anchor bookmark-target" href="#skippattern"><i class="bi bi-link-45deg"></i></a></h4><p>Regex pattern to skip files.</p><h4 id="useproceduralscript">useProceduralScript<a class="anchor bookmark-target" href="#useproceduralscript"><i class="bi bi-link-45deg"></i></a></h4><p>Set to true to build a migration script with procedural extensions (PL/pgSQL script). Set to false to build a normal SQL transactional script. Default is false.</p><h4 id="hashfunction">hashFunction<a class="anchor bookmark-target" href="#hashfunction"><i class="bi bi-link-45deg"></i></a></h4><p>Default hash function used for hashing the content. The default value is the <code>SHA1</code> function:</p><div class="code javascript"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">function</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">data</span><span style="color: #E6E6E6">) {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">const</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">hash</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">crypto</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">createHash</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">'sha1'</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">hash</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">update</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">data</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #C586C0">return</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">hash</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">digest</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">'hex'</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">function</span><span style="color: #000000">(</span><span style="color: #001080">data</span><span style="color: #000000">) {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">hash</span><span style="color: #000000"> = </span><span style="color: #001080">crypto</span><span style="color: #000000">.</span><span style="color: #795E26">createHash</span><span style="color: #000000">(</span><span style="color: #A31515">'sha1'</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">hash</span><span style="color: #000000">.</span><span style="color: #795E26">update</span><span style="color: #000000">(</span><span style="color: #001080">data</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">hash</span><span style="color: #000000">.</span><span style="color: #795E26">digest</span><span style="color: #000000">(</span><span style="color: #A31515">'hex'</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><h4 id="sortbypath">sortByPath<a class="anchor bookmark-target" href="#sortbypath"><i class="bi bi-link-45deg"></i></a></h4><p>Default: <code>true</code>.</p><p>Sorts non-versioned migrations by path and then by name for migrations in multiple directories.</p><h4 id="sortfunction">sortFunction<a class="anchor bookmark-target" href="#sortfunction"><i class="bi bi-link-45deg"></i></a></h4><p>Default sort function used for sorting migration names. The default value is <code>sortFunction: (a, b, config) => config.sortByPath ? a.script.localeCompare(b.script, "en") : a.name.localeCompare(b.name, "en")</code>.</p><h4 id="versionsortfunction">versionSortFunction<a class="anchor bookmark-target" href="#versionsortfunction"><i class="bi bi-link-45deg"></i></a></h4><p>Default sort function used for sorting migration versions. The default value is <code>versionSortFunction: (a, b, config) => a.version.localeCompare(b.version, "en", {numeric: true})</code>.</p><h4 id="warnoninvalidprefix-true">warnOnInvalidPrefix: true<a class="anchor bookmark-target" href="#warnoninvalidprefix-true"><i class="bi bi-link-45deg"></i></a></h4><p>Display warning if some migration file with the migration extension (<code>.sql</code>) doesn't have a valid prefix. This may be just some script file that can be referenced with <code># script</code> tag. The default is false.</p><h4 id="parsescripttags">parseScriptTags<a class="anchor bookmark-target" href="#parsescripttags"><i class="bi bi-link-45deg"></i></a></h4><p>Parses migration scripts for special tags to be executed in the build time.</p><p>For now, the only tag that is implemented is <code># import &lt;file></code>.</p><p>When parses finds <code># import &lt;file></code> tag, it will insert the content of that file in the next lines. This can be anywhere in the migration script. For example, you would normally put this in a comment like this:</p><div class="one-liner"><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">-- # import ./test.sql</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">-- # import ./test.sql</span></span></code></pre></div></div><p>Build will produce:</p><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">-- # import ./test.sql</span></span>
<span class="line"><span style="color: #E6E6E6">test.sql content</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">-- # import ./test.sql</span></span>
<span class="line"><span style="color: #000000">test.sql content</span></span></code></pre></div><p>But if you do this:</p><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/*</span></span>
<span class="line"><span style="color: #6A9955"># import ./test.sql</span></span>
<span class="line"><span style="color: #6A9955">*/</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/*</span></span>
<span class="line"><span style="color: #008000"># import ./test.sql</span></span>
<span class="line"><span style="color: #008000">*/</span></span></code></pre></div><p>Build will produce:</p><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #6A9955">/*</span></span>
<span class="line"><span style="color: #6A9955"># import ./test.sql</span></span>
<span class="line"><span style="color: #6A9955">test.sql content</span></span>
<span class="line"><span style="color: #6A9955">*/</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #008000">/*</span></span>
<span class="line"><span style="color: #008000"># import ./test.sql</span></span>
<span class="line"><span style="color: #008000">test.sql content</span></span>
<span class="line"><span style="color: #008000">*/</span></span></code></pre></div><p>The default is true.</p><h4 id="parseenvvars">parseEnvVars<a class="anchor bookmark-target" href="#parseenvvars"><i class="bi bi-link-45deg"></i></a></h4><p>Parses the enviroment variables in migration file content by replacing ${ENVVAR} placeholders.</p><p>For example: Enviroment variable called USERNAME will have this placeholder ${USERNAME} is replaced with the actual username.</p><p>Note: if you have a .env file in a root, it will be automatically loaded.</p><p>The default is true.</p><h4 id="runolderversions">runOlderVersions<a class="anchor bookmark-target" href="#runolderversions"><i class="bi bi-link-45deg"></i></a></h4><p>Set to true to run versioned migration even when higher version was applied. Default is false.</p><h3 id="testing">Testing<a class="anchor bookmark-target" href="#testing"><i class="bi bi-link-45deg"></i></a></h3><p>Test command will run tests on PostgreSQL functions and procedures:</p><ul><li>Test functions and procedures are required to have no parameters.</li><li>The test is considered passed if:<ul><li>Doesn't raise any exceptions.</li><li>The function doesn't return either boolean False, or text <code>f</code>, or return text doesn't start with <code>not ok</code> (case insensitive).</li></ul></li></ul><p>To assert a failed test:</p><ul><li>Raise custom exception with a custom message: <code>raise exception 'failed message';</code></li><li>Return false: <code>return false;</code></li><li>Return text that starts with "not ok": <code>return 'not ok: failed message'</code></li></ul><h4 id="testfunctionsschemasimilarto">testFunctionsSchemaSimilarTo<a class="anchor bookmark-target" href="#testfunctionsschemasimilarto"><i class="bi bi-link-45deg"></i></a></h4><p>Default: <code>%test%</code></p><p>Test function or procedure schema that is SIMILAR TO (<a href="https://www.postgresql.org/docs/current/functions-matching.html#FUNCTIONS-SIMILARTO-REGEXP">see ref</a>) this text value or <code>null</code> for all non-system schemas.</p><p>The test list returns parameterless functions and procedures that match these schemas.</p><h4 id="testfunctionsnamesimilarto">testFunctionsNameSimilarTo<a class="anchor bookmark-target" href="#testfunctionsnamesimilarto"><i class="bi bi-link-45deg"></i></a></h4><p>Default: <code>null</code></p><p>Test function or procedure name that is SIMILAR TO (<a href="https://www.postgresql.org/docs/current/functions-matching.html#FUNCTIONS-SIMILARTO-REGEXP">see ref</a>) this text (case insensitive) or <code>null</code> for all function or procedure names without parameters.</p><p>The test list returns parameterless functions and procedures that match these names.</p><h4 id="testfunctionscommentsimilarto">testFunctionsCommentSimilarTo<a class="anchor bookmark-target" href="#testfunctionscommentsimilarto"><i class="bi bi-link-45deg"></i></a></h4><p>Default: <code>test</code></p><p>Test function or procedure comment that is SIMILAR TO (<a href="https://www.postgresql.org/docs/current/functions-matching.html#FUNCTIONS-SIMILARTO-REGEXP">see ref</a>) this text (case insensitive) or <code>null</code> for all function or procedure names without parameters.</p><p>The test list returns parameterless functions and procedures that match these comments.</p><h4 id="testautomaticallyrollbackfunctiontests">testAutomaticallyRollbackFunctionTests<a class="anchor bookmark-target" href="#testautomaticallyrollbackfunctiontests"><i class="bi bi-link-45deg"></i></a></h4><p>Default: <code>false</code>.</p><p>When the test routine is the Function type, automatically begin and rollback transaction.</p><h4 id="failureexitcode">failureExitCode<a class="anchor bookmark-target" href="#failureexitcode"><i class="bi bi-link-45deg"></i></a></h4><p>Return this error code on failure. Default is -1.</p><h4 id="migrationadditionalargs">migrationAdditionalArgs<a class="anchor bookmark-target" href="#migrationadditionalargs"><i class="bi bi-link-45deg"></i></a></h4><p>Additional psql arguments for migration and finalization. Deafault is nothing.</p><h2 id="contributing">Contributing<a class="anchor bookmark-target" href="#contributing"><i class="bi bi-link-45deg"></i></a></h2><p>Contributions from the community are welcomed. Please make a pull request with a description if you wish to contribute.</p><h2 id="license">License<a class="anchor bookmark-target" href="#license"><i class="bi bi-link-45deg"></i></a></h2><p>This project is licensed under the terms of the MIT license.</p><div class="pt-5 border-top"><div id="comments-section" class="h5">Comments</div><div>Comments are not available.</div></div><footer class="mt-3 py-5"><div class="w-fit mx-auto mb-3 border-top border-bottom"><div class="alert text-center fs-smaller text-muted"><div class="alert text-center fs-smaller text-muted mb-1">If you like my content, use my software, or otherwise benefit from my work, consider supporting me by buying me a coffee. The software runs on coffee after all.</div><a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="Click Here to Buy Me a Coffee Or Scan the Code" href="https://www.buymeacoffee.com/vbilopavu" style="display: inline-grid;">Buy me a Coffee <img class="m-auto svelte-byttq0" alt="Scan Here To Buy Me a Cofee" src="/bmc_qr.png"></a></div></div><div class="d-flex justify-content-center"><a class="btn rl-arrow me-1" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="pgmigrations on GitHub" href="https://github.com/vb-consulting/pgmigrations" style="display: inline-grid;">pgmigrations on GitHub <i class="bi bi-github"></i></a> <a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="I Post Software Development Content Daily" href="https://www.linkedin.com/in/vb-software/" style="display: inline-grid;">Follow me on LinkedIn <i class="bi bi-linkedin"></i></a></div><div class="text-center"><div class="mt-5 mb-5 background-floki svelte-byttq0" data-bs-toggle="tooltip" data-bs-html="true" title="Floki is a developer dog."></div></div></footer></div></div><div class="rightside svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav svelte-9zwk14"><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">on this page</span><hr class="svelte-9zwk14"></li><li class="nav-item toc1 right svelte-9zwk14 bookmark-nav" data-id="pgmigrations" title="PgMigrations"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#pgmigrations">PgMigrations</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="migration-naming-convention" title="Migration Naming Convention"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#migration-naming-convention">Migration Naming Convention</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="versioned-migrations" title="Versioned Migrations"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#versioned-migrations">Versioned Migrations</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="repeatable-migrations" title="Repeatable Migrations"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#repeatable-migrations">Repeatable Migrations</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="finalize-migrations" title="Finalize Migrations"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#finalize-migrations">Finalize Migrations</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="migration-order" title="Migration Order"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#migration-order">Migration Order</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="configuration" title="Configuration"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#configuration">Configuration</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="server-connection" title="Server Connection"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#server-connection">Server Connection</a></li><li class="nav-item toc3 right svelte-9zwk14 bookmark-nav" data-id="environment" title="Environment"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#environment">Environment</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="psql" title="psql"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#psql">psql</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="pgdump" title="pgdump"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#pgdump">pgdump</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="schemadumpadditionalargs" title="schemaDumpAdditionalArgs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#schemadumpadditionalargs">schemaDumpAdditionalArgs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="verbose" title="verbose"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#verbose">verbose</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="env" title="env"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#env">env</a></li><li class="nav-item toc3 mt-2 right svelte-9zwk14 bookmark-nav" data-id="migrations" title="Migrations"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#migrations">Migrations</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="migrationdir" title="migrationDir"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#migrationdir">migrationDir</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="updirs" title="upDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#updirs">upDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="downdirs" title="downDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#downdirs">downDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="repetabledirs" title="repetableDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#repetabledirs">repetableDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="repetablebeforedirs" title="repetableBeforeDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#repetablebeforedirs">repetableBeforeDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="beforedirs" title="beforeDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#beforedirs">beforeDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="afterdirs" title="afterDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#afterdirs">afterDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="keepmigrationdirhistory" title="keepMigrationDirHistory"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#keepmigrationdirhistory">keepMigrationDirHistory</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="upprefix" title="upPrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#upprefix">upPrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="downprefix" title="downPrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#downprefix">downPrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="repetableprefix" title="repetablePrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#repetableprefix">repetablePrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="repetablebeforeprefix" title="repetableBeforePrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#repetablebeforeprefix">repetableBeforePrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="beforeprefix" title="beforePrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#beforeprefix">beforePrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="afterprefix" title="afterPrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#afterprefix">afterPrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="separatorprefix" title="separatorPrefix"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#separatorprefix">separatorPrefix</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="migrationextensions-sql" title='migrationExtensions: [".sql"],'><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#migrationextensions-sql">migrationExtensions: [".sql"],</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="allfilesarerepetable" title="allFilesAreRepetable"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#allfilesarerepetable">allFilesAreRepetable</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="recursivedirs" title="recursiveDirs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#recursivedirs">recursiveDirs</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="dirsorderedbyname" title="dirsOrderedByName"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#dirsorderedbyname">dirsOrderedByName</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="dirsnaturalorder" title="dirsNaturalOrder"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#dirsnaturalorder">dirsNaturalOrder</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="dirsorderreversed" title="dirsOrderReversed"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#dirsorderreversed">dirsOrderReversed</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="appendtopdirtoversion" title="appendTopDirToVersion"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#appendtopdirtoversion">appendTopDirToVersion</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="appendtopdirtoversionsplitby" title="appendTopDirToVersionSplitBy"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#appendtopdirtoversionsplitby">appendTopDirToVersionSplitBy</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="appendtopdirtoversionpart" title="appendTopDirToVersionPart"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#appendtopdirtoversionpart">appendTopDirToVersionPart</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="tmpdir" title="tmpDir"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#tmpdir">tmpDir</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="historytableschema" title="historyTableSchema"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#historytableschema">historyTableSchema</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="historytablename" title="historyTableName"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#historytablename">historyTableName</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="skippattern" title="skipPattern"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#skippattern">skipPattern</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="useproceduralscript" title="useProceduralScript"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#useproceduralscript">useProceduralScript</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="hashfunction" title="hashFunction"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#hashfunction">hashFunction</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="sortbypath" title="sortByPath"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#sortbypath">sortByPath</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="sortfunction" title="sortFunction"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#sortfunction">sortFunction</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="versionsortfunction" title="versionSortFunction"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#versionsortfunction">versionSortFunction</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="warnoninvalidprefix-true" title="warnOnInvalidPrefix: true"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#warnoninvalidprefix-true">warnOnInvalidPrefix: true</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="parsescripttags" title="parseScriptTags"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#parsescripttags">parseScriptTags</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="parseenvvars" title="parseEnvVars"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#parseenvvars">parseEnvVars</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="runolderversions" title="runOlderVersions"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#runolderversions">runOlderVersions</a></li><li class="nav-item toc3 mt-2 right svelte-9zwk14 bookmark-nav" data-id="testing" title="Testing"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#testing">Testing</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="testfunctionsschemasimilarto" title="testFunctionsSchemaSimilarTo"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#testfunctionsschemasimilarto">testFunctionsSchemaSimilarTo</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="testfunctionsnamesimilarto" title="testFunctionsNameSimilarTo"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#testfunctionsnamesimilarto">testFunctionsNameSimilarTo</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="testfunctionscommentsimilarto" title="testFunctionsCommentSimilarTo"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#testfunctionscommentsimilarto">testFunctionsCommentSimilarTo</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="testautomaticallyrollbackfunctiontests" title="testAutomaticallyRollbackFunctionTests"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#testautomaticallyrollbackfunctiontests">testAutomaticallyRollbackFunctionTests</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="failureexitcode" title="failureExitCode"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#failureexitcode">failureExitCode</a></li><li class="nav-item toc4 right svelte-9zwk14 bookmark-nav" data-id="migrationadditionalargs" title="migrationAdditionalArgs"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#migrationadditionalargs">migrationAdditionalArgs</a></li><li class="nav-item toc2 mt-2 right svelte-9zwk14 bookmark-nav" data-id="contributing" title="Contributing"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#contributing">Contributing</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="license" title="License"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#license">License</a></li></ul></div></div></main><script>!function(){var i=document.querySelector("nav.navbar"),f=document.getElementsByTagName("main")[0],L=f.getElementsByClassName("sidebar")[0],w=f.getElementsByClassName("content")[0],o=document.querySelectorAll("div.code"),k=i.querySelector(".home");function E(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n])}function T(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n]);E(e,t),e.classList.add(t)}function t(e,t){var n=e.currentTarget;if(!n.classList.contains("bi-check")){for(var i="",o=0;o<n.classList.length;o++)if(n.classList[o].startsWith("bi-")){i=n.classList[o];break}n.classList.remove(i),n.classList.add("spinner-border-sm"),n.classList.add("spinner-border");e=bootstrap.Tooltip.getInstance(n);e&&(e.setContent({".tooltip-inner":"Copying..."}),e.show()),t(n,function(){var e;n.classList.remove(i),n.classList.remove("spinner-border-sm"),n.classList.remove("spinner-border"),n.classList.add("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&(e.setContent({".tooltip-inner":"Copied!"}),e.show()),setTimeout(function(){var e;n.classList.add(i),n.classList.remove("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&e.setContent({".tooltip-inner":n.dataset.bsTitle})},2e3)})}}"/"==document.location.pathname&&T(k,"d-none");var e=document.querySelector(".post-share > .copy-url"),n=(e&&e.addEventListener("click",function(e){t(e,function(e,t){navigator.clipboard.writeText(document.location.origin+document.location.pathname),t()})}),document.getElementsByTagName("html")[0]),a=i.querySelector("#theme-btn"),s="theme";function l(e){var t=a.getElementsByTagName("svg");"dark"===e?(t[0].style.display="",t[1].style.display="none",a.getElementsByClassName("check")[0].classList.add("checked")):(t[0].style.display="none",t[1].style.display="",a.getElementsByClassName("check")[0].classList.remove("checked"));for(var n=0;n<o.length;n++){var i=o[n];"dark"===e?(i.children[1].style.display="inherit",i.children[2].style.display="none"):"light"===e&&(i.children[1].style.display="none",i.children[2].style.display="inherit")}window._theme&&window._theme(e)}function r(e){t(e,function(e,t){navigator.clipboard.writeText(e.parentElement.nextSibling.innerText),t()})}function c(e){t(e,function(e,t){var n=localStorage.getItem(s);e="dark"===n?e.parentElement.parentElement.children[1]:e.parentElement.parentElement.children[2],setTimeout(function(){html2canvas(e).then(e=>{e.toBlob(e=>navigator.clipboard.write([new ClipboardItem({"image/png":e})])),t()})},0)})}a.addEventListener("click",()=>{var e="dark"===localStorage.getItem(s)?"light":"dark";localStorage.setItem(s,e),l(n.dataset.bsTheme=e)}),l(localStorage.getItem(s)),a.children[0].classList.remove("hidden");for(var d=0;d<o.length;d++){o[d].getElementsByClassName("copy-code")[0].addEventListener("click",r);var m=o[d].getElementsByClassName("photo-code");m.length&&m[0].addEventListener("click",c)}for(var S=function(){var a,o,s;if(f.children[2]&&"none"!=f.children[2].style.display)return a=f.querySelector(".main-content").querySelectorAll("[id]"),o=void 0,this.initNavs=function(e){s=e.querySelectorAll("li.bookmark-nav");for(var t=0;t<a.length;t++){for(var n=a[t].id,i=null,o=0;o<s.length;o++)if(s[o].dataset.id==n){i=s[o];break}a[t].nav=i}setTimeout(function(){for(var e=0;e<a.length;e++){var t=a[e];if(l(t).visible&&t.nav)return void t.nav.classList.add("active")}},1e3),r()},f.children[1].addEventListener("scroll",r),this;function l(e){var e=e.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight),n=0<e.top&&!(e.bottom<0||0<=e.top-t)||e.top<0&&e.bottom>t,i=!1;return{visible:n,above:i=n?i:e.bottom<t}}function r(){if(s&&s.length){for(var e=0;e<s.length;e++)s[e].classList.remove("active");for(var t=void 0,e=0;e<a.length;e++){const i=a[e];var n=l(i);if(!n.visible&&n.above&&(t=i.nav),n.visible&&i.nav&&!i.nav.classList.contains("active"))return i.nav.classList.add("active"),o&&clearTimeout(o),void(o=setTimeout(function(){i.nav.scrollIntoView({behavior:"smooth"}),o=void 0},250))}t&&!t.classList.contains("active")&&(t.classList.add("active"),o&&clearTimeout(o),o=setTimeout(function(){t.scrollIntoView({behavior:"smooth"}),o=void 0},250))}}}(),h=function(){var l,r=i.querySelector("#nav-btn"),c=480,d="200px",m="0.25fr",h=730,v=535,u=f.children[0].children[0].children[0],g=f.children[2]&&f.children[2].children[0].children[0],t="sidebar-pinned",p=null==localStorage.getItem(t)||"true"==localStorage.getItem(t),y=!1,b=!1;function n(){window._onresize&&window._onresize();var e=window.outerWidth||window.innerWidth,t=e<c,n=t?y?"100%":"0":p?""+d:"0",i=`grid-template-columns: ${n} 1fr`,o=t&&y?"width: 100%":"0"!=n?"":"display: none",a=t&&y?"display: none":"",s=t?y?"sidebar-show":"sidebar-hide":p?"sidebar-show":"sidebar-hide",n="0"==n;f.children[2]&&(m&&h&&v&&(n&&e<v||!n&&e<h?b||(u.innerHTML=l+g.innerHTML,S.initNavs(u),b=!0):b&&(u.innerHTML=l,S.initNavs(g),b=!1)),!m||t||b?(i+=";",f.children[2].style.display="none"):(i+=` ${m};`,f.children[2].style.display="")),T(r,!t&&p||t&&y?"rotate":"rotate-back","rotate","rotate-back"),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),f.style=L?i:"display: grid;",L&&T(L,s,"sidebar-show","sidebar-hide"),L&&(L.firstChild.style=o),w.style=a,t&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),t&&y&&T(k,"d-none")}function e(){var e=window.outerWidth<c;e?y=!y:p=!p,localStorage.setItem(t,p.toString()),n(),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),e&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),e&&y&&T(k,"d-none")}return m&&h&&v&&g&&(l=u.innerHTML,S.initNavs(g)),r.addEventListener("click",e),(window.onresize=n)(),this.closeSidebar=function(){window.outerWidth<c&&y&&e()},this}(),v=document.getElementsByClassName("auto-close"),u=0;u<v.length;u++)v[u].addEventListener("click",function(e){h.closeSidebar()});location.hash&&(e=document.getElementById(location.hash.replace("#","")))&&e.scrollIntoView()}();</script><script src="/bootstrap.bundle.min.js"></script><script>!function(){for(var e=document.querySelectorAll('[data-bs-toggle="tooltip"]'),t=0;t<e.length;t++)new bootstrap.Tooltip(e[t]);var n=document.getElementsByClassName("accordion-item");if(n.length){for(t=0;t<n.length;t++){var o=n[t];o.querySelectorAll("[href='"+document.location.pathname+"']").length&&o.firstChild.click()}var l=document.querySelector("nav.navbar").querySelector(".home"),a=document.getElementsByClassName("accordion");"/"==document.location.pathname&&l.classList.add("d-none");for(t=0;t<n.length;t++){var s=a[t];s&&s.firstChild&&"VB-Consulting"==s.firstChild.title&&(null!=s.firstChild.querySelector(".collapse")&&l.classList.contains("d-none")&&"/"!=document.location.pathname&&l.classList.remove("d-none"),s.addEventListener("show.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none"),l.classList.add("d-none")}),s.addEventListener("hide.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none")}))}}}();</script><script src="/html2canvas.min.js"></script><script async defer src="https://buttons.github.io/buttons.js"></script></body><script async data-id="101435862" src="//static.getclicky.com/js"></script></html>