<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>NpgsqlRest v2 Update üêòüî•</title><meta name="description" content="Automatic REST API for PostgreSQL Database"><link href="https://vb-consulting.github.io/blog/npgsqlrest-v2/" rel="canonical"><meta name="keywords" content="api, api-rest, restful-api, http, postgres, dotnet, net8, c#, aot, database, rest, server, postgresql, npgsqlrest, pgsql, pg, automatic"><meta name="author" content="floki"><meta prefix="og: http://ogp.me/ns#" property="og:title" content="NpgsqlRest v2 Update üêòüî•"><meta prefix="og: http://ogp.me/ns#" property="og:description" content="Automatic REST API for PostgreSQL Database"><meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://vb-consulting.github.io/pgcode2.png"><meta prefix="og: http://ogp.me/ns#" property="og:type" content="article"><meta prefix="og: http://ogp.me/ns#" property="og:site_name" content="VB-Consulting"><meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://vb-consulting.github.io/blog/npgsqlrest-v2/"><meta name="twitter:image" content="https://vb-consulting.github.io/pgcode2.png"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:description" content="Automatic REST API for PostgreSQL Database"><link rel="stylesheet" href="/_elderjs/assets/svelte-460b541e.css" media="all"><style></style><link href="/style.css?1752133737093" rel="stylesheet"><script>!function(){var e="theme",t=localStorage.getItem(e);t||(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",localStorage.setItem(e,t)),document.getElementsByTagName("html")[0].dataset.bsTheme=t}();</script></head><body class="d-flex flex-column h-100"><header id="header"><nav class="navbar navbar-expand-md navbar-dark fixed-top py-0 py-md-0 svelte-30jr7w"><div class="container-fluid flex-nowrap svelte-30jr7w"><div class="d-flex svelte-30jr7w"><button id="nav-btn" type="button" class="d-flex btn btn-sm logo animate-rotate svelte-30jr7w"><i class="material-icons-outlined">menu</i></button> <a class="nav-link my-auto ms-2 fw-semibold home svelte-30jr7w" href="/"><i class="bi-chevron-double-left"></i> VB Home</a></div><div class="d-flex right svelte-30jr7w"><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Become a Patreon" href="https://www.patreon.com/vbconsulting" target="_blank"><div class="patreon"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="Buy Me a Coffee" href="https://www.buymeacoffee.com/vbilopavu" target="_blank"><div class="bmc"></div></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><a class="nav-link my-auto me-2 svelte-30jr7w" data-bs-toggle="tooltip" data-bs-html="true" title="NpgsqlRest on GitHub" href="https://github.com/vb-consulting/NpgsqlRest"><i class="bi-github"></i></a> <a class="github-button svelte-30jr7w" href="https://github.com/vb-consulting/NpgsqlRest" data-bs-toggle="tooltip" data-bs-html="true" title="Star NpgsqlRest on GitHub" data-color-scheme="no-preference: light_high_contrast; light: light_high_contrast; dark: light_high_contrast;" data-icon="octicon-star" data-show-count="true" aria-label="Star NpgsqlRest on GitHub"></a><div class="vr1 text-muted my-auto svelte-30jr7w"></div><button id="theme-btn" type="button" aria-pressed="true" aria-label="theme" class="svelte-30jr7w"><span class="check hidden svelte-30jr7w"><span class="icon svelte-30jr7w"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><path fill="currentColor" d="M12 21q-3.775 0-6.388-2.613T3 12q0-3.45 2.25-5.988T11 3.05q.625-.075.975.45t-.025 1.1q-.425.65-.638 1.375T11.1 7.5q0 2.25 1.575 3.825T16.5 12.9q.775 0 1.538-.225t1.362-.625q.525-.35 1.075-.037t.475.987q-.35 3.45-2.937 5.725T12 21Zm0-2q2.2 0 3.95-1.213t2.55-3.162q-.5.125-1 .2t-1 .075q-3.075 0-5.238-2.163T9.1 7.5q0-.5.075-1t.2-1q-1.95.8-3.163 2.55T5 12q0 2.9 2.05 4.95T12 19Zm-.25-6.75Z"></path></svg> <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" class="svelte-30jr7w"><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M0 0h24v24H0z"></path><path fill="currentColor" d="M12 19a1 1 0 0 1 .993.883L13 20v1a1 1 0 0 1-1.993.117L11 21v-1a1 1 0 0 1 1-1zm6.313-2.09l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7a1 1 0 0 1 1.218-1.567l.102.07zm-11.306.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM4 11a1 1 0 0 1 .117 1.993L4 13H3a1 1 0 0 1-.117-1.993L3 11h1zm17 0a1 1 0 0 1 .117 1.993L21 13h-1a1 1 0 0 1-.117-1.993L20 11h1zM6.213 4.81l.094.083l.7.7a1 1 0 0 1-1.32 1.497l-.094-.083l-.7-.7A1 1 0 0 1 6.11 4.74l.102.07zm12.894.083a1 1 0 0 1 .083 1.32l-.083.094l-.7.7a1 1 0 0 1-1.497-1.32l.083-.094l.7-.7a1 1 0 0 1 1.414 0zM12 2a1 1 0 0 1 .993.883L13 3v1a1 1 0 0 1-1.993.117L11 4V3a1 1 0 0 1 1-1zm0 5a5 5 0 1 1-4.995 5.217L7 12l.005-.217A5 5 0 0 1 12 7z"></path></g></svg></span></span></button></div></div></nav></header><main class="svelte-9zwk14"><div class="sidebar sidebar-hide svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav svelte-9zwk14"><li class="nav-item svelte-9zwk14" data-id="" title="VB-Consulting"><a class="nav-link svelte-9zwk14 text-uppercase" href="/">VB-Consulting</a></li><li class="nav-divider svelte-9zwk14"><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="NpgsqlRest"><a class="nav-link svelte-9zwk14 text-uppercase" href="/npgsqlrest/">NpgsqlRest</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="Norm.Net"><a class="nav-link svelte-9zwk14 text-uppercase" href="/norm.net/">Norm.Net</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="RazorSvelte"><a class="nav-link svelte-9zwk14 text-uppercase" href="/razorsvelte/">RazorSvelte</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PgRoutiner"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgroutiner/">PgRoutiner</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="XUnit.Npgsql"><a class="nav-link svelte-9zwk14 text-uppercase" href="/xunit.npgsql/">XUnit.Npgsql</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="pgmigrations"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pgmigrations/">pgmigrations</a></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="PostrgeSQL Schema Tools"><a class="nav-link svelte-9zwk14 text-uppercase" href="/pg_schema_tools/">PostrgeSQL Schema Tools</a></li><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">blogs</span><hr class="svelte-9zwk14"></li><li class="nav-item toc2 svelte-9zwk14" data-id="" title="See all blogs..."><a class="nav-link btn btn-sm w-fit px-3 mx-auto svelte-9zwk14 lr-arrow text-uppercase" href="/blogs/"><i class="bi bi-arrow-right-circle svelte-9zwk14"></i> <span class="btn-link">ALL BLOGS</span></a></li><li class="nav-item svelte-9zwk14" data-id="" title="WebAPI Load Tests PostgreSQL Function"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/load-test/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>WebAPI Load Tests</a></li><li class="nav-item svelte-9zwk14 active" data-id="" title="Automatic REST API for PostgreSQL Database"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-v2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest v2 Update üêòüî•</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Automatic REST API for PostgreSQL Database"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest-update1.6.2/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>NpgsqlRest Update 1.6.2</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/npgsqlrest/todo/part1-todo-requirements/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Vanilla SQL With NpgsqlRest Part 1 - ToDo App Requirements</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Unit Testing and TDD With PostgreSQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/unit-testing-postgresql/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Unit Testing and TDD With PostgreSQL is Easy</a></li><li class="nav-item svelte-9zwk14" data-id="" title="From Transaction Scripts and Domain Model to SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/domain-model-transaction-script/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>From Transaction Scripts and Domain Model to SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Transaction Script DDD vs SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/transaction-script/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Transaction Script DDD vs SQL</a></li><li class="nav-item svelte-9zwk14" data-id="" title="Common Sense Software Design Approach for RDBMS-backed Type of Software"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/common-sense-design/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>Common Sense Software Design</a></li><li class="nav-item svelte-9zwk14" data-id="" title="PostgreSQL Array Example"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/postgresql-array/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>PostgreSQL Arrays üêò</a></li><li class="nav-item svelte-9zwk14" data-id="" title="How DDD is screwing up your SQL"><a class="nav-link svelte-9zwk14 lr-arrow text-uppercase" href="/blog/sql-vs-ddd/"><i class="bi bi-chat-left-text svelte-9zwk14"></i>How DDD is screwing up your SQL</a></li></ul></div></div><div class="content svelte-9zwk14"><div class="banner svelte-1bxfgrx" style="background-image: url(/pgcode2.png); background-position: center; background-blend-mode: difference;"></div><div class="container-sm main-content blog svelte-1bxfgrx bannered"><div class="blog-head svelte-1bxfgrx"><a href="https://github.com/vb-consulting/blog/blob/master/LICENSE" class="text-shadow svelte-1bxfgrx" style="color: white">CC0-1.0 license</a></div><div class="categories svelte-1bxfgrx"><a href="/blogs/npgsqlrest" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># npgsqlrest</span> </a><a href="/blogs/rest" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># rest</span> </a><a href="/blogs/postgres" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># postgres</span> </a><a href="/blogs/postgresql" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># postgresql</span> </a><a href="/blogs/dotnet" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># dotnet</span> </a><a href="/blogs/net8" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># net8</span> </a><a href="/blogs/c#" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># c#</span> </a><a href="/blogs/aot" class="btn btn-sm text-shadow svelte-1bxfgrx"><span class="cat"># aot</span></a></div><h1 class="text-shadow" id="npgsqlrest-version-2-update-">NpgsqlRest Version 2 Update üêòüî•</h1><div class="post-meta text-shadow"><div></div><div class="post-details"><div class="post-pic" data-bs-toggle="tooltip" data-bs-html="true" title="Floki is a developer dog." style="background-image: url(/floki2.jpg)"></div><div class="post-details-right"><div class="post-share"><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fvb-consulting.github.io%2Fblog%2Fnpgsqlrest-v2%2F" class="me-1 bi-linkedin" data-bs-toggle="tooltip" data-bs-html="true" title="Share on LinkedIn"><i class=""></i></a> <a href="http://twitter.com/share?text=NpgsqlRest%20v2%20Update%20%F0%9F%90%98%F0%9F%94%A5%0AAutomatic%20REST%20API%20for%20PostgreSQL%20Database%0A&url=https%3A%2F%2Fvb-consulting.github.io%2Fblog%2Fnpgsqlrest-v2%2F&hashtags=npgsqlrest%2Crest%2Cpostgres%2Cpostgresql%2Cdotnet%2Cnet8%2Cc%23%2Caot" class="me-1 bi-twitter-x" data-bs-toggle="tooltip" data-bs-html="true" title="Share on X"><i class=""></i></a> <a href="#" class="copy-url bi-clipboard" data-bs-toggle="tooltip" data-bs-html="true" title="Copy URL"><i class=""></i></a></div><div class="post-author">floki</div><div class="post-date">Apr 28, 2025</div></div></div></div><blockquote><ul><li><code>NpgsqlRest</code> is .NET Nuget library for <strong>automatic REST API from PostgreSQL databases</strong>.</li><li>See the <a href="https://vb-consulting.github.io/npgsqlrest/">GitHub Readme</a> file.</li><li><code>NpgsqlRest Version 2</code> is a <strong>major upgrade</strong> that introduces extendiblity with the <strong>concept of plugins.</strong>.</li></ul></blockquote><p>There are two types of plugins:</p><blockquote><ol><li><strong>Routine Source Plugins</strong></li><li><strong>Code Generation Plugins</strong></li></ol></blockquote><h2 id="routine-source-plugins">Routine Source Plugins</h2><p><strong>Routine Source Plugins</strong> are plugins that <strong>define various sources</strong> - from which automatic REST API can be built.</p><p>For example, <strong>functions are stored procedures source</strong> is already built-in into the library and it has been since version 1.</p><p>With <strong>version 2</strong>, you can add the <strong>CRUD source plugin</strong>, published as a separate, plugin library <strong><a href="https://vb-consulting.github.io/npgsqlrest/crudsource">NpgsqlRest.CrudSource</a></strong>. This plugin can generate automatic REST API for PostgreSQL tables and views, that can:</p><ul><li><strong>Insert</strong> into tables and insertable views with or without conflict resolutions and with or without returning the inserted record (Create).</li><li><strong>Read</strong> data from tables and views using select operation and filtering by provided parameters (Read).</li><li><strong>Update</strong> data in tables and updateable views with or without returning updated data (Update).</li><li><strong>Delete</strong> data in tables and deletable views with or without returning deleted data (Delete).</li></ul><p>See <strong><a href="https://vb-consulting.github.io/npgsqlrest/crudsource">NpgsqlRest.CrudSource</a></strong> for more information.</p><h2 id="code-generation-plugins">Code Generation Plugins</h2><p><strong>Code Generation Plugins</strong> are plugins that are executed after the REST API has been defined and generated from the source. As such, they are used mostly for <strong>automatic generations</strong> of, well, <strong>more code.</strong></p><p>Code Generation Plugins <strong>automatically generate code</strong>.</p><p>From the first version - there was always a feature that, based on generated REST APIs - could generate the <a href="https://learn.microsoft.com/en-us/aspnet/core/test/http-files?view=aspnetcore-8.0#http-file-syntax">HTTP Code File</a>.</p><p>Those HTTP Code files are the REST Client files, with syntax based on the Visual Studio Code REST Client extension. These files can be used with Visual Studio Code or with the latest Visual Studio to test and run easily REST endpoints.</p><p>With version 2, the code generation interface is standardized and the HTTP Code Files functionality is moved to a <strong>separate plugin</strong>: <strong><a href="https://vb-consulting.github.io/npgsqlrest/httpfiles/">NpgsqlRest.HttpFiles</a></strong></p><p>Now, there are no more default code generators in the core library - they are all <strong>added through plugins as additional libraries.</strong></p><p>Besides HTTP Code Files - there is also a <strong>Typescript Client Code Generator Plugin</strong>: <strong><a href="https://vb-consulting.github.io/npgsqlrest/tsclient/">NpgsqlRest.TsClient</a></strong>.</p><p>This plugin was created and developed to avoid writing tedious and boring Typescript code. Since REST API endpoints are now automatically generated - there is no reason not to generate API calls for the frontend in Typescript.</p><p>Short example of the part of the generated Typescript module:</p><div class="code ts"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">interface</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">IGetDuplicateEmailsResponse</span><span style="color: #E6E6E6"> {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">email</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">string</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">|</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">count</span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">number</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">|</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">null</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">const</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">_baseUrl</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">""</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #6A9955">/**</span></span>
<span class="line"><span style="color: #6A9955">* function public.get_duplicate_emails()</span></span>
<span class="line"><span style="color: #6A9955">* returns table(</span></span>
<span class="line"><span style="color: #6A9955">*     email text,</span></span>
<span class="line"><span style="color: #6A9955">*     count bigint</span></span>
<span class="line"><span style="color: #6A9955">* )</span></span>
<span class="line"><span style="color: #6A9955">* </span></span>
<span class="line"><span style="color: #6A9955">* </span><span style="color: #569CD6">@remarks</span></span>
<span class="line"><span style="color: #6A9955">* GET /api/get-duplicate-emails</span></span>
<span class="line"><span style="color: #6A9955">* </span></span>
<span class="line"><span style="color: #6A9955">* </span><span style="color: #569CD6">@see</span><span style="color: #6A9955"> </span><span style="color: #4EC9B0">FUNCTION</span><span style="color: #6A9955"> public.get_duplicate_emails</span></span>
<span class="line"><span style="color: #6A9955">*/</span></span>
<span class="line"><span style="color: #C586C0">export</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">async</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">getDuplicateEmails</span><span style="color: #E6E6E6">() </span><span style="color: #D4D4D4">:</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">Promise</span><span style="color: #E6E6E6">&lt;</span><span style="color: #4EC9B0">IGetDuplicateEmailsResponse</span><span style="color: #E6E6E6">[]> {</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">const</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">response</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #C586C0">await</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">fetch</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">_baseUrl</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"/api/get-duplicate-emails"</span><span style="color: #E6E6E6">, {</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">method:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"GET"</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">        </span><span style="color: #9CDCFE">headers:</span><span style="color: #E6E6E6"> { </span><span style="color: #CE9178">"Content-Type"</span><span style="color: #9CDCFE">:</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">"application/json"</span><span style="color: #E6E6E6"> },</span></span>
<span class="line"><span style="color: #E6E6E6">    });</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #C586C0">return</span><span style="color: #E6E6E6"> </span><span style="color: #C586C0">await</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">response</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">json</span><span style="color: #E6E6E6">() </span><span style="color: #C586C0">as</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">IGetDuplicateEmailsResponse</span><span style="color: #E6E6E6">[];</span></span>
<span class="line"><span style="color: #E6E6E6">}</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">interface</span><span style="color: #000000"> </span><span style="color: #267F99">IGetDuplicateEmailsResponse</span><span style="color: #000000"> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">email</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000"> | </span><span style="color: #267F99">null</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">count</span><span style="color: #000000">: </span><span style="color: #267F99">number</span><span style="color: #000000"> | </span><span style="color: #267F99">null</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #000000">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">_baseUrl</span><span style="color: #000000"> = </span><span style="color: #A31515">""</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #008000">/**</span></span>
<span class="line"><span style="color: #008000">* function public.get_duplicate_emails()</span></span>
<span class="line"><span style="color: #008000">* returns table(</span></span>
<span class="line"><span style="color: #008000">*     email text,</span></span>
<span class="line"><span style="color: #008000">*     count bigint</span></span>
<span class="line"><span style="color: #008000">* )</span></span>
<span class="line"><span style="color: #008000">* </span></span>
<span class="line"><span style="color: #008000">* </span><span style="color: #0000FF">@remarks</span></span>
<span class="line"><span style="color: #008000">* GET /api/get-duplicate-emails</span></span>
<span class="line"><span style="color: #008000">* </span></span>
<span class="line"><span style="color: #008000">* </span><span style="color: #0000FF">@see</span><span style="color: #008000"> </span><span style="color: #267F99">FUNCTION</span><span style="color: #008000"> public.get_duplicate_emails</span></span>
<span class="line"><span style="color: #008000">*/</span></span>
<span class="line"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">getDuplicateEmails</span><span style="color: #000000">() : </span><span style="color: #267F99">Promise</span><span style="color: #000000">&lt;</span><span style="color: #267F99">IGetDuplicateEmailsResponse</span><span style="color: #000000">[]> {</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">response</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">fetch</span><span style="color: #000000">(</span><span style="color: #001080">_baseUrl</span><span style="color: #000000"> + </span><span style="color: #A31515">"/api/get-duplicate-emails"</span><span style="color: #000000">, {</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #001080">method:</span><span style="color: #000000"> </span><span style="color: #A31515">"GET"</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">        </span><span style="color: #001080">headers:</span><span style="color: #000000"> { </span><span style="color: #A31515">"Content-Type"</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">"application/json"</span><span style="color: #000000"> },</span></span>
<span class="line"><span style="color: #000000">    });</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">json</span><span style="color: #000000">() </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">IGetDuplicateEmailsResponse</span><span style="color: #000000">[];</span></span>
<span class="line"><span style="color: #000000">}</span></span></code></pre></div><p>For more information and full examples, see the <a href="https://vb-consulting.github.io/npgsqlrest/tsclient/">NpgsqlRest.TsClient</a> plugin.</p><p>Notice something interesting: The Typescript module can be re-generated on every build which effectively gives a <strong>static type-checking of your database</strong>.</p><h2 id="library-design">Library Design</h2><p>The overall design of version 2 of the library now looks like this:</p><p style="text-align: center; width: 100%"><img class="img" src="/npgsqlrest-v2.png" style="width: 90%;"></p><p>The initial setup with all available plugins may look like this:</p><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">dotnet add package NpgsqlRest.CrudSource</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">dotnet add package NpgsqlRest.CrudSource</span></span></code></pre></div></div><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">dotnet add package NpgsqlRest.HttpFiles</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">dotnet add package NpgsqlRest.HttpFiles</span></span></code></pre></div></div><div class="one-liner"><div class="code console"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #E6E6E6">dotnet add package NpgsqlRest.TsClient</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #000000">dotnet add package NpgsqlRest.TsClient</span></span></code></pre></div></div><div class="code csharp"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRest</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRest</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">CrudSource</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRest</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">HttpFiles</span><span style="color: #E6E6E6">;</span></span>
<span class="line"><span style="color: #569CD6">using</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">NpgsqlRest</span><span style="color: #E6E6E6">.</span><span style="color: #4EC9B0">TsClient</span><span style="color: #E6E6E6">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">builder</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">WebApplication</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">CreateBuilder</span><span style="color: #E6E6E6">(</span><span style="color: #9CDCFE">args</span><span style="color: #E6E6E6">);</span></span>
<span class="line"><span style="color: #569CD6">var</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">builder</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Build</span><span style="color: #E6E6E6">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">UseNpgsqlRest</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"Host=;Port=5432;Database=;Username=;Password="</span><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #E6E6E6">{</span></span>
<span class="line"><span style="color: #6A9955">    // add HttpFile and TsClient code generator plugins</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">EndpointCreateHandlers</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> [</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">HttpFile</span><span style="color: #E6E6E6">(), </span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">TsClient</span><span style="color: #E6E6E6">(</span><span style="color: #CE9178">"../Frontend/src/api.ts"</span><span style="color: #E6E6E6">)],</span></span>
<span class="line"><span style="color: #6A9955">    // add CrudSource source plugin for tabels and views</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #9CDCFE">SourcesCreated</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=</span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">sources</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">=></span><span style="color: #E6E6E6"> </span><span style="color: #9CDCFE">sources</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Add</span><span style="color: #E6E6E6">(</span><span style="color: #569CD6">new</span><span style="color: #E6E6E6"> </span><span style="color: #4EC9B0">CrudSource</span><span style="color: #E6E6E6">())</span></span>
<span class="line"><span style="color: #E6E6E6">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #9CDCFE">app</span><span style="color: #E6E6E6">.</span><span style="color: #DCDCAA">Run</span><span style="color: #E6E6E6">();</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRest</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRest</span><span style="color: #000000">.</span><span style="color: #267F99">CrudSource</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRest</span><span style="color: #000000">.</span><span style="color: #267F99">HttpFiles</span><span style="color: #000000">;</span></span>
<span class="line"><span style="color: #AF00DB">using</span><span style="color: #000000"> </span><span style="color: #267F99">NpgsqlRest</span><span style="color: #000000">.</span><span style="color: #267F99">TsClient</span><span style="color: #000000">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">builder</span><span style="color: #000000"> = </span><span style="color: #001080">WebApplication</span><span style="color: #000000">.</span><span style="color: #795E26">CreateBuilder</span><span style="color: #000000">(</span><span style="color: #001080">args</span><span style="color: #000000">);</span></span>
<span class="line"><span style="color: #0000FF">var</span><span style="color: #000000"> </span><span style="color: #001080">app</span><span style="color: #000000"> = </span><span style="color: #001080">builder</span><span style="color: #000000">.</span><span style="color: #795E26">Build</span><span style="color: #000000">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">UseNpgsqlRest</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000">(</span><span style="color: #A31515">"Host=;Port=5432;Database=;Username=;Password="</span><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #000000">{</span></span>
<span class="line"><span style="color: #008000">    // add HttpFile and TsClient code generator plugins</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">EndpointCreateHandlers</span><span style="color: #000000"> = [</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">HttpFile</span><span style="color: #000000">(), </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">TsClient</span><span style="color: #000000">(</span><span style="color: #A31515">"../Frontend/src/api.ts"</span><span style="color: #000000">)],</span></span>
<span class="line"><span style="color: #008000">    // add CrudSource source plugin for tabels and views</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #001080">SourcesCreated</span><span style="color: #000000"> = </span><span style="color: #001080">sources</span><span style="color: #000000"> => </span><span style="color: #001080">sources</span><span style="color: #000000">.</span><span style="color: #795E26">Add</span><span style="color: #000000">(</span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">CrudSource</span><span style="color: #000000">())</span></span>
<span class="line"><span style="color: #000000">});</span></span>
<span class="line"></span>
<span class="line"><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">Run</span><span style="color: #000000">();</span></span></code></pre></div><p>For more information see the readme documentation for:</p><ul><li><strong><a href="https://vb-consulting.github.io/npgsqlrest/crudsource">NpgsqlRest.CrudSource</a></strong></li><li><strong><a href="https://vb-consulting.github.io/npgsqlrest/httpfiles/">NpgsqlRest.HttpFiles</a></strong></li><li><strong><a href="https://vb-consulting.github.io/npgsqlrest/tsclient/">NpgsqlRest.TsClient</a></strong></li></ul><p>This diagram also shows things that are planned and not yet implemented (in dotted boxes). For example:</p><ul><li><strong>Complex Query API Source and Paged Query API Source</strong></li></ul><p>It's possible to extend functionality with new plugins that would, based on the HTTP parameters - create some <strong>more complex queries</strong>, with joins, aggregates, paging, etc.</p><p>This opens the door to something resembling an ORM over HTTP.</p><p>Personally, I prefer using functions and stored procedures. But, I can see how people can find this approach useful.</p><ul><li><strong>Code Generation for Other Types of Clients</strong></li></ul><p>As I use <code>NpgsqlRest</code> more intensively on different full-stack projects, there is more and more need for client code generator plugins.</p><p>For example, that might be different Typescript Client Code generators, that might use, perhaps a different library. Or, Javascript Client Code, or any other language that would require such code that calls those generated REST API endpoints.</p><p>It is certainly <strong>many times easier and faster</strong> to add another generator plugin than to write and maintain REST API Client calls manually, by hand.</p><p>I wish I didn't have to do that anymore.</p><p>Ever.</p><ul><li><strong>Code Generation for UI Components</strong></li></ul><p>This is a very interesting aspect I intend to expand on in the future.</p><p>From the very start, <code>NpgsqlRest</code> was designed to support comment annotation syntax, that can utilize <a href="https://www.postgresql.org/docs/current/sql-comment.html">PostgreSQL Object Comment</a> support - to <strong>alter the behavior of the endpoints</strong>. PostgreSQL comments are intended to be used as free text object comments. <code>NpgsqlRest</code> can read and parse those comments to detect special annotations that alter endpoint behavior, change path, change the method, enable and disable, etc. You can see <a href="https://vb-consulting.github.io/npgsqlrest/annotations/">annotation documentation on this link</a>.</p><p>The plan is to use this annotation syntax to instruct the code generator plugins to generate pieces of the UI, not just client access code.</p><h2 id="performances">Performances</h2><p>Exhaustive performance tests were conducted, you see on this page: <a href="https://vb-consulting.github.io/npgsqlrest/performances/">performances tests</a>.</p><p>For the following test PostgreSQL function:</p><div class="code sql"><div class="toolbar"><div class="copy-code bi-clipboard" data-bs-toggle="tooltip" data-bs-title="Copy code to clipboard"></div><div class="photo-code bi-camera" data-bs-toggle="tooltip" data-bs-title="Copy code image to clipboard"></div></div><pre class="shiki slack-dark" style="background-color: #222222" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #569CD6">create or replace</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">function</span><span style="color: #E6E6E6"> </span><span style="color: #DCDCAA">perf_test</span><span style="color: #E6E6E6">(</span></span>
<span class="line"><span style="color: #E6E6E6">    _records </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _text_param </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _int_param </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _ts_param </span><span style="color: #569CD6">timestamp</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    _bool_param bool</span></span>
<span class="line"><span style="color: #E6E6E6">) </span></span>
<span class="line"><span style="color: #569CD6">returns</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">table</span><span style="color: #E6E6E6">(</span></span>
<span class="line"><span style="color: #E6E6E6">    id1 </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    foo1 </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    bar1 </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    datetime1 </span><span style="color: #569CD6">timestamp</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    id2 </span><span style="color: #569CD6">int</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    foo2 </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    bar2 </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #569CD6">datetime2</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">timestamp</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    long_foo_bar </span><span style="color: #569CD6">text</span><span style="color: #E6E6E6">, </span></span>
<span class="line"><span style="color: #E6E6E6">    is_foobar bool</span></span>
<span class="line"><span style="color: #E6E6E6">)</span></span>
<span class="line"><span style="color: #569CD6">language</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">sql</span></span>
<span class="line"><span style="color: #569CD6">as</span></span>
<span class="line"><span style="color: #E6E6E6">$$</span></span>
<span class="line"><span style="color: #569CD6">select</span></span>
<span class="line"><span style="color: #E6E6E6">    i </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> _int_param </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> id1,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #CE9178">'foo'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> _text_param </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> i::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> foo1,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #CE9178">'bar'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> i::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> bar1,</span></span>
<span class="line"><span style="color: #E6E6E6">    (_ts_param::</span><span style="color: #569CD6">date</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> (i::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">' days'</span><span style="color: #E6E6E6">)::interval </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> datetime1,</span></span>
<span class="line"><span style="color: #E6E6E6">    i</span><span style="color: #D4D4D4">+</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> _int_param </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> id2,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #CE9178">'foo'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> _text_param </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> (i</span><span style="color: #D4D4D4">+</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">)::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> foo2,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #CE9178">'bar'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> _text_param </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> (i</span><span style="color: #D4D4D4">+</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">)::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> bar2,</span></span>
<span class="line"><span style="color: #E6E6E6">    (_ts_param::</span><span style="color: #569CD6">date</span><span style="color: #E6E6E6">) </span><span style="color: #D4D4D4">+</span><span style="color: #E6E6E6"> ((i</span><span style="color: #D4D4D4">+</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">)::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">' days'</span><span style="color: #E6E6E6">)::interval </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">datetime2</span><span style="color: #E6E6E6">,</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #CE9178">'long_foo_bar_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> _text_param </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> </span><span style="color: #CE9178">'_'</span><span style="color: #E6E6E6"> </span><span style="color: #D4D4D4">||</span><span style="color: #E6E6E6"> (i</span><span style="color: #D4D4D4">+</span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">)::</span><span style="color: #569CD6">text</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> long_foo_bar, </span></span>
<span class="line"><span style="color: #E6E6E6">    (i % </span><span style="color: #B5CEA8">2</span><span style="color: #E6E6E6">)::</span><span style="color: #569CD6">boolean</span><span style="color: #E6E6E6"> </span><span style="color: #569CD6">and</span><span style="color: #E6E6E6"> _bool_param </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> is_foobar</span></span>
<span class="line"><span style="color: #569CD6">from</span></span>
<span class="line"><span style="color: #E6E6E6">    </span><span style="color: #DCDCAA">generate_series</span><span style="color: #E6E6E6">(</span><span style="color: #B5CEA8">1</span><span style="color: #E6E6E6">, _records) </span><span style="color: #569CD6">as</span><span style="color: #E6E6E6"> i</span></span>
<span class="line"><span style="color: #E6E6E6">$$;</span></span></code></pre><pre class="shiki light-plus" style="background-color: #FFFFFF" tabindex="0"><code class="code-highlight"><span class="line"><span style="color: #0000FF">create or replace</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">perf_test</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    _records </span><span style="color: #0000FF">int</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _text_param </span><span style="color: #0000FF">text</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _int_param </span><span style="color: #0000FF">int</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _ts_param </span><span style="color: #0000FF">timestamp</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    _bool_param bool</span></span>
<span class="line"><span style="color: #000000">) </span></span>
<span class="line"><span style="color: #0000FF">returns</span><span style="color: #000000"> </span><span style="color: #0000FF">table</span><span style="color: #000000">(</span></span>
<span class="line"><span style="color: #000000">    id1 </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    foo1 </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    bar1 </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    datetime1 </span><span style="color: #0000FF">timestamp</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    id2 </span><span style="color: #0000FF">int</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    foo2 </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    bar2 </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #0000FF">datetime2</span><span style="color: #000000"> </span><span style="color: #0000FF">timestamp</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    long_foo_bar </span><span style="color: #0000FF">text</span><span style="color: #000000">, </span></span>
<span class="line"><span style="color: #000000">    is_foobar bool</span></span>
<span class="line"><span style="color: #000000">)</span></span>
<span class="line"><span style="color: #0000FF">language</span><span style="color: #000000"> </span><span style="color: #0000FF">sql</span></span>
<span class="line"><span style="color: #0000FF">as</span></span>
<span class="line"><span style="color: #000000">$$</span></span>
<span class="line"><span style="color: #0000FF">select</span></span>
<span class="line"><span style="color: #000000">    i + _int_param </span><span style="color: #0000FF">as</span><span style="color: #000000"> id1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">'foo'</span><span style="color: #000000"> || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || _text_param || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || i::</span><span style="color: #0000FF">text</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> foo1,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">'bar'</span><span style="color: #000000"> || i::</span><span style="color: #0000FF">text</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> bar1,</span></span>
<span class="line"><span style="color: #000000">    (_ts_param::</span><span style="color: #0000FF">date</span><span style="color: #000000">) + (i::</span><span style="color: #0000FF">text</span><span style="color: #000000"> || </span><span style="color: #A31515">' days'</span><span style="color: #000000">)::interval </span><span style="color: #0000FF">as</span><span style="color: #000000"> datetime1,</span></span>
<span class="line"><span style="color: #000000">    i+</span><span style="color: #098658">1</span><span style="color: #000000"> + _int_param </span><span style="color: #0000FF">as</span><span style="color: #000000"> id2,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">'foo'</span><span style="color: #000000"> || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || _text_param || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || (i+</span><span style="color: #098658">1</span><span style="color: #000000">)::</span><span style="color: #0000FF">text</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> foo2,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">'bar'</span><span style="color: #000000"> || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || _text_param || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || (i+</span><span style="color: #098658">1</span><span style="color: #000000">)::</span><span style="color: #0000FF">text</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> bar2,</span></span>
<span class="line"><span style="color: #000000">    (_ts_param::</span><span style="color: #0000FF">date</span><span style="color: #000000">) + ((i+</span><span style="color: #098658">1</span><span style="color: #000000">)::</span><span style="color: #0000FF">text</span><span style="color: #000000"> || </span><span style="color: #A31515">' days'</span><span style="color: #000000">)::interval </span><span style="color: #0000FF">as</span><span style="color: #000000"> </span><span style="color: #0000FF">datetime2</span><span style="color: #000000">,</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #A31515">'long_foo_bar_'</span><span style="color: #000000"> || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || _text_param || </span><span style="color: #A31515">'_'</span><span style="color: #000000"> || (i+</span><span style="color: #098658">2</span><span style="color: #000000">)::</span><span style="color: #0000FF">text</span><span style="color: #000000"> </span><span style="color: #0000FF">as</span><span style="color: #000000"> long_foo_bar, </span></span>
<span class="line"><span style="color: #000000">    (i % </span><span style="color: #098658">2</span><span style="color: #000000">)::</span><span style="color: #0000FF">boolean</span><span style="color: #000000"> </span><span style="color: #0000FF">and</span><span style="color: #000000"> _bool_param </span><span style="color: #0000FF">as</span><span style="color: #000000"> is_foobar</span></span>
<span class="line"><span style="color: #0000FF">from</span></span>
<span class="line"><span style="color: #000000">    </span><span style="color: #795E26">generate_series</span><span style="color: #000000">(</span><span style="color: #098658">1</span><span style="color: #000000">, _records) </span><span style="color: #0000FF">as</span><span style="color: #000000"> i</span></span>
<span class="line"><span style="color: #000000">$$;</span></span></code></pre></div><p>Tests are executed with the K6 stress tool for:</p><ul><li>Duration of 60 seconds.</li><li>100 simultaneous virtual users.</li><li>Retrieval of 10 and 100 records.</li></ul><p>Numbers represent an overall number of successful requests (higher is better).</p><table class="table table-sm table-hover table-bordered" style="width: initial;"><thead><tr><th>Platform</th><th align="right">10 Records</th><th align="right">100 Records</th></tr></thead><tbody class="table-group-divider"><tr><td><strong>AOT</strong> is an ahead-of-time native compilation of <code>NpgsqlRest</code>. <code>NpgsqlRest</code> compiled to the native binary.</td><td align="right"><strong>781,803</strong></td><td align="right"><strong>307,427</strong></td></tr><tr><td><strong>JIT</strong> is a just-in-time compilation of <code>NpgsqlRest</code> to NET8 CLR (Common Language Runtime) on NET8 runtime.</td><td align="right"><strong>562,304</strong></td><td align="right"><strong>303,692</strong></td></tr><tr><td><strong>ADO</strong> is NET8 Raw ADO Data Reader approach. <a href="/npgsqlrest/performances/#4-ado">Source</a></td><td align="right">440,896</td><td align="right">314,198</td></tr><tr><td><strong>EF</strong> is Entity Framework Core 8 on NET8 runtime. <a href="/npgsqlrest/performances/#3-ef">Source</a></td><td align="right">337,612</td><td align="right">235,331</td></tr><tr><td><strong>PostgREST</strong> version 12.0.2</td><td align="right">72,305</td><td align="right">40,456</td></tr><tr><td><strong>Django</strong> REST Framework 4.2.10 on Python 3.8 <a href="/npgsqlrest/performances/#5-django">Source Link</a></td><td align="right">21,193</td><td align="right">18,345</td></tr><tr><td><strong>Express</strong> on NodeJS v20.11.1, express v4.18.3, pg 8.11.3 <a href="/npgsqlrest/performances/#6-express">Source Link</a></td><td align="right">160,241</td><td align="right">55,119</td></tr><tr><td><strong>GO</strong> version go1.13.8 <a href="/npgsqlrest/performances/#7-go">Source Link</a></td><td align="right">78,530</td><td align="right">55,119</td></tr><tr><td><strong>FastAPI</strong> version 0.110.0 on Python 3.8 <a href="/npgsqlrest/performances/#8-fastapi">Source Link</a></td><td align="right">13,650</td><td align="right">9,666</td></tr></tbody></table><p>Interesting to notice is the difference between the AOT and the JIT versions of <code>NpgsqlRest</code>.</p><p>Usually, JIT versions are slightly faster because JIT has access to the internal optimizations that AOT does not. But, in this case, it's the other way around. I don't have an explanation for this.</p><p>Another thing to notice is that <code>NpgsqlRest</code> slows down with the higher number of rows in the JSON array. Over 100 records (which is a JSON array with 100 objects) are slightly slower than the raw ADO approach, and 10 records are noticeably faster.</p><p>In the previous version, all values were written directly to the response as soon as they were yielded from the reader. This, in turn, caused frequent small writes to the response stream. In this version, when generating a response from a record, records are <a href="/npgsqlrest/options/#bufferrows">buffered</a> before being written to the response stream. This improved performances with the larger datasets since buffering is slightly cheaper than writing to the response stream.</p><p>However, the <a href="/npgsqlrest/performances/#4-ado">raw ADO</a> approach reads value to an instance and then yields an instance to a minimal API handler, which means that those instances need to be serialized into JSON strings in response. That is not the case with <code>NpgsqlRest</code> which doesn't create instances at all but rather writes values directly from the reader, so theoretically <code>NpgsqlRest</code> should be a bit faster. And, it is on smaller datasets but it slightly degrades for some reason on larger datasets (100+ records), which means, there is still room for improvement.</p><p>In any case, performances are more than just good as far as I'm concerned - they are amazing thanks to internal optimizations in the NET8. Other platforms are not even in the same league. But that is not even the biggest thing by far. The biggest win is the sheer amount of code that I don't have to write anymore. Ever.</p><h2 id="summary">Summary</h2><p><code>NpgsqlRest</code> offers a great deal of expandability through the plugin system. It became a sort of PostgreSQL HTTP ORM and now, I can add anything in PostgreSQL as a new source that will be exposed as the REST API.</p><p>An even bigger thing is code generation. The amount of code that I don't have to write anymore is astounding.</p><p>Not only that, there are a couple of more unintended positive consequences, like:</p><ul><li>Strong type checking of the PostgreSQL database on a build, for example with the Typescript plugin on the Frontend build.</li><li>Simplified deployment model. A single <code>NpgsqlRest</code> build deployment is enough for all versions since changes are focused on the database. It's easier to replace a database function or alter a procedure than to redeploy a new version of code, and with zero downtime.</li><li>Performances. <code>NpgsqlRest</code> is a high-volume server outperforming almost all available platforms with far less code.</li></ul><p>I think there is a lot of room for improvement in the direction of building a declarative, low-code application platform with comment annotations syntax support.</p><p>My goal was always simple: offer the highest possible application quality in the shortest amount of time.</p><h2 id="support">Support</h2><p>Developing tools and libraries like this tedious and daunting unpaid work is achieved mostly late in the evenings, on weekends and holidays, in short - after and outside the regular paid work.</p><p>If you find this work valuable for you personally or for your organization, please consider <a href="https://www.patreon.com/vbconsulting">becoming a Patreon</a> or <a href="https://www.buymeacoffee.com/vbilopavu">buying me a coffee</a>.</p><p>Your support will allow me to continue development on this project.</p><p>Thank you.</p><div class="text-muted text-center fs-_7rem mb-2">MORE ON NpgsqlRest</div><div class="d-flex justify-content-center row"><a class="btn btn-sm text-start sidebar-link me-1" href="/npgsqlrest/"><span class="">NpgsqlRest</span> </a><a class="btn btn-sm text-start sidebar-link me-1" href="/npgsqlrest/options/"><span class="">NpgsqlRest Docs</span> </a><a class="btn btn-sm text-start sidebar-link me-1" href="/npgsqlrest/annotations/"><span class="">NpgsqlRest Annotations</span> </a><a class="btn btn-sm text-start sidebar-link me-1" href="/npgsqlrest/changelog/"><span class="">NpgsqlRest Changelog</span> </a><a class="btn btn-sm text-start sidebar-link me-1" href="/npgsqlrest/perfomance-tests/"><span class="">NpgsqlRest Perfomances</span> </a><a class="btn btn-sm text-start sidebar-link me-1" href="/blog/npgsqlrest/"><span class="">NpgsqlRest NuGet Library</span></a></div><div class="w-fit mx-auto mt-5 mb-3 border-top"><div class="alert text-center fs-smaller text-muted">To receive notifications about new posts and updates, consider subscribing to my LinkdIn page:<br><a class="btn btn-sm" href="https://www.linkedin.com/in/vb-software/"><i class="bi-linkedin"></i> <span class="text-primary">vb-software linkedin</span></a><br><br>You will receive notifications about new posts on your LinkedIn feed.</div></div><div class="pt-5 border-top"><div id="comments-section" class="h5">Comments</div><script defer src="https://cdn.commento.io/js/commento.js" data-no-fonts="true" data-css-override="https://vb-consulting.github.io/style.css"></script><div id="commento"></div></div><footer class="mt-3 py-5"><div class="w-fit mx-auto mb-3 border-top border-bottom"><div class="alert text-center fs-smaller text-muted"><div class="alert text-center fs-smaller text-muted mb-1">If you like my content, use my software, or otherwise benefit from my work, consider supporting me by buying me a coffee. The software runs on coffee after all.</div><a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="Click Here to Buy Me a Coffee Or Scan the Code" href="https://www.buymeacoffee.com/vbilopavu" style="display: inline-grid;">Buy me a Coffee <img class="m-auto svelte-byttq0" alt="Scan Here To Buy Me a Cofee" src="/bmc_qr.png"></a></div></div><div class="d-flex justify-content-center"><a class="btn rl-arrow me-1" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="NpgsqlRest on GitHub" href="https://github.com/vb-consulting/NpgsqlRest" style="display: inline-grid;">NpgsqlRest on GitHub <i class="bi bi-github"></i></a> <a class="btn rl-arrow" target="_blank" data-bs-toggle="tooltip" data-bs-html="true" title="I Post Software Development Content Daily" href="https://www.linkedin.com/in/vb-software/" style="display: inline-grid;">Follow me on LinkedIn <i class="bi bi-linkedin"></i></a></div><div class="text-center"><div class="mt-5 mb-5 background-floki svelte-byttq0" data-bs-toggle="tooltip" data-bs-html="true" title="Floki is a developer dog."></div></div></footer><div class="mb-5"></div></div></div><div class="rightside svelte-9zwk14"><div class="svelte-9zwk14"><ul class="navbar-nav sidenav svelte-9zwk14"><li class="nav-txt-divider text-muted svelte-9zwk14"><hr class="svelte-9zwk14"><span class="svelte-9zwk14">on this page</span><hr class="svelte-9zwk14"></li><li class="nav-item toc1 right svelte-9zwk14 bookmark-nav" data-id="npgsqlrest-version-2-update-" title="NpgsqlRest Version 2 Update üêòüî•"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#npgsqlrest-version-2-update-">NpgsqlRest Version 2 Update üêòüî•</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="routine-source-plugins" title="Routine Source Plugins"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#routine-source-plugins">Routine Source Plugins</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="code-generation-plugins" title="Code Generation Plugins"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#code-generation-plugins">Code Generation Plugins</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="library-design" title="Library Design"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#library-design">Library Design</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="performances" title="Performances"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#performances">Performances</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="summary" title="Summary"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#summary">Summary</a></li><li class="nav-item toc2 right svelte-9zwk14 bookmark-nav" data-id="support" title="Support"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#support">Support</a></li><li class="nav-divider svelte-9zwk14"><hr class="svelte-9zwk14"></li><li class="nav-item toc1 right svelte-9zwk14 bookmark-nav" data-id="comments-section" title="Comments"><a class="nav-link auto-close svelte-9zwk14 bookmark-link" href="#comments-section">Comments</a></li><li><hr class="svelte-9zwk14"><div class="text-muted fs-_7rem mx-2">MORE ON NpgsqlRest</div><div class="navbar-nav sidenav"><a class="btn btn-sm text-start sidebar-link" href="/npgsqlrest/"><span class="svelte-9zwk14">NpgsqlRest</span></a></div><div class="navbar-nav sidenav"><a class="btn btn-sm text-start sidebar-link" href="/npgsqlrest/options/"><span class="svelte-9zwk14">NpgsqlRest Docs</span></a></div><div class="navbar-nav sidenav"><a class="btn btn-sm text-start sidebar-link" href="/npgsqlrest/annotations/"><span class="svelte-9zwk14">NpgsqlRest Annotations</span></a></div><div class="navbar-nav sidenav"><a class="btn btn-sm text-start sidebar-link" href="/npgsqlrest/changelog/"><span class="svelte-9zwk14">NpgsqlRest Changelog</span></a></div><div class="navbar-nav sidenav"><a class="btn btn-sm text-start sidebar-link" href="/npgsqlrest/perfomance-tests/"><span class="svelte-9zwk14">NpgsqlRest Perfomances</span></a></div><div class="navbar-nav sidenav"><a class="btn btn-sm text-start sidebar-link" href="/blog/npgsqlrest/"><span class="svelte-9zwk14">NpgsqlRest NuGet Library</span></a></div></li></ul></div></div></main><script>!function(){var i=document.querySelector("nav.navbar"),f=document.getElementsByTagName("main")[0],L=f.getElementsByClassName("sidebar")[0],w=f.getElementsByClassName("content")[0],o=document.querySelectorAll("div.code"),k=i.querySelector(".home");function E(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n])}function T(e,t){for(var n=1;n<arguments.length;n++)e.classList.remove(arguments[n]);E(e,t),e.classList.add(t)}function t(e,t){var n=e.currentTarget;if(!n.classList.contains("bi-check")){for(var i="",o=0;o<n.classList.length;o++)if(n.classList[o].startsWith("bi-")){i=n.classList[o];break}n.classList.remove(i),n.classList.add("spinner-border-sm"),n.classList.add("spinner-border");e=bootstrap.Tooltip.getInstance(n);e&&(e.setContent({".tooltip-inner":"Copying..."}),e.show()),t(n,function(){var e;n.classList.remove(i),n.classList.remove("spinner-border-sm"),n.classList.remove("spinner-border"),n.classList.add("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&(e.setContent({".tooltip-inner":"Copied!"}),e.show()),setTimeout(function(){var e;n.classList.add(i),n.classList.remove("bi-check"),bootstrap&&(e=bootstrap.Tooltip.getInstance(n))&&e.setContent({".tooltip-inner":n.dataset.bsTitle})},2e3)})}}"/"==document.location.pathname&&T(k,"d-none");var e=document.querySelector(".post-share > .copy-url"),n=(e&&e.addEventListener("click",function(e){t(e,function(e,t){navigator.clipboard.writeText(document.location.origin+document.location.pathname),t()})}),document.getElementsByTagName("html")[0]),a=i.querySelector("#theme-btn"),s="theme";function l(e){var t=a.getElementsByTagName("svg");"dark"===e?(t[0].style.display="",t[1].style.display="none",a.getElementsByClassName("check")[0].classList.add("checked")):(t[0].style.display="none",t[1].style.display="",a.getElementsByClassName("check")[0].classList.remove("checked"));for(var n=0;n<o.length;n++){var i=o[n];"dark"===e?(i.children[1].style.display="inherit",i.children[2].style.display="none"):"light"===e&&(i.children[1].style.display="none",i.children[2].style.display="inherit")}window._theme&&window._theme(e)}function r(e){t(e,function(e,t){navigator.clipboard.writeText(e.parentElement.nextSibling.innerText),t()})}function c(e){t(e,function(e,t){var n=localStorage.getItem(s);e="dark"===n?e.parentElement.parentElement.children[1]:e.parentElement.parentElement.children[2],setTimeout(function(){html2canvas(e).then(e=>{e.toBlob(e=>navigator.clipboard.write([new ClipboardItem({"image/png":e})])),t()})},0)})}a.addEventListener("click",()=>{var e="dark"===localStorage.getItem(s)?"light":"dark";localStorage.setItem(s,e),l(n.dataset.bsTheme=e)}),l(localStorage.getItem(s)),a.children[0].classList.remove("hidden");for(var d=0;d<o.length;d++){o[d].getElementsByClassName("copy-code")[0].addEventListener("click",r);var m=o[d].getElementsByClassName("photo-code");m.length&&m[0].addEventListener("click",c)}for(var S=function(){var a,o,s;if(f.children[2]&&"none"!=f.children[2].style.display)return a=f.querySelector(".main-content").querySelectorAll("[id]"),o=void 0,this.initNavs=function(e){s=e.querySelectorAll("li.bookmark-nav");for(var t=0;t<a.length;t++){for(var n=a[t].id,i=null,o=0;o<s.length;o++)if(s[o].dataset.id==n){i=s[o];break}a[t].nav=i}setTimeout(function(){for(var e=0;e<a.length;e++){var t=a[e];if(l(t).visible&&t.nav)return void t.nav.classList.add("active")}},1e3),r()},f.children[1].addEventListener("scroll",r),this;function l(e){var e=e.getBoundingClientRect(),t=Math.max(document.documentElement.clientHeight,window.innerHeight),n=0<e.top&&!(e.bottom<0||0<=e.top-t)||e.top<0&&e.bottom>t,i=!1;return{visible:n,above:i=n?i:e.bottom<t}}function r(){if(s&&s.length){for(var e=0;e<s.length;e++)s[e].classList.remove("active");for(var t=void 0,e=0;e<a.length;e++){const i=a[e];var n=l(i);if(!n.visible&&n.above&&(t=i.nav),n.visible&&i.nav&&!i.nav.classList.contains("active"))return i.nav.classList.add("active"),o&&clearTimeout(o),void(o=setTimeout(function(){i.nav.scrollIntoView({behavior:"smooth"}),o=void 0},250))}t&&!t.classList.contains("active")&&(t.classList.add("active"),o&&clearTimeout(o),o=setTimeout(function(){t.scrollIntoView({behavior:"smooth"}),o=void 0},250))}}}(),h=function(){var l,r=i.querySelector("#nav-btn"),c=480,d="200px",m="0.25fr",h=730,v=535,u=f.children[0].children[0].children[0],g=f.children[2]&&f.children[2].children[0].children[0],t="sidebar-pinned",p=null==localStorage.getItem(t)||"true"==localStorage.getItem(t),y=!1,b=!1;function n(){window._onresize&&window._onresize();var e=window.outerWidth||window.innerWidth,t=e<c,n=t?y?"100%":"0":p?""+d:"0",i=`grid-template-columns: ${n} 1fr`,o=t&&y?"width: 100%":"0"!=n?"":"display: none",a=t&&y?"display: none":"",s=t?y?"sidebar-show":"sidebar-hide":p?"sidebar-show":"sidebar-hide",n="0"==n;f.children[2]&&(m&&h&&v&&(n&&e<v||!n&&e<h?b||(u.innerHTML=l+g.innerHTML,S.initNavs(u),b=!0):b&&(u.innerHTML=l,S.initNavs(g),b=!1)),!m||t||b?(i+=";",f.children[2].style.display="none"):(i+=` ${m};`,f.children[2].style.display="")),T(r,!t&&p||t&&y?"rotate":"rotate-back","rotate","rotate-back"),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),f.style=L?i:"display: grid;",L&&T(L,s,"sidebar-show","sidebar-hide"),L&&(L.firstChild.style=o),w.style=a,t&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),t&&y&&T(k,"d-none")}function e(){var e=window.outerWidth<c;e?y=!y:p=!p,localStorage.setItem(t,p.toString()),n(),p?(r.classList.add("text-shadow"),null==document.querySelector("main .sidebar .accordion > [title='VB-Consulting'] > .collapsed")&&T(k,"d-none")):("/"!=document.location.pathname&&E(k,"d-none"),r.classList.remove("text-shadow")),e&&!y&&"/"!=document.location.pathname&&E(k,"d-none"),e&&y&&T(k,"d-none")}return m&&h&&v&&g&&(l=u.innerHTML,S.initNavs(g)),r.addEventListener("click",e),(window.onresize=n)(),this.closeSidebar=function(){window.outerWidth<c&&y&&e()},this}(),v=document.getElementsByClassName("auto-close"),u=0;u<v.length;u++)v[u].addEventListener("click",function(e){h.closeSidebar()});location.hash&&(e=document.getElementById(location.hash.replace("#","")))&&e.scrollIntoView()}();</script><script src="/bootstrap.bundle.min.js"></script><script>!function(){for(var e=document.querySelectorAll('[data-bs-toggle="tooltip"]'),t=0;t<e.length;t++)new bootstrap.Tooltip(e[t]);var n=document.getElementsByClassName("accordion-item");if(n.length){for(t=0;t<n.length;t++){var o=n[t];o.querySelectorAll("[href='"+document.location.pathname+"']").length&&o.firstChild.click()}var l=document.querySelector("nav.navbar").querySelector(".home"),a=document.getElementsByClassName("accordion");"/"==document.location.pathname&&l.classList.add("d-none");for(t=0;t<n.length;t++){var s=a[t];s&&s.firstChild&&"VB-Consulting"==s.firstChild.title&&(null!=s.firstChild.querySelector(".collapse")&&l.classList.contains("d-none")&&"/"!=document.location.pathname&&l.classList.remove("d-none"),s.addEventListener("show.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none"),l.classList.add("d-none")}),s.addEventListener("hide.bs.collapse",function(){"/"!=document.location.pathname&&l.classList.remove("d-none")}))}}}();</script><script src="/html2canvas.min.js"></script><script async defer src="https://buttons.github.io/buttons.js"></script></body><script async data-id="101435862" src="//static.getclicky.com/js"></script></html>